<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0103)https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html -->
<html xmlns="http://www.w3.org/1999/xhtml" data-darkreader-mode="dynamic" data-darkreader-scheme="dark" class=" nxekqkr idc0_350"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label > input + img, span#closed_text > img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] > #icon, ::-webkit-calendar-picker-indicator, img.Wirisformula, .sparkline-canvas, .sparkline-mouse-highlight, .search-toolbar-logo, .ia-wordmark {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: #131516;
   --darkreader-neutral-text: #d8d4cf;
   --darkreader-selection-background: #004daa;
   --darkreader-selection-text: #e8e6e3;
}</style><style class="darkreader darkreader--root-vars" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: #181a1b !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: initial;
}
html, body {
    background-color: #181a1b;
}
html, body {
    border-color: #736b5e;
    color: #e8e6e3;
}
a {
    color: #3391ff;
}
table {
    border-color: #545b5e;
}
mark {
    color: #e8e6e3;
}
::placeholder {
    color: #b2aba1;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #404400 !important;
    color: #e8e6e3 !important;
}
::selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
::-moz-selection {
    background-color: #004daa !important;
    color: #e8e6e3 !important;
}
}</style><meta name="darkreader" content="dec90ce7d6454e97b4800aa1c58e7835"><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: #7b5300 !important;
    border-color: #d8b013 !important;
    color: #f3e8c8 !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: #0f3a48 !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: #032029 !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: #0a0a0a !important;
}
.tou-uknfeu {
    background-color: #231603 !important;
}
.tou-6i3zyv {
    background-color: #19576c !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
.google-material-icons {
    font-family: 'Google Material Icons' !important;
}
.google-symbols {
    font-family: 'Google Symbols Subset', 'Google Symbols' !important;
}
.material-icons-extended {
    font-family: 'Material Icons Extended' !important;
}
mitid-authenticators-code-app > .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
.oui-icon {
    font-family: 'Oui Icons' !important;
}
.measure {
    z-index: 0 !important;
}</style>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app216.us.archive.org';v.server_ms=283;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/ruffle.js"></script>
<script type="text/javascript">
    __wm.pc(0.001);
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html","20191002095802","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1570010282");
</script>
<link rel="stylesheet" type="text/css" href="./ewbi.develops_ Excel Formula Parsing_files/banner-styles.css"><style class="darkreader darkreader--cors" media="screen">.__wb_overlay {
    filter:alpha(opacity=60); 
    opacity: 0.6; 
    -moz-opacity:0.6;   
    opacity: 0.6;
    
    background-color: #000;
    position: fixed;
    width:100%;
    height:100%;
    top: 0px;
    left: 0px;
    padding: 0px !important;
    border: 0px !important;
    margin: 0px !important;
    border-radius: 0px !important;
    z-index: 2147483643 !important;
  }
  
  #__wb_record_overlay_div {
    cursor: wait !important;
  }
  


  .__wb_record_content {
    opacity: 1.0;
    position: fixed;
    top: 50%;
    left: 50%;
    margin: 0px !important;
    padding: 0px !important;

    background-color: #ffffff !important;
    border-radius: 8px;
    z-index: 2147483644 !important;
    box-shadow: 0 0 30px 5px #000;
    -moz-box-shadow: 0 0 30px 5px #000;    
    -webkit-box-shadow: 0 0 30px 5px #000;  
  }
    
  #__wb_record_content_loader {
    cursor: wait !important;
    padding-top: 30px !important;    
    margin-left: -287px !important;
    margin-top: -177px !important;    
    width: 574px !important;
    height: 355px !important;  
  }
  
  #__wb_record_content_done {
    margin-left: -427px !important;
    margin-top: -177px !important;      
    width: 855px !important;
    height: 355px !important;  
  }
  
  .__wb_record_content > * {
    margin: auto !important;
    display: block !important;

    text-align: center !important;
    font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif !important;
  }
  
  .__wb_record_content > wb_h1 {
    font-size: 36px !important;
    color: #222 !important;
    margin: 0px 0px 0px 0px !important;
    padding: 0px !important;
    line-height: 2em;
    font-weight: normal !important;
    width: auto !important;
    height: auto !important;    
  }   
  
  .__wb_record_content > wb_p {
    font-size: 17px !important;
    color: #222 !important;    
    margin: 8px 0px 8px 0px !important;
    padding: 0px !important;
    line-height: 2em;
  }  
  
  .__wb_record_content > #_wb_logo  {
    margin-bottom: 10px !important;
  }
  
  .__wb_record_content > #_wb_spinner {
    margin-top: 30px !important;
    margin-bottom: 30px !important;    
  }
  
  .__wb_record_content > #_wb_curr_url {
    text-decoration: underline !important;
    font-weight: bold !important;
  }
  
  #__wb_record_content_done > #__wb_link {
    font-size: 20px !important;
    border: 1px !important;
    border-color: #aaa !important;
    border-style: solid !important;
    padding: 3px !important;
    text-align: center !important;
    width: 80% !important;
    height: auto !important;
  }
 
  #__wb_record_content_done > #__wb_link:focus {
    outline: 0px !important;
    border-color: #428bca !important;
  }
  
  
  
  #__wb_record_content_done > #__wb_donate_close {
    font-size: 18px !important;
    width: auto !important;
    float: right;
    display: inline-block;
    margin: 0px !important;
    padding: 8px 8px 0px 0px !important;   
  }
  
  #__wb_donate_close > #__wb_record_done_close {
    cursor: pointer !important;
    display: inline-block;
    vertical-align: bottom !important;
  }
  
  #__wb_record_content_done > #__wb_donate_close a {
    color: #428bca !important;
  } 
  
  #__wb_record_content_done > #__wb_donate_close a:link {
    color: #428bca !important;
    text-decoration: none !important;
    margin-right: 16px !important;
  }
  
  #__wb_record_content_done > #__wb_donate_close a:visited {
    color: #428bca !important;
  } 
  
  #__wb_record_content_done > #__wb_donate_close a:hover {
    color: #00B1F7 !important;
  }


#__wb_spinningSquaresG{        
  position: relative;
  width: 240px;
  height: 20px;
  
 
  padding: 0px !important;
  margin: 30px 0px 30px 160px !important;
  border: 0px !important;
  border-radius: 0px !important;
}

.__wb_spinningSquaresG {
   
      
  margin: 0px !important;
  padding: 0px !important;
  border: 0px !important;
  border-radius: 0px !important;
    
position:absolute;
top:0;
background-color:#000000;
width:22px;
height:22px;
-moz-animation-name:bounce_spinningSquaresG;
-moz-animation-duration:1.9s;
-moz-animation-iteration-count:infinite;
-moz-animation-direction:linear;
-moz-transform:scale(.3);
-webkit-animation-name:bounce_spinningSquaresG;
-webkit-animation-duration:1.9s;
-webkit-animation-iteration-count:infinite;
-webkit-animation-direction:linear;
-webkit-transform:scale(.3);
-ms-animation-name:bounce_spinningSquaresG;
-ms-animation-duration:1.9s;
-ms-animation-iteration-count:infinite;
-ms-animation-direction:linear;
-ms-transform:scale(.3);
-o-animation-name:bounce_spinningSquaresG;
-o-animation-duration:1.9s;
-o-animation-iteration-count:infinite;
-o-animation-direction:linear;
-o-transform:scale(.3);
animation-name:bounce_spinningSquaresG;
animation-duration:1.9s;
animation-iteration-count:infinite;
animation-direction:linear;
transform:scale(.3);
}

#__wb_spinningSquaresG_1{
left:0;
-moz-animation-delay:0.76s;
-webkit-animation-delay:0.76s;
-ms-animation-delay:0.76s;
-o-animation-delay:0.76s;
animation-delay:0.76s;
}

#__wb_spinningSquaresG_2{
left:30px;
-moz-animation-delay:0.95s;
-webkit-animation-delay:0.95s;
-ms-animation-delay:0.95s;
-o-animation-delay:0.95s;
animation-delay:0.95s;
}

#__wb_spinningSquaresG_3{
left:60px;
-moz-animation-delay:1.14s;
-webkit-animation-delay:1.14s;
-ms-animation-delay:1.14s;
-o-animation-delay:1.14s;
animation-delay:1.14s;
}

#__wb_spinningSquaresG_4{
left:90px;
-moz-animation-delay:1.33s;
-webkit-animation-delay:1.33s;
-ms-animation-delay:1.33s;
-o-animation-delay:1.33s;
animation-delay:1.33s;
}

#__wb_spinningSquaresG_5{
left:120px;
-moz-animation-delay:1.52s;
-webkit-animation-delay:1.52s;
-ms-animation-delay:1.52s;
-o-animation-delay:1.52s;
animation-delay:1.52s;
}

#__wb_spinningSquaresG_6{
left:150px;
-moz-animation-delay:1.71s;
-webkit-animation-delay:1.71s;
-ms-animation-delay:1.71s;
-o-animation-delay:1.71s;
animation-delay:1.71s;
}

#__wb_spinningSquaresG_7{
left:180px;
-moz-animation-delay:1.9s;
-webkit-animation-delay:1.9s;
-ms-animation-delay:1.9s;
-o-animation-delay:1.9s;
animation-delay:1.9s;
}

#__wb_spinningSquaresG_8{
left:210px;
-moz-animation-delay:2.09s;
-webkit-animation-delay:2.09s;
-ms-animation-delay:2.09s;
-o-animation-delay:2.09s;
animation-delay:2.09s;
}

@-moz-keyframes bounce_spinningSquaresG{
0%{
-moz-transform:scale(1);
background-color:#000000;
}

100%{
-moz-transform:scale(.3) rotate(90deg);
background-color:#FFFFFF;
}

}

@-webkit-keyframes bounce_spinningSquaresG{
0%{
-webkit-transform:scale(1);
background-color:#000000;
}

100%{
-webkit-transform:scale(.3) rotate(90deg);
background-color:#FFFFFF;
}

}

@-ms-keyframes bounce_spinningSquaresG{
0%{
-ms-transform:scale(1);
background-color:#000000;
}

100%{
-ms-transform:scale(.3) rotate(90deg);
background-color:#FFFFFF;
}

}

@-o-keyframes bounce_spinningSquaresG{
0%{
-o-transform:scale(1);
background-color:#000000;
}

100%{
-o-transform:scale(.3) rotate(90deg);
background-color:#FFFFFF;
}

}

@keyframes bounce_spinningSquaresG{
0%{
transform:scale(1);
background-color:#000000;
}

100%{
transform:scale(.3) rotate(90deg);
background-color:#FFFFFF;
}

} 

#wm-ipp-base {
  height:65px;
  padding:0;
  margin:0;
  border:none;
  background:none transparent;
}
#wm-ipp {
  z-index: 2147483647;
}
#wm-ipp, #wm-ipp * {
  font-family:Lucida Grande, Helvetica, Arial, sans-serif;
  font-size:12px;
  line-height:1.2;
  letter-spacing:0;
  width:auto;
  height:auto;
  max-width:none;
  max-height:none;
  min-width:0 !important;
  min-height:0;
  outline:none;
  float:none;
  text-align:left;
  border:none;
  color: #000;
  text-indent: 0;
  position: initial;
  background: none;
}
#wm-ipp div, #wm-ipp canvas {
  display: block;
}
#wm-ipp div, #wm-ipp tr, #wm-ipp td, #wm-ipp a, #wm-ipp form {
  padding:0;
  margin:0;
  border:none;
  border-radius:0;
  background-color:transparent;
  background-image:none;
  
  height:auto;
}
#wm-ipp table {
  border:none;
  border-collapse:collapse;
  margin:0;
  padding:0;
  width:auto;
  font-size:inherit;
}
#wm-ipp form input {
  padding:1px !important;
  height:auto;
  display:inline;
  margin:0;
  color: #000;
  background: none #fff;
  border: 1px solid #666;
}
#wm-ipp form input[type=submit] {
  padding:0 8px !important;
  margin:1px 0 1px 5px !important;
  width:auto !important;
  border: 1px solid #000 !important;
  background: #fff !important;
  color: #000 !important;
}
#wm-ipp form input[type=submit]:hover {
  background: #eee !important;
  cursor: pointer !important;
}
#wm-ipp form input[type=submit]:active {
  transform: translateY(1px);
}
#wm-ipp a {
  display: inline;
}    
#wm-ipp a:hover{
  text-decoration:underline;
}
#wm-ipp a.wm-btn:hover {
  text-decoration:none;
  color:#ff0 !important;
}
#wm-ipp a.wm-btn:hover span {
  color:#ff0 !important;
}
#wm-ipp #wm-ipp-inside {
  margin: 0 6px;
  border:5px solid #000;
  border-top:none;
  background-color:rgba(255,255,255,0.9);
  -moz-box-shadow:1px 1px 4px #333;
  -webkit-box-shadow:1px 1px 4px #333;
  box-shadow:1px 1px 4px #333;
  border-radius:0 0 8px 8px;
}

#wm-ipp #wm-logo {
  padding:0 10px;
  vertical-align:middle;
  min-width:100px;
  flex: 0 0 100px;
}
#wm-ipp .c {
  padding-left: 4px;
}
#wm-ipp .c .u {
    margin-top: 4px !important;
}
#wm-ipp .n {
  padding:0 0 0 5px !important;
  vertical-align: bottom;
}
#wm-ipp .n a {
  text-decoration:none;
  color:#33f;
  font-weight:bold;
}
#wm-ipp .n .b {
  padding:0 6px 0 0 !important;
  text-align:right !important;
  overflow:visible;
  white-space:nowrap;
  color:#99a;
  vertical-align:middle;
}
#wm-ipp .n .y .b {
  padding:0 6px 2px 0 !important;
}
#wm-ipp .n .c {
  background:#000;
  color:#ff0;
  font-weight:bold;
  padding:0 !important;
  text-align:center;
}
#wm-ipp.hi .n td.c {
  color:#ec008c;
}
#wm-ipp .n td.f {
  padding:0 0 0 6px !important;
  text-align:left !important;
  overflow:visible;
  white-space:nowrap;
  color:#99a;
  vertical-align:middle;
}
#wm-ipp .n tr.m td {
  text-transform:uppercase;
  white-space:nowrap;
  padding:2px 0;
}
#wm-ipp .c .s {
  padding:0 5px 0 0 !important;
  vertical-align:bottom;
}
#wm-ipp #wm-nav-captures {
  white-space: nowrap;
}
#wm-ipp .c .s a.t {
  color:#33f;
  font-weight:bold;
  line-height: 1.8;
}
#wm-ipp .c .s div.r {
  color: #666;
  font-size:9px;
  white-space:nowrap;
}
#wm-ipp .c .k {
  padding-bottom:1px;
}
#wm-ipp .c .s {
  padding:0 5px 2px 0 !important;
}
#wm-ipp td#displayMonthEl {
  padding: 2px 0 !important;
}
#wm-ipp td#displayYearEl {
  padding: 0 0 2px 0 !important;
}

div#wm-ipp-sparkline {
  position:relative;
  white-space:nowrap;
  background-color:#fff;
  cursor:pointer;
  line-height:0.9;
}
#sparklineImgId, #wm-sparkline-canvas {
  position:relative;
  z-index:9012;
  max-width:none;
}
#wm-ipp-sparkline div.yt {
  position:absolute;
  z-index:9010 !important;
  background-color:#ff0 !important;
  top: 0;
}
#wm-ipp-sparkline div.mt {
  position:absolute;
  z-index:9013 !important;
  background-color:#ec008c !important;
  top: 0;
}  
#wm-ipp .r {
    margin-left: 4px;
}
#wm-ipp .r a {
  color:#33f;
  border:none;
  position:relative;
  background-color:transparent;
  background-repeat:no-repeat !important;
  background-position:100% 100% !important;
  text-decoration: none;
}
#wm-ipp #wm-capinfo {
  
  border-radius: 0 0 4px 4px;
}
#wm-ipp #wm-capinfo .c-logo {
  display:block;
  float:left;
  margin-right:3px;
  width:90px;
  min-height:90px;
  max-height: 290px;
  border-radius:45px;
  overflow:hidden;
  background-position:50%;
  background-size:auto 90px;
  box-shadow: 0 0 2px 2px rgba(208,208,208,128) inset;
}
#wm-ipp #wm-capinfo .c-logo span {
  display:inline-block;
}
#wm-ipp #wm-capinfo .c-logo img {
  height:90px;
  position:relative;
  left:-50%;
}
#wm-ipp #wm-capinfo .wm-title {
  font-size:130%;
}
#wm-ipp #wm-capinfo a.wm-selector {
  display:inline-block;
  color: #aaa;
  text-decoration:none !important;
  padding: 2px 8px;
}
#wm-ipp #wm-capinfo a.wm-selector.selected {
  background-color:#666;
}
#wm-ipp #wm-capinfo a.wm-selector:hover {
  color: #fff;
}
#wm-ipp #wm-capinfo.notice-only #wm-capinfo-collected-by,
#wm-ipp #wm-capinfo.notice-only #wm-capinfo-timestamps {
    display: none;
}
#wm-ipp #wm-capinfo #wm-capinfo-notice .wm-capinfo-content {
    background-color:#ff0;
    padding:5px;
    font-size:14px;
    text-align:center;
}
#wm-ipp #wm-capinfo #wm-capinfo-notice .wm-capinfo-content * {
    font-size:14px;
    text-align:center;
}
#wm-ipp #wm-expand {
  right: 1px;
  bottom: -1px;
  color: #ffffff;
  background-color: #666 !important;
  padding:0 5px 0 3px !important;
  border-radius: 3px 3px 0 0 !important;
}
#wm-ipp #wm-expand span {
  color: #ffffff;
}
#wm-ipp #wm-expand #wm-expand-icon {
  display: inline-block;
  transition: transform 0.5s;
  transform-origin: 50% 45%;
}
#wm-ipp #wm-expand.wm-open #wm-expand-icon {
  transform: rotate(180deg);
}
#wm-ipp #wmtb {
  text-align:right;
}
#wm-ipp #wmtb #wmtbURL {
  width: calc(100% - 45px);
}
#wm-ipp #wm-graph-anchor {
  border-right:1px solid #ccc;
}

html.wb-highlight {
  box-shadow: inset 0 0 0 3px #a50e3a !important;
}    
.wb-highlight {
  outline: 3px solid #a50e3a !important;
}
#wm-ipp-print {
  display:none !important;
}
@media print {
#wm-ipp-base {
  display:none !important;
}
#wm-ipp-print {
  display:block !important;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
}
@media (max-width:414px) {
    #wm-ipp .xxs {
	display:none !important;
    }
}
@media (min-width:1055px) {
#wm-ipp #wm-graph-anchor {
  display:block !important;
}
}
@media (max-width:1054px) {
#wm-ipp #wm-graph-anchor {
  display:none !important;
}
}
@media (max-width:1163px) {
#wm-logo {
    display:none !important;
}
}

#wm-btns {
    white-space: nowrap;
    margin-top: -2px;
}

#wm-btns #wm-save-snapshot-open {
  margin-right: 7px;
  top: -6px;
}

#wm-btns #wm-sign-in {
  box-sizing: content-box;
  display: none;
  margin-right: 7px;
  top: -8px;

  
  border: 2px #000 solid;
  border-radius: 14px;
  padding-right: 2px;
  padding-bottom: 2px;
  width: 11px;
  height: 11px;
}

#wm-btns #wm-sign-in>.iconochive-person {
  font-size: 12.5px;
}

#wm-save-snapshot-open > .iconochive-web {
  color:#000;
  font-size:160%;
}

#wm-ipp #wm-share {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
}

#wm-share > #wm-screenshot {
  display: inline-block;
  margin-right: 3px;
  visibility: hidden;
}

#wm-screenshot > .iconochive-image {
  color:#000;
  font-size:160%;
}

#wm-share > #wm-video {
  display: inline-block;
  margin-right: 3px;
  visibility: hidden;
}

#wm-video > .iconochive-movies {
  color: #000;
  display: inline-block;
  font-size: 150%;
  margin-bottom: 2px;
}

#wm-btns #wm-save-snapshot-in-progress {
  display: none;
  font-size:160%;
  opacity: 0.5;
  position: relative;
  margin-right: 7px;
  top: -5px;
}

#wm-btns #wm-save-snapshot-success {
  display: none;
  color: green;
  position: relative;
  top: -7px;
}

#wm-btns #wm-save-snapshot-fail {
  display: none;
  color: red;
  position: relative;
  top: -7px;
}

.wm-icon-screen-shot {
  background: url('https://web-static.archive.org/_static/images/web-screenshot.svg') no-repeat !important;
  background-size: contain !important;
  width: 22px !important;
  height: 19px !important;

  display: inline-block;
}
#donato {
    
    
    height: 0;
    margin: 0;
    padding: 0;
    border-bottom: 1px solid #999 !important;
}
body.wm-modal {
    height: auto !important;
    overflow: hidden !important;
}
#donato #donato-base {
    width: 100%;
    height: 100%;
    
    margin: 0;
    padding: 0;
    position: absolute;
    z-index: 2147483639;
}
body.wm-modal #donato #donato-base {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 2147483640;
}

.wb-autocomplete-suggestions {
    font-family: Lucida Grande, Helvetica, Arial, sans-serif;
    font-size: 12px;
    text-align: left;
    cursor: default;
    border: 1px solid #ccc;
    border-top: 0;
    background: #fff;
    box-shadow: -1px 1px 3px rgba(0,0,0,.1);
    position: absolute;
    display: none;
    z-index: 2147483647;
    max-height: 254px;
    overflow: hidden;
    overflow-y: auto;
    box-sizing: border-box;
}
.wb-autocomplete-suggestion {
    position: relative;
    padding: 0 .6em;
    line-height: 23px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 1.02em;
    color: #333;
}
.wb-autocomplete-suggestion b {
    font-weight: bold;
}
.wb-autocomplete-suggestion.selected {
    background: #f0f0f0;
}</style><style class="darkreader darkreader--sync" media="screen"></style>
<link rel="stylesheet" type="text/css" href="./ewbi.develops_ Excel Formula Parsing_files/iconochive.css"><style class="darkreader darkreader--cors" media="screen">[class^="iconochive-"],[class*=" iconochive-"]{font-family:'Iconochive-Regular'!important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
.iconochive-Uplevel:before{content:"\21b5"}
.iconochive-exit:before{content:"\1f6a3"}
.iconochive-beta:before{content:"\3b2"}
.iconochive-logo:before{content:"\1f3db"}
.iconochive-audio:before{content:"\1f568"}
.iconochive-movies:before{content:"\1f39e"}
.iconochive-software:before{content:"\1f4be"}
.iconochive-texts:before{content:"\1f56e"}
.iconochive-etree:before{content:"\1f3a4"}
.iconochive-image:before{content:"\1f5bc"}
.iconochive-web:before{content:"\1f5d4"}
.iconochive-collection:before{content:"\2211"}
.iconochive-folder:before{content:"\1f4c2"}
.iconochive-data:before{content:"\1f5c3"}
.iconochive-tv:before{content:"\1f4fa"}
.iconochive-article:before{content:"\1f5cf"}
.iconochive-question:before{content:"\2370"}
.iconochive-question-dark:before{content:"\3f"}
.iconochive-info:before{content:"\69"}
.iconochive-info-small:before{content:"\24d8"}
.iconochive-comment:before{content:"\1f5e9"}
.iconochive-comments:before{content:"\1f5ea"}
.iconochive-person:before{content:"\1f464"}
.iconochive-people:before{content:"\1f465"}
.iconochive-eye:before{content:"\1f441"}
.iconochive-rss:before{content:"\221e"}
.iconochive-time:before{content:"\1f551"}
.iconochive-quote:before{content:"\275d"}
.iconochive-disc:before{content:"\1f4bf"}
.iconochive-tv-commercial:before{content:"\1f4b0"}
.iconochive-search:before{content:"\1f50d"}
.iconochive-search-star:before{content:"\273d"}
.iconochive-tiles:before{content:"\229e"}
.iconochive-list:before{content:"\21f6"}
.iconochive-list-bulleted:before{content:"\2317"}
.iconochive-latest:before{content:"\2208"}
.iconochive-left:before{content:"\2c2"}
.iconochive-right:before{content:"\2c3"}
.iconochive-left-solid:before{content:"\25c2"}
.iconochive-right-solid:before{content:"\25b8"}
.iconochive-up-solid:before{content:"\25b4"}
.iconochive-down-solid:before{content:"\25be"}
.iconochive-dot:before{content:"\23e4"}
.iconochive-dots:before{content:"\25a6"}
.iconochive-columns:before{content:"\25af"}
.iconochive-sort:before{content:"\21d5"}
.iconochive-atoz:before{content:"\1f524"}
.iconochive-ztoa:before{content:"\1f525"}
.iconochive-upload:before{content:"\1f4e4"}
.iconochive-download:before{content:"\1f4e5"}
.iconochive-favorite:before{content:"\2605"}
.iconochive-heart:before{content:"\2665"}
.iconochive-play:before{content:"\25b6"}
.iconochive-play-framed:before{content:"\1f3ac"}
.iconochive-fullscreen:before{content:"\26f6"}
.iconochive-mute:before{content:"\1f507"}
.iconochive-unmute:before{content:"\1f50a"}
.iconochive-share:before{content:"\1f381"}
.iconochive-edit:before{content:"\270e"}
.iconochive-reedit:before{content:"\2710"}
.iconochive-gear:before{content:"\2699"}
.iconochive-remove-circle:before{content:"\274e"}
.iconochive-plus-circle:before{content:"\1f5d6"}
.iconochive-minus-circle:before{content:"\1f5d5"}
.iconochive-x:before{content:"\1f5d9"}
.iconochive-fork:before{content:"\22d4"}
.iconochive-trash:before{content:"\1f5d1"}
.iconochive-warning:before{content:"\26a0"}
.iconochive-flash:before{content:"\1f5f2"}
.iconochive-world:before{content:"\1f5fa"}
.iconochive-lock:before{content:"\1f512"}
.iconochive-unlock:before{content:"\1f513"}
.iconochive-twitter:before{content:"\1f426"}
.iconochive-facebook:before{content:"\66"}
.iconochive-googleplus:before{content:"\67"}
.iconochive-reddit:before{content:"\1f47d"}
.iconochive-tumblr:before{content:"\54"}
.iconochive-pinterest:before{content:"\1d4df"}
.iconochive-popcorn:before{content:"\1f4a5"}
.iconochive-email:before{content:"\1f4e7"}
.iconochive-embed:before{content:"\1f517"}
.iconochive-gamepad:before{content:"\1f579"}
.iconochive-Zoom_In:before{content:"\2b"}
.iconochive-Zoom_Out:before{content:"\2d"}
.iconochive-RSS:before{content:"\1f4e8"}
.iconochive-Light_Bulb:before{content:"\1f4a1"}
.iconochive-Add:before{content:"\2295"}
.iconochive-Tab_Activity:before{content:"\2318"}
.iconochive-Forward:before{content:"\23e9"}
.iconochive-Backward:before{content:"\23ea"}
.iconochive-No_Audio:before{content:"\1f508"}
.iconochive-Pause:before{content:"\23f8"}
.iconochive-No_Favorite:before{content:"\2606"}
.iconochive-Unike:before{content:"\2661"}
.iconochive-Song:before{content:"\266b"}
.iconochive-No_Flag:before{content:"\2690"}
.iconochive-Flag:before{content:"\2691"}
.iconochive-Done:before{content:"\2713"}
.iconochive-Check:before{content:"\2714"}
.iconochive-Refresh:before{content:"\27f3"}
.iconochive-Headphones:before{content:"\1f3a7"}
.iconochive-Chart:before{content:"\1f4c8"}
.iconochive-Bookmark:before{content:"\1f4d1"}
.iconochive-Documents:before{content:"\1f4da"}
.iconochive-Newspaper:before{content:"\1f4f0"}
.iconochive-Podcast:before{content:"\1f4f6"}
.iconochive-Radio:before{content:"\1f4fb"}
.iconochive-Cassette:before{content:"\1f4fc"}
.iconochive-Shuffle:before{content:"\1f500"}
.iconochive-Loop:before{content:"\1f501"}
.iconochive-Low_Audio:before{content:"\1f509"}
.iconochive-First:before{content:"\1f396"}
.iconochive-Invisible:before{content:"\1f576"}
.iconochive-Computer:before{content:"\1f5b3"}</style><style class="darkreader darkreader--sync" media="screen"></style>
<!-- End Wayback Rewrite JS Include -->


<meta name="generator" content="http://www.typepad.com/">

<title>ewbi.develops: Excel Formula Parsing</title>

<link rel="stylesheet" href="./ewbi.develops_ Excel Formula Parsing_files/styles.css" type="text/css"><style class="darkreader darkreader--sync" media="screen"></style>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/index.rdf">

<link rel="start" href="https://ewbi.blogs.com/develops/" title="Home">

<link rel="prev" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/no_double_quote.html" title="No Double Quotes in WSH Command-line Parameters">


<link rel="next" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/normalize_excel.html" title="Normalize Excel&#39;s SpreadsheetML using XSLT">


<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/"
         xmlns:dc="http://purl.org/dc/elements/1.1/">
<rdf:Description
    rdf:about="https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html"
    trackback:ping="https://www.typepad.com/services/trackback/6a00d8341c7bd453ef00d83469eab369e2"
    dc:title="Excel Formula Parsing"
    dc:identifier="https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html"
    dc:description="Update 8/7/2017 Whoa. Ten years later and I&#39;m in here making an update. Here&#39;s why. In short, I&#39;ve updated the JavaScript in this post (view source) to include an MIT license. It previously had only this: &quot;free for the taking&quot;,..."
    dc:creator="ewbi"
    dc:date="2004-12-28T21:57:10-08:00" />
</rdf:RDF>
-->




<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/comments.js"></script>
<script type="text/javascript">
hostName = '.blogs.com/develops/';
</script>

<style type="text/css">
@font-face {
  font-weight: 400;
  font-style:  normal;
  font-family: circular;

  src: url('chrome-extension://liecbddmkiiihnedobmlmillhodjkdmb/fonts/CircularXXWeb-Book.woff2') format('woff2');
}

@font-face {
  font-weight: 700;
  font-style:  normal;
  font-family: circular;

  src: url('chrome-extension://liecbddmkiiihnedobmlmillhodjkdmb/fonts/CircularXXWeb-Bold.woff2') format('woff2');
}</style><style class="darkreader darkreader--sync" media="screen"></style></head>

<body style=""><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;"><template shadowrootmode="closed"><div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;" class="">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20191002095802/https%3A//ewbi.blogs.com/develops/2004/12/excel_formula_p.html" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="https://web.archive.org/web/" title="Wayback Machine home page"><img src="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-100.png, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0"></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="https://web.archive.org/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" onfocus="this.focus();this.select();" style="flex:1;" autocomplete="off"><input type="hidden" name="type" value="replay"><input type="hidden" name="date" value="20191002095802"><input type="submit" value="Go">
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;"><a class="t" href="https://web.archive.org/web/*/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" title="See a list of every capture for this URL">183 captures</a><div class="r" title="Timespan for captures of this URL">4 Jan 2005 - 18 Mar 2024</div></div>
        <div class="k">
          <a href="https://web.archive.org/web/20220801000000/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="725" height="27" border="0"></canvas>
            <div class="yt" style="display: none; width: 25px; height: 27px; left: 650px;"></div><div class="mt" style="display: none; width: 2px; height: 27px; left: 665px;"></div></div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190825231145/http://ewbi.blogs.com:80/develops/2004/12/excel_formula_p.html" title="25 Aug 2019"><strong>Aug</strong></a></td>
            <td class="c" id="displayMonthEl" title="You are here: 09:58:02 Oct 02, 2019">Oct</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20191111020730/http://ewbi.blogs.com:80/develops/2004/12/excel_formula_p.html" title="11 Nov 2019"><strong>Nov</strong></a></td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20190926023124/http://ewbi.blogs.com:80/develops/2004/12/excel_formula_p.html" title="02:31:24 Sep 26, 2019"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0"></a></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 09:58:02 Oct 02, 2019">02</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20191111020730/http://ewbi.blogs.com:80/develops/2004/12/excel_formula_p.html" title="02:07:30 Nov 11, 2019"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0"></a></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20180910204608/http://ewbi.blogs.com:80/develops/2004/12/excel_formula_p.html" title="10 Sep 2018"><strong>2018</strong></a></td>
            <td class="c" id="displayYearEl" title="You are here: 09:58:02 Oct 02, 2019">2019</td>
            <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20201112015820/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" title="12 Nov 2020"><strong>2020</strong></a></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#" title="Share via My Web Archive" style="display: none;">
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in" style="display: inline-block;">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web" style="display: none;"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color: rgb(87, 186, 244); font-size: 160%; --darkreader-inline-color: #5abbf4;" data-darkreader-inline-color=""></span></a>
        <a id="wm-tb-close" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color: rgb(136, 136, 136); font-size: 240%; --darkreader-inline-color: #9d9488;" data-darkreader-inline-color=""></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="https://web.archive.org/web/20191002095802/http://web.archive.org/screenshot/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" id="wm-screenshot" title="screenshot" style="visibility: hidden;">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#" data-url="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color: rgb(59, 89, 152); font-size: 160%; --darkreader-inline-color: #7fa5cd;" data-darkreader-inline-color=""></span></a>
        <a id="wm-share-twitter" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#" data-url="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color: rgb(29, 202, 255); font-size: 160%; --darkreader-inline-color: #2eceff;" data-darkreader-inline-color=""></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top: 1px solid rgb(119, 119, 119); display: none; overflow: hidden; --darkreader-inline-border-top: #655e53;" data-darkreader-inline-border-top="">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color: rgb(102, 102, 102); color: rgb(255, 255, 255); font-weight: bold; text-align: center; --darkreader-inline-bgcolor: #4d5356; --darkreader-inline-color: #e8e6e3;" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color: rgb(51, 51, 255); --darkreader-inline-color: #3d84ff;" href="https://archive.org/details/webwidecrawl" target="_new" data-darkreader-inline-color=""><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position: absolute; top: 0px; left: 0px; width: 100%; height: 75px; background: linear-gradient(rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 90%, rgb(255, 255, 255) 100%); --darkreader-inline-bgimage: linear-gradient(rgba(24, 26, 27, 0) 0%, rgba(24, 26, 27, 0) 90%, #181a1b 100%); --darkreader-inline-bgcolor: initial;" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/liveweb)"></span>
		<div>Collection: <a style="color: rgb(51, 51, 255); --darkreader-inline-color: #3d84ff;" href="https://archive.org/details/liveweb" target="_new" data-darkreader-inline-color=""><span class="wm-title">Live Web Proxy Crawls</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position: absolute; top: 0px; left: 0px; width: 100%; height: 75px; background: linear-gradient(rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 90%, rgb(255, 255, 255) 100%); --darkreader-inline-bgimage: linear-gradient(rgba(24, 26, 27, 0) 0%, rgba(24, 26, 27, 0) 90%, #181a1b 100%); --darkreader-inline-bgcolor: initial;" data-darkreader-inline-bgimage="" data-darkreader-inline-bgcolor=""></div>
	  Content crawled via the <a href="http://archive.org/web/web.php">Wayback Machine</a> Live Proxy mostly by the Save Page Now feature on web.archive.org.
<br><br>
Liveweb proxy is a component of Internet Archive’s wayback machine project. The liveweb proxy captures the content of a web page in real time, archives it into a ARC or WARC file and returns the ARC/WARC record back to the wayback machine to process. The recorded ARC/WARC file becomes part of the wayback machine in due course of time.
<br>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color: rgb(102, 102, 102); color: rgb(255, 255, 255); font-weight: bold; text-align: center; --darkreader-inline-bgcolor: #4d5356; --darkreader-inline-color: #e8e6e3;" title="Timestamps for the elements of this page" data-darkreader-inline-bgcolor="" data-darkreader-inline-color="">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web-static.archive.org/_static/images/loading.gif" alt="loading"></div>
    </div>
    </div>
  </div></div></div><link rel="stylesheet" type="text/css" href="./ewbi.develops_ Excel Formula Parsing_files/banner-styles.css"><link rel="stylesheet" type="text/css" href="./ewbi.develops_ Excel Formula Parsing_files/iconochive.css"><div class="wb-autocomplete-suggestions "></div></template>
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html","20191002095802",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 

<div id="container">

<div id="banner">
<h1><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/" accesskey="1">ewbi.develops</a></h1>
<h2></h2>
</div>

<div id="left">
<div class="sidebar">

<!-- list_inlcude.tt  -->
<div id="popular_stuff" class="module-typelist module">
<h2 class="module-header">popular stuff</h2>
	<div class="module-content">
		<ul class="module-list">
							<li class="module-list-item"><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/accesssqltransforms.html">Access SQL TRANSFORMs</a></li>
							<li class="module-list-item"><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html">Excel Formula Parsing</a></li>
							<li class="module-list-item"><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelspreadsheetml.html">Excel SpreadsheetML</a></li>
							<li class="module-list-item"><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/sparklinesinaspnet.html">Sparklines in ASP.NET</a></li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->


<h2>Recent Stuff</h2>
<ul>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2009/06/some-resources-for-rss-generation.html">Some Resources for RSS Generation</a></li>

</ul>

<h2>Older Stuff</h2>
<ul>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2009/06/index.html">June 2009</a> (1)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2008/01/index.html">January 2008</a> (1)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/12/index.html">December 2007</a> (2)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/11/index.html">November 2007</a> (8)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/09/index.html">September 2007</a> (1)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/05/index.html">May 2007</a> (5)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/04/index.html">April 2007</a> (2)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/03/index.html">March 2007</a> (1)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/12/index.html">December 2006</a> (2)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/11/index.html">November 2006</a> (3)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/10/index.html">October 2006</a> (5)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/09/index.html">September 2006</a> (6)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/07/index.html">July 2006</a> (2)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/05/index.html">May 2006</a> (3)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2006/04/index.html">April 2006</a> (3)</li>

</ul>


<h2>Grouped Stuff</h2>
<ul>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/consulting/">Consulting</a> (7)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/dev_practices/">Dev Practices</a> (3)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/flexwiki/">FlexWiki</a> (9)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_net/">MS .NET</a> (54)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_access/">MS Access</a> (25)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_excel/">MS Excel</a> (15)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_general/">MS General</a> (9)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_ie/">MS IE</a> (6)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_office/">MS Office</a> (3)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_sql_server/">MS SQL Server</a> (10)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_visual_basic/">MS Visual Basic</a> (17)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_visual_foxpro/">MS Visual FoxPro</a> (1)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_web_dev/">MS Web Dev</a> (8)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_windows/">MS Windows</a> (11)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_word/">MS Word</a> (6)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/ms_xml/">MS XML</a> (5)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/other_stuff/">Other Stuff</a> (60)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/peoplesoft/">PeopleSoft</a> (2)</li>
<li><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/web_development/">Web Development</a> (7)</li>

</ul>

<!-- list_inlcude.tt  -->
<div id="legal_stuff" class="module-typelist module">
<h2 class="module-header">legal stuff</h2>
	<div class="module-content">
		<ul class="module-list">
							<li class="module-list-item">All post opinions are mine.</li>
							<li class="module-list-item">Many comment opinions are not.</li>
							<li class="module-list-item">My opinions are subject to change.</li>
							<li class="module-list-item">No warranties implied.</li>
							<li class="module-list-item">Proceed at your own risk.</li>
							<li class="module-list-item">Send feedback to info@ewbi.com.</li>
							<li class="module-list-item">© 2003-2007 E. W. Bachtal, Inc.</li>
			
		</ul><!-- last /ul -->
	</div>
</div>
<!-- end list_include.tt -->


<div class="link-note">
<a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/index.rdf" style="text-decoration: none"><img style="border: 0px; --darkreader-inline-border-top: 0px; --darkreader-inline-border-right: 0px; --darkreader-inline-border-bottom: 0px; --darkreader-inline-border-left: 0px;" src="./ewbi.develops_ Excel Formula Parsing_files/xml.gif" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""></a>
</div>

</div>

</div>

<div id="center">
<div class="content">


<h2 class="dateheader">2004.12.28 09:57 PM</h2>



<h3>Excel Formula Parsing</h3>


<p><em><u>Update 8/7/2017</u></em></p>

<p>Whoa.  Ten years later and I'm in here making an update.  <a href="https://web.archive.org/web/20191002095802/https://github.com/PHPOffice/PhpSpreadsheet/issues/140">Here's why</a>.  In short, I've updated the JavaScript in this post (view source) to include an MIT license.  It previously had only this: "free for the taking", which seemed sufficient back in 2004, but folks need something more legit these days.  Note that the C# implementation of this code, which I <a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/03/excel_formula_p.html">posted in 2007</a>, included an MIT license.</p>

<p><em><u>Update 4/26/2007</u></em></p>

<p>Fixed a problem with literal numbers in formulas formatted with scientific notation (e.g., =3.1E-24-2.1E-24), per Tjaard's comment.  More info <a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/04/excel_formula_p.html">here</a>.</p>

<hr>

<p>As part of a self-directed (i.e., unpaid) project I'm working on with my old pal Darnley Bynoe, it was necessary to write an Excel formula parser, the output of which is an RPN expression which our product evaluates.  While investigating the nuances of Excel formulas and exploring our options, we put together a number of prototypes.  Darnley wrote his prototypes using <a href="https://web.archive.org/web/20191002095802/http://www.jes.com/pb/">Pick/BASIC</a>, while I used JavaScript (as it made it easy to spit out the results in formatted HTML).  Since we settled on an approach a while back and have moved on to other downstream work, I figured someone might like to have one of the old parsing prototypes we produced (one that stopped short of producing tokenized RPN, which is fairly illegible, and mostly useless without our interpreter).</p>

<p>So, here it is.  I chose to share this particular prototype not so much because of the approach it uses (more on that below), but because it provides good visualization of the formula's parts and their nesting.  Anyhow, feel free to use it here or take the code with you.  To use it here, just paste in a valid Excel formula.  Make sure it's a valid Excel formula (in other words, Excel accepts it), as this prototype doesn't do expression validation or provide any stack overflow protection (if you try to type in a formula and forget a paren or closing quote or something you'll likely see an error, or maybe nothing, who knows).  Remember, it was only a prototype.</p>

<!-- GoCalc Prototype Excel Formula Parser - free for the taking -->

<style type="text/css">
td.token {
    font-family: "Lucida Sans Unicode", "Lucida Console", "Verdana";
    font-size: 8pt;
    white-space: nowrap;
    border-bottom: 1px #cecece solid;
}
</style><style class="darkreader darkreader--sync" media="screen"></style>

<p>Formula:<br>
<input type="text" id="formula" style="width: 500px">
<input type="submit" value="parse it" onclick="parseFormula(); return false;"></p>
<div id="tokens" style="margin-top: 5px; margin-bottom: 5px">&nbsp;</div>

<script type="text/javascript">

/*
Copyright (c) 2004-2017 E. W. Bachtal, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/

function parseFormula() {

  var indentCount = 0;
  
  var indent = function() {
    var s = "|";
    for (var i = 0; i < indentCount; i++) {
      s += "&nbsp;&nbsp;&nbsp;|";
    }  
    return s;
  };

  var formulaControl = document.getElementById("formula");  
  var formula = formulaControl.value;

  var tokens = getTokens(formula);

  var tokensHtml = "";
  
  tokensHtml += "<table cellspacing='0' style='border-top: 1px #cecece solid; margin-top: 5px; margin-bottom: 5px'>";
  tokensHtml += "<tr>";
  tokensHtml += "<td class='token' style='font-weight: bold; width: 50px'>index</td>";
  tokensHtml += "<td class='token' style='font-weight: bold; width: 125px'>type</td>";
  tokensHtml += "<td class='token' style='font-weight: bold; width: 125px'>subtype</td>";
  tokensHtml += "<td class='token' style='font-weight: bold; width: 150px'>token</td>";
  tokensHtml += "<td class='token' style='font-weight: bold; width: 300px'>token tree</td></tr>";

  while (tokens.moveNext()) {
  
    var token = tokens.current();

    if (token.subtype == TOK_SUBTYPE_STOP) 
      indentCount -= ((indentCount > 0) ? 1 : 0);

    tokensHtml += "<tr>";

    tokensHtml += "<td class='token'>" + (tokens.index + 1) + "</td>";

    tokensHtml += "<td class='token'>" + token.type + "</td>";
    tokensHtml += "<td class='token'>" + ((token.subtype.length == 0) ? "&nbsp;" : token.subtype) + "</td>";
    tokensHtml += "<td class='token'>" + ((token.value.length == 0) ? "&nbsp;" : token.value).split(" ").join("&nbsp;") + "</td>";
    tokensHtml += "<td class='token'>" + indent() + ((token.value.length == 0) ? "&nbsp;" : token.value).split(" ").join("&nbsp;") + "</td>";
    
    tokensHtml += "</tr>";

    if (token.subtype == TOK_SUBTYPE_START) 
      indentCount += 1;

  }
    
  tokensHtml += "</table>";
      
  document.getElementById("tokens").innerHTML = tokensHtml;
  
  formulaControl.select();
  formulaControl.focus();
  
}

var TOK_TYPE_NOOP      = "noop";
var TOK_TYPE_OPERAND   = "operand";
var TOK_TYPE_FUNCTION  = "function";
var TOK_TYPE_SUBEXPR   = "subexpression";
var TOK_TYPE_ARGUMENT  = "argument";
var TOK_TYPE_OP_PRE    = "operator-prefix";
var TOK_TYPE_OP_IN     = "operator-infix";
var TOK_TYPE_OP_POST   = "operator-postfix";
var TOK_TYPE_WSPACE    = "white-space";
var TOK_TYPE_UNKNOWN   = "unknown"

var TOK_SUBTYPE_START       = "start";
var TOK_SUBTYPE_STOP        = "stop";

var TOK_SUBTYPE_TEXT        = "text";
var TOK_SUBTYPE_NUMBER      = "number";
var TOK_SUBTYPE_LOGICAL     = "logical";
var TOK_SUBTYPE_ERROR       = "error";
var TOK_SUBTYPE_RANGE       = "range";

var TOK_SUBTYPE_MATH        = "math";
var TOK_SUBTYPE_CONCAT      = "concatenate";
var TOK_SUBTYPE_INTERSECT   = "intersect";
var TOK_SUBTYPE_UNION       = "union";


function f_token(value, type, subtype) {
  this.value = value;
  this.type = type;
  this.subtype = subtype;
}

function f_tokens() {
  
  this.items = new Array();
  
  this.add = function(value, type, subtype) { if (!subtype) subtype = ""; token = new f_token(value, type, subtype); this.addRef(token); return token; };
  this.addRef = function(token) { this.items.push(token); };
  
  this.index = -1;
  this.reset = function() { this.index = -1; };
  this.BOF = function() { return (this.index <= 0); };
  this.EOF = function() { return (this.index >= (this.items.length - 1)); };
  this.moveNext = function() { if (this.EOF()) return false; this.index++; return true; };
  this.current = function() { if (this.index == -1) return null; return (this.items[this.index]); };
  this.next = function() { if (this.EOF()) return null; return (this.items[this.index + 1]); };
  this.previous = function() { if (this.index < 1) return null; return (this.items[this.index - 1]); };

}

function f_tokenStack() {

  this.items = new Array();
  
  this.push = function(token) { this.items.push(token); };
  this.pop = function() { var token = this.items.pop(); return (new f_token("", token.type, TOK_SUBTYPE_STOP)); };
  
  this.token = function() { return ((this.items.length > 0) ? this.items[this.items.length - 1] : null); };
  this.value = function() { return ((this.token()) ? this.token().value : ""); };
  this.type = function() { return ((this.token()) ? this.token().type : ""); };
  this.subtype = function() { return ((this.token()) ? this.token().subtype : ""); };

}

function getTokens(formula) {

  var tokens = new f_tokens();
  var tokenStack = new f_tokenStack();

  var offset = 0;

  var currentChar = function() { return formula.substr(offset, 1); };
  var doubleChar  = function() { return formula.substr(offset, 2); };
  var nextChar    = function() { return formula.substr(offset + 1, 1); };
  var EOF         = function() { return (offset >= formula.length); };

  var token = "";

  var inString = false;
  var inPath = false;
  var inRange = false;
  var inError = false;
  
  while (formula.length > 0) {
    if (formula.substr(0, 1) == " ") 
      formula = formula.substr(1);
    else {
      if (formula.substr(0, 1) == "=") 
        formula = formula.substr(1);
      break;    
    }
  }

  var regexSN = /^[1-9]{1}(\.[0-9]+)?E{1}$/;
  
  while (!EOF()) {
  
    // state-dependent character evaluation (order is important)
    
    // double-quoted strings
    // embeds are doubled
    // end marks token
    
    if (inString) {    
      if (currentChar() == "\"") {
        if (nextChar() == "\"") {
          token += "\"";
          offset += 1;
        } else {
          inString = false;
          tokens.add(token, TOK_TYPE_OPERAND, TOK_SUBTYPE_TEXT);
          token = "";
        }      
      } else {
        token += currentChar();
      }
      offset += 1;
      continue;    
    } 

    // single-quoted strings (links)
    // embeds are double
    // end does not mark a token

    if (inPath) {
      if (currentChar() == "'") {
        if (nextChar() == "'") {
          token += "'";
          offset += 1;
        } else {
          inPath = false;
        }      
      } else {
        token += currentChar();
      }
      offset += 1;
      continue;    
    }    

    // bracked strings (range offset or linked workbook name)
    // no embeds (changed to "()" by Excel)
    // end does not mark a token
    
    if (inRange) {
      if (currentChar() == "]") {
        inRange = false;
      }
      token += currentChar();
      offset += 1;
      continue;
    }
    
    // error values
    // end marks a token, determined from absolute list of values
    
    if (inError) {
      token += currentChar();
      offset += 1;
      if ((",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,").indexOf("," + token + ",") != -1) {
        inError = false;
        tokens.add(token, TOK_TYPE_OPERAND, TOK_SUBTYPE_ERROR);
        token = "";
      }
      continue;
    }

    // scientific notation check

    if (("+-").indexOf(currentChar()) != -1) {
      if (token.length > 1) {
        if (token.match(regexSN)) {
          token += currentChar();
          offset += 1;
          continue;
        }
      }
    }

    // independent character evaulation (order not important)

    // establish state-dependent character evaluations
        
    if (currentChar() == "\"") {  
      if (token.length > 0) {
        // not expected
        tokens.add(token, TOK_TYPE_UNKNOWN);
        token = "";
      }
      inString = true;
      offset += 1;
      continue;
    }

    if (currentChar() == "'") {
      if (token.length > 0) {
        // not expected
        tokens.add(token, TOK_TYPE_UNKNOWN);
        token = "";
      }
      inPath = true;
      offset += 1;
      continue;
    }

    if (currentChar() == "[") {
      inRange = true;
      token += currentChar();
      offset += 1;
      continue;
    }

    if (currentChar() == "#") {
      if (token.length > 0) {
        // not expected
        tokens.add(token, TOK_TYPE_UNKNOWN);
        token = "";
      }
      inError = true;
      token += currentChar();
      offset += 1;
      continue;
    }
    
    // mark start and end of arrays and array rows

    if (currentChar() == "{") {  
      if (token.length > 0) {
        // not expected
        tokens.add(token, TOK_TYPE_UNKNOWN);
        token = "";
      }
      tokenStack.push(tokens.add("ARRAY", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START));
      tokenStack.push(tokens.add("ARRAYROW", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START));
      offset += 1;
      continue;
    }

    if (currentChar() == ";") {  
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.addRef(tokenStack.pop());
      tokens.add(",", TOK_TYPE_ARGUMENT);
      tokenStack.push(tokens.add("ARRAYROW", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START));
      offset += 1;
      continue;
    }

    if (currentChar() == "}") {  
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.addRef(tokenStack.pop());
      tokens.addRef(tokenStack.pop());
      offset += 1;
      continue;
    }
    
    // trim white-space
    
    if (currentChar() == " ") {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.add("", TOK_TYPE_WSPACE);
      offset += 1;
      while ((currentChar() == " ") && (!EOF())) { 
        offset += 1; 
      }
      continue;     
    }
    
    // multi-character comparators
    
    if ((",>=,<=,<>,").indexOf("," + doubleChar() + ",") != -1) {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.add(doubleChar(), TOK_TYPE_OP_IN, TOK_SUBTYPE_LOGICAL);
      offset += 2;
      continue;     
    }

    // standard infix operators
    
    if (("+-*/^&=><").indexOf(currentChar()) != -1) {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.add(currentChar(), TOK_TYPE_OP_IN);
      offset += 1;
      continue;     
    }

    // standard postfix operators
    
    if (("%").indexOf(currentChar()) != -1) {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.add(currentChar(), TOK_TYPE_OP_POST);
      offset += 1;
      continue;     
    }

    // start subexpression or function
    
    if (currentChar() == "(") {
      if (token.length > 0) {
        tokenStack.push(tokens.add(token, TOK_TYPE_FUNCTION, TOK_SUBTYPE_START));
        token = "";
      } else {
        tokenStack.push(tokens.add("", TOK_TYPE_SUBEXPR, TOK_SUBTYPE_START));
      }
      offset += 1;
      continue;
    }
    
    // function, subexpression, array parameters
    
    if (currentChar() == ",") {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      if (!(tokenStack.type() == TOK_TYPE_FUNCTION)) {
        tokens.add(currentChar(), TOK_TYPE_OP_IN, TOK_SUBTYPE_UNION);
      } else {
        tokens.add(currentChar(), TOK_TYPE_ARGUMENT);
      }
      offset += 1;
      continue;
    }

    // stop subexpression
    
    if (currentChar() == ")") {
      if (token.length > 0) {
        tokens.add(token, TOK_TYPE_OPERAND);
        token = "";
      }
      tokens.addRef(tokenStack.pop());
      offset += 1;
      continue;
    }

    // token accumulation
    
    token += currentChar();
    offset += 1;
  
  }

  // dump remaining accumulation
  
  if (token.length > 0) tokens.add(token, TOK_TYPE_OPERAND);
  
  // move all tokens to a new collection, excluding all unnecessary white-space tokens
  
  var tokens2 = new f_tokens();
  
  while (tokens.moveNext()) {

    token = tokens.current();
    
    if (token.type == TOK_TYPE_WSPACE) {
      if ((tokens.BOF()) || (tokens.EOF())) {}
      else if (!(
                 ((tokens.previous().type == TOK_TYPE_FUNCTION) && (tokens.previous().subtype == TOK_SUBTYPE_STOP)) || 
                 ((tokens.previous().type == TOK_TYPE_SUBEXPR) && (tokens.previous().subtype == TOK_SUBTYPE_STOP)) || 
                 (tokens.previous().type == TOK_TYPE_OPERAND)
                )
              ) {}
      else if (!(
                 ((tokens.next().type == TOK_TYPE_FUNCTION) && (tokens.next().subtype == TOK_SUBTYPE_START)) || 
                 ((tokens.next().type == TOK_TYPE_SUBEXPR) && (tokens.next().subtype == TOK_SUBTYPE_START)) ||
                 (tokens.next().type == TOK_TYPE_OPERAND)
                 )
               ) {}
      else 
        tokens2.add(token.value, TOK_TYPE_OP_IN, TOK_SUBTYPE_INTERSECT);
      continue;
    }

    tokens2.addRef(token);

  }

  // switch infix "-" operator to prefix when appropriate, switch infix "+" operator to noop when appropriate, identify operand 
  // and infix-operator subtypes, pull "@" from in front of function names
  
  while (tokens2.moveNext()) {

    token = tokens2.current();
    
    if ((token.type == TOK_TYPE_OP_IN) && (token.value == "-")) {
      if (tokens2.BOF())
        token.type = TOK_TYPE_OP_PRE;
      else if (
               ((tokens2.previous().type == TOK_TYPE_FUNCTION) && (tokens2.previous().subtype == TOK_SUBTYPE_STOP)) || 
               ((tokens2.previous().type == TOK_TYPE_SUBEXPR) && (tokens2.previous().subtype == TOK_SUBTYPE_STOP)) || 
               (tokens2.previous().type == TOK_TYPE_OP_POST) || 
               (tokens2.previous().type == TOK_TYPE_OPERAND)
              )
        token.subtype = TOK_SUBTYPE_MATH;
      else
        token.type = TOK_TYPE_OP_PRE;
      continue;
    }

    if ((token.type == TOK_TYPE_OP_IN) && (token.value == "+")) {
      if (tokens2.BOF())
        token.type = TOK_TYPE_NOOP;
      else if (
               ((tokens2.previous().type == TOK_TYPE_FUNCTION) && (tokens2.previous().subtype == TOK_SUBTYPE_STOP)) || 
               ((tokens2.previous().type == TOK_TYPE_SUBEXPR) && (tokens2.previous().subtype == TOK_SUBTYPE_STOP)) || 
               (tokens2.previous().type == TOK_TYPE_OP_POST) || 
               (tokens2.previous().type == TOK_TYPE_OPERAND)
              )
        token.subtype = TOK_SUBTYPE_MATH;
      else
        token.type = TOK_TYPE_NOOP;
      continue;
    }

    if ((token.type == TOK_TYPE_OP_IN) && (token.subtype.length == 0)) {
      if (("<>=").indexOf(token.value.substr(0, 1)) != -1) 
        token.subtype = TOK_SUBTYPE_LOGICAL;
      else if (token.value == "&")
        token.subtype = TOK_SUBTYPE_CONCAT;
      else
        token.subtype = TOK_SUBTYPE_MATH;
      continue;
    }
    
    if ((token.type == TOK_TYPE_OPERAND) && (token.subtype.length == 0)) {
      if (isNaN(parseFloat(token.value)))
        if ((token.value == 'TRUE') || (token.value == 'FALSE'))
          token.subtype = TOK_SUBTYPE_LOGICAL;
        else
          token.subtype = TOK_SUBTYPE_RANGE;
      else
        token.subtype = TOK_SUBTYPE_NUMBER;
      continue;
    }

    if (token.type == TOK_TYPE_FUNCTION) {
      if (token.value.substr(0, 1) == "@")
        token.value = token.value.substr(1);
      continue;
    }
        
  }
  
  tokens2.reset();

  // move all tokens to a new collection, excluding all noops
  
  tokens = new f_tokens();
  
  while (tokens2.moveNext()) {
    if (tokens2.current().type != TOK_TYPE_NOOP)
      tokens.addRef(tokens2.current());
  }  
  
  tokens.reset();
    
  return tokens;
}

</script>

<!-- End GoCalc Prototype Excel Formula Parser -->

<hr>

<p>Here are some sample formulas, if you want to try it out:</p>

<p>=IF("a"={"a","b";"c",#N/A;-1,TRUE}, "yes", "no") &amp;&nbsp;&nbsp; " &nbsp;more ""test"" text"</p>

<p>=+ AName- (-+-+-2^6) = {"A","B"} + @SUM(R1C1) + (@ERROR.TYPE(#VALUE!) = 2)</p>

<p>=IF(R13C3&gt;DATE(2002,1,6),0,IF(ISERROR(R[41]C[2]),0,IF(R13C3&gt;=R[41]C[2],0, IF(AND(R[23]C[11]&gt;=55,R[24]C[11]&gt;=20),R53C3,0))))</p>

<p>{=MAX(IF(ISERROR(SEARCH(H5&amp;"*",files)),0,ROW(files)-ROW(INDEX(files,1,1))+1))}</p>

<p>=IF(R[39]C[11]&gt;65,R[25]C[42],ROUND((R[11]C[11]*IF(OR(AND(R[39]C[11]&gt;=55, R[40]C[11]&gt;=20),AND(R[40]C[11]&gt;=20,R11C3="YES")),R[44]C[11],R[43]C[11]))+(R[14]C[11] *IF(OR(AND(R[39]C[11]&gt;=55,R[40]C[11]&gt;=20),AND(R[40]C[11]&gt;=20,R11C3="YES")), R[45]C[11],R[43]C[11])),0))</p>

<hr>

<p>There are as many ways to parse an expression as there are expressions.  For our purposes, however, there were some unique requirements which sort of framed our final approach.  The most significant of these was that we had to be able to parse an expression without advance knowledge of its possible contents.  For example, we had to be able to parse an expression without knowing the universe of possible functions that may appear in it, or how many (or what kind of) parameters they might take.  This lack of advanced knowledge sort of eliminated the possibility of us constructing an unambiguous <a href="https://web.archive.org/web/20191002095802/http://www.garshol.priv.no/download/text/bnf.html">BNF</a> description to feed to <a href="https://web.archive.org/web/20191002095802/http://plan9.bell-labs.com/magic/man2html/1/yacc">YACC</a> or <a href="https://web.archive.org/web/20191002095802/http://dinosaur.compilertools.net/bison/manpage.html">BISON</a> or <a href="https://web.archive.org/web/20191002095802/http://www.antlr.org/">ANTLR</a> or some other "compiler compiler" (well, that and the fact that BNF and parse trees are <a href="https://web.archive.org/web/20191002095802/http://www.cs.rochester.edu/users/faculty/nelson/courses/csc_173/grammars/parsetrees.html">hard</a> and this is still an unpaid project).</p>

<p>Instead, we figured it was possible to understand enough of the rules inherent in Excel's formula language to write a simple state- and stack-based tokenizer, with some post-parse passes to contextually adjust the resulting tokens.  In the end, this was the approach we adopted, and the prototype above illustrates some of our earlier work along those lines.</p>

<p>I don't have time to describe all of the issues we encountered while figuring this out, but there are some points worth mentioning, in case you decide to try this on your own.</p>

<ul>
<li>In some cases, Excel considers "+" to be a valid unary operator, along with "-", and will preserve it in the formula, although in the end it's a no-op.</li>
<li>For some reason Excel uses a comma as the range union operator.  This means that its only unambiguous use between ranges is outside of a function call or within a subexpression (i.e., between parentheses).</li>
<li>For some other reason Excel uses a space (or multiple spaces) as the range intersection operator.  While not as ambiguous as the comma, it does require some consideration.</li>
<li>If you see an open paren immediately preceded by one or more characters, it's a function.</li>
<li>Don't forget that Excel still allows functions to be preceded with an "@".</li>
<li>String constants are always surrounded by double quotes, and interior double quotes are always doubled up.</li>
<li>The same is true for single quotes surrounding linked workbook paths and the sheet names of off-sheet references.</li>
<li>R1C1-style addresses use brackets to surround relative offsets (e.g., R[-1]C[3]).  Oh, and there's that unary operator again.</li>
<li>Don't forget that array constants (surrounded by braces "{}") can contain rows, which are delimited with semicolons ";".  Note that in the above prototype we treated array constants as function calls: ARRAY() and ARRAYROW().</li>
</ul>

<p>Here are some additional resources you might find interesting:</p>

<p>Great explanation of parse trees: <a href="https://web.archive.org/web/20191002095802/http://homepage.smc.edu/kennedy_john/PARSETREES.PDF">http://homepage.smc.edu/kennedy_john/PARSETREES.PDF</a></p>

<p>An overview of Excel reference operators: <a href="https://web.archive.org/web/20191002095802/http://chacocanyon.com/smm/readings/referenceoperators.shtml">http://chacocanyon.com/smm/readings/referenceoperators.shtml</a></p>

<p>Some Excel formula BNF: <a href="https://web.archive.org/web/20191002095802/http://www.mcs.vuw.ac.nz/~db/FishBrainWiki?Excel">http://www.mcs.vuw.ac.nz/~db/FishBrainWiki?Excel</a></p>

<p>Here's a little piece on parsing Excel formulas the hard way with <a href="https://web.archive.org/web/20191002095802/http://www.kuro5hin.org/story/2002/11/14/22741/791">K</a>: <a href="https://web.archive.org/web/20191002095802/http://www.nsl.com/papers/excel.htm">http://www.nsl.com/papers/excel.htm</a></p>

<blockquote>To tokenize a formula, I use M/ (index-over = pointer-chasing) and a small state-transition table. I think it is possible to do tokenizing using ONLY a state-transition table, but this requires too many states. Consequently, I use this method to bust up a formula into alphanumeric constants, strings of operator symbols, and sequences within quotes and brackets. I then perform several post- processing steps on the resulting list of strings to find unary minus, negative constants, and multi-token symbolic operators (e.g. '&lt;='). Although K supports several standard iterators (do and while), I've required them in only one place; namely, to resolve the ambiguity of Excel's comma. Within the scope of an aggregator, comma means Union; for example, Sum(x,y,z) means: Sum the values in the union of the ranges x, y, and z. Sum has valence 1. But, within the scope of a function, comma operates as an argument separator; for example, If(x,y,z) has valence 3, and means: if x is true, then y, else z. So far, I have been unable to find a non-looping method for determining which commas are which.</blockquote>

<p>Someone get that guy a Pabst Blue Ribbon!</p>

<a id="more"></a>


<p>



<br>
</p><h2 class="dateheader"><a id="comments"></a>Comments</h2>


<a id="c3270904"></a>
<p>You sir, are one incredibly smart man.  I have no idea what I could use this for, but I already booked marked it.</p>

<p>Genius, pure genius.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://blogs.geekdojo.net/ryan" href="https://web.archive.org/web/20191002095802/http://blogs.geekdojo.net/ryan">Ryan A. Rinaldi</a> | 2004.12.29 07:30 AM</p>

<a id="c3272461"></a>
<p>Aw, shucks.  Thanks, Ryan.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2004.12.29 10:18 AM</p>

<a id="c4704392"></a>
<p>Check out Rob van Gelder's formula parsing Excel add-in - very cool!</p>

<p><a href="https://web.archive.org/web/20191002095802/http://www.dicks-blog.com/archives/2005/04/01/excel-formula-formatter/" rel="nofollow">http://www.dicks-blog.com/archives/2005/04/01/excel-formula-formatter/</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2005.04.02 06:14 AM</p>

<a id="c4713732"></a>
<p>Definitely bent my brain tonight — thanks for sharing!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.anova.org/software/" href="https://web.archive.org/web/20191002095802/http://www.anova.org/software/">Zaine Ridling</a> | 2005.04.02 11:27 PM</p>

<a id="c4724699"></a>
<p>You're welcome!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2005.04.03 11:40 PM</p>

<a id="c4929341"></a>
<p>Hi Eric.</p>

<p>Version 1.00 is available for download.</p>

<p>Cheers,<br>
Rob</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.vangelder.co.nz/excel" href="https://web.archive.org/web/20191002095802/http://www.vangelder.co.nz/excel">Rob van Gelder</a> | 2005.04.15 03:42 AM</p>

<a id="c5416748"></a>
<p>actually, i prefer boddington's pub ale, in the can with the little doo-hickey.</p>

<p>thanks for the link (although i'm not quite sure why you think i did it "the hard way".)</p>

<p>sa<br>
</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.nsl.com" href="https://web.archive.org/web/20191002095802/http://www.nsl.com/">sa</a> | 2005.05.05 04:14 AM</p>

<a id="c5421360"></a>
<p>sa,</p>

<p>You're welcome.  I hope a lot of folks interested in this stuff make it over to your "no stinking loops" site to check out the content:</p>

<p><a href="https://web.archive.org/web/20191002095802/http://www.nsl.com/" rel="nofollow">http://www.nsl.com/</a></p>

<p>Nix the PBR, right.  </p>

<p>And "the hard way" is a euphemism for "requiring more brains than my way".  ;)</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2005.05.05 08:33 AM</p>

<a id="c6639538"></a>
<p>Thats a great work. After searching for days I found a good parser!!!!</p>
<p class="posted">BeginnerVB_Net | 2005.07.01 10:43 AM</p>

<a id="c7330191"></a>
<p>Thanks for saving me a lot of time!</p>
<p class="posted">steve | 2005.07.13 04:39 PM</p>

<a id="c7331469"></a>
<p>No problem - glad I could help.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2005.07.13 05:59 PM</p>

<a id="c14394008"></a>
<p>i want to sorting between to sheets is it possible plz advice</p>
<p class="posted">shazad | 2006.02.26 07:55 PM</p>

<a id="c14403657"></a>
<p>Hi Shazad - Not sure I can help, but to know that I'll need a little more info.  First, are you referring at all to parsing Excel formulas (the main thrust of this post)?  Second, what exactly are you looking to sort within Excel and how?  </p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2006.02.27 06:43 AM</p>

<a id="c19841869"></a>
<p>I am very interested in the execl formula and the usuage, I will be glad if you can send me more literatures on the formula and usage through my e-mail address.</p>

<p>Thanks</p>
<p class="posted">Sani Bello | 2006.07.17 03:08 AM</p>

<a id="c20217380"></a>
<p>I don't get it.  </p>

<p>I have a bunch of data in one cell, separated by commas.  I want a formula to parse instead of always having to use the text to column function.  Can you help?</p>
<p class="posted">j | 2006.07.26 02:12 PM</p>

<a id="c20223240"></a>
<p>Hi j,</p>

<p>I might be able to help, but this post doesn't address your need.  This post is about parsing excel formulas, not about Excel formulas for parsing text.  </p>

<p>For the latter, the text to column function is your best bet for splitting and spreading the delimited/fixed-length content of a cell (or column of cells) across multiple columns.  It's also possible to write a VBA macro that does the split and spread, which might prove easier to use over and over, assuming the data structure is known and doesn't change.  In terms of using formulas, you can't - at least not if you want one formula to split and spread items to other cells, because formulas can only affect the cells in which they reside.  However, if the number of items to split is fixed, you can use a set of formulas to retrieve data from particular positions in the text, and then if necessary repeat the formulas down subsequent rows.</p>

<p>Let me know if you'd like to discuss further.  Good luck.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops">ewbi.develops</a> | 2006.07.26 05:06 PM</p>

<a id="c23715425"></a>
<p>Excellent. Thank you very much.</p>
<p class="posted">AK | 2006.10.10 03:42 PM</p>

<a id="c23735198"></a>
<p>You're welcome.  I'll be posting a C# implementation soon, too.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2006.10.10 08:24 PM</p>

<a id="c25456531"></a>
<p>Nice work!  Here's a Python port of the algorithm.  Might be of use to someone?</p>

<p><br>
#========================================================================<br>
# Description: Tokenise an Excel formula using an implementation of<br>
#              E. W. Bachtal's algorithm, found here:<br>
#<br>
#                  <a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html" rel="nofollow">http://ewbi.blogs.com/develops/2004/12/excel_formula_p.html</a><br>
#<br>
#              Tested with Python v2.5 (win32)<br>
#      Author: Robin Macharg<br>
#   Copyright: Algorithm (c) E. W. Bachtal, this implementation (c) R. Macharg<br>
#<br>
# CVS Info:<br>
# $Header: T:\\cvsarchive/Excel\040export\040&amp;\040import\040XML/ExcelXMLTransform/EWBI_Javascript_port/jsport.py,v 1.3 2006/11/17 13:27:32 rmacharg Exp $<br>
#<br>
# Modification History<br>
#<br>
# Date         Author Comment<br>
# =======================================================================<br>
# 2006/11    - RMM  - RMM = Robin Macharg<br>
#                           Created<br>
#========================================================================</p>

<p># Token definitions<br>
TOK_TYPE_NOOP           = "noop";<br>
TOK_TYPE_OPERAND        = "operand";<br>
TOK_TYPE_FUNCTION       = "function";<br>
TOK_TYPE_SUBEXPR        = "subexpression";<br>
TOK_TYPE_ARGUMENT       = "argument";<br>
TOK_TYPE_OP_PRE         = "operator-prefix";<br>
TOK_TYPE_OP_IN          = "operator-infix";<br>
TOK_TYPE_OP_POST        = "operator-postfix";<br>
TOK_TYPE_WSPACE         = "white-space";<br>
TOK_TYPE_UNKNOWN        = "unknown"</p>

<p>TOK_SUBTYPE_START       = "start";<br>
TOK_SUBTYPE_STOP        = "stop";</p>

<p>TOK_SUBTYPE_TEXT        = "text";<br>
TOK_SUBTYPE_NUMBER      = "number";<br>
TOK_SUBTYPE_LOGICAL     = "logical";<br>
TOK_SUBTYPE_ERROR       = "error";<br>
TOK_SUBTYPE_RANGE       = "range";<br>
TOK_SUBTYPE_MATH        = "math";<br>
TOK_SUBTYPE_CONCAT      = "concatenate";<br>
TOK_SUBTYPE_INTERSECT   = "intersect";<br>
TOK_SUBTYPE_UNION       = "union";</p>

<p>#========================================================================<br>
#       Class: f_token <br>
# Description: Encapsulate a formula token<br>
#     Methods: __init__()<br>
#  Attributes:   tvalue - <br>
#                 ttype - See token definitions, above, for values<br>
#              tsubtype - See token definitions, above, for values<br>
#========================================================================<br>
class f_token:<br>
    def __init__(self, value, type, subtype):<br>
        self.tvalue   = value<br>
        self.ttype    = type<br>
        self.tsubtype = subtype</p>

<p>#========================================================================<br>
#       Class: f_tokens <br>
# Description: An ordered list of tokens</p>

<p>#  Attributes: items - Ordered list <br>
#              index - Current position in the list<br>
#<br>
#     Methods:                __init__()<br>
#              f_token      - add()      - Add a token to the end of the list<br>
#              None         - addRef()   - Add a token to the end of the list<br>
#              None         - reset()    - reset the index to -1<br>
#              Boolean      - BOF()      - End of list?<br>
#              Boolean      - EOF()      - Beginning of list?<br>
#              Boolean      - moveNext() - Move the index along one<br>
#              f_token/None - current()  - Return the current token<br>
#              f_token/None - next()     - Return the next token (leave the index unchanged)<br>
#              f_token/None - previous() - Return the previous token (leave the index unchanged)<br>
#========================================================================<br>
class f_tokens:<br>
    def __init__(self):<br>
        self.items = []<br>
        self.index = -1<br>
  <br>
    def add(self, value, type, subtype=""):<br>
        if (not subtype):<br>
            subtype = ""<br>
        token = f_token(value, type, subtype)<br>
        self.addRef(token)<br>
        return token<br>
        <br>
    def addRef(self, token):<br>
        self.items.append(token)<br>
        <br>
    def reset(self):<br>
        self.index = -1<br>
 <br>
    def BOF(self):<br>
        return self.index = (len(self.items) - 1)</p>

<p>    def moveNext(self):<br>
        if self.EOF():<br>
            return False<br>
        self.index += 1<br>
        return True<br>
    <br>
    def current(self):<br>
        if self.index == -1:<br>
            return None<br>
        return self.items[self.index]</p>

<p>    def next(self):<br>
        if self.EOF():<br>
            return None<br>
        return self.items[self.index + 1]<br>
    <br>
    def previous(self):<br>
        if self.index  0) and [self.items[len(self.items) - 1]] or [None])[0]<br>
    <br>
    def value(self):<br>
        return ((self.token()) and [(self.token()).tvalue] or [""])[0]    </p>

<p>    def type(self):<br>
        t = self.token()<br>
        return ((self.token()) and [(self.token()).ttype] or [""])[0]<br>
    <br>
    def subtype(self):<br>
        return ((self.token()) and [(self.token()).tsubtype] or [""])[0]</p>

<p>#========================================================================<br>
#    Function: getTokens() <br>
# Description: Parse an Excel formula into constituent tokens.<br>
#   Arguments: String   - formula - The formula to parse<br>
#     Returns: f_tokens - tokens  - A list of tokens, parsed from the formula<br>
#========================================================================<br>
def getTokens(formula):</p>

<p>    def currentChar():<br>
        return formula[offset]</p>

<p>    def doubleChar():<br>
        return formula[offset:offset+2]<br>
    <br>
    def nextChar():<br>
        # JavaScript returns an empty string if the index is out of bounds,<br>
        # Python throws an IndexError.  We mimic this behaviour here.<br>
        try:<br>
            formula[offset+1]<br>
        except IndexError:<br>
            return ""<br>
        else:            <br>
            return formula[offset+1]<br>
    <br>
    def EOF():<br>
        return offset &gt;= len(formula)</p>

<p>    tokens     = f_tokens()<br>
    tokenStack = f_tokenStack()<br>
    offset     = 0<br>
    token      = ""<br>
    inString   = False<br>
    inPath     = False<br>
    inRange    = False<br>
    inError    = False</p>

<p>    while (len(formula) &gt; 0):<br>
        if (formula[0] == " "):<br>
            formula = formula[1:]<br>
        else:<br>
            if (formula[0] == "="):<br>
                formula = formula[1:]<br>
            break;    </p>

<p>    # state-dependent character evaluation (order is important)<br>
    while not EOF():<br>
           <br>
        # double-quoted strings<br>
        # embeds are doubled<br>
        # end marks token<br>
        if inString:<br>
            if currentChar() == "\"":<br>
                if nextChar() == "\"":<br>
                    token += "\""<br>
                    offset += 1<br>
                else:<br>
                    inString = False<br>
                    tokens.add(token, TOK_TYPE_OPERAND, TOK_SUBTYPE_TEXT)<br>
                    token = ""<br>
            else:<br>
                token += currentChar()<br>
            offset += 1<br>
            continue</p>

<p>        # single-quoted strings (links)<br>
        # embeds are double<br>
        # end does not mark a token<br>
        if inPath:<br>
            if currentChar() == "'":<br>
                if nextChar() == "'":<br>
                    token += "'"<br>
                    offset += 1<br>
                else:<br>
                    inPath = False<br>
            else:<br>
                token += currentChar()<br>
            offset += 1;<br>
            continue;    </p>

<p>        # bracketed strings (range offset or linked workbook name)<br>
        # no embeds (changed to "()" by Excel)<br>
        # end does not mark a token<br>
        if inRange:<br>
            if currentChar() == "]":<br>
                inRange = False<br>
            token += currentChar()<br>
            offset += 1<br>
            continue</p>

<p>        # error values<br>
        # end marks a token, determined from absolute list of values<br>
        if inError:<br>
            token += currentChar()<br>
            offset += 1<br>
            if ",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".find("," + token + ",") != -1:<br>
                inError = False<br>
                tokens.add(token, TOK_TYPE_OPERAND, TOK_SUBTYPE_ERROR)<br>
                token = ""<br>
            continue;</p>

<p>        # independent character evaulation (order not important)<br>
        #<br>
        # establish state-dependent character evaluations<br>
        if currentChar() == "\"":<br>
            if len(token) &gt; 0:<br>
                # not expected<br>
                tokens.add(token, TOK_TYPE_UNKNOWN)<br>
                token = ""<br>
            inString = True<br>
            offset += 1<br>
            continue</p>

<p>        if currentChar() == "'":<br>
            if len(token) &gt; 0:<br>
                # not expected<br>
                tokens.add(token, TOK_TYPE_UNKNOWN)<br>
                token = ""<br>
            inPath = True<br>
            offset += 1<br>
            continue</p>

<p>        if (currentChar() == "["):<br>
            inRange = True<br>
            token += currentChar()<br>
            offset += 1<br>
            continue</p>

<p>        if (currentChar() == "#"):<br>
            if (len(token) &gt; 0):<br>
                # not expected<br>
                tokens.add(token, TOK_TYPE_UNKNOWN)<br>
                token = ""<br>
            inError = True<br>
            token += currentChar()<br>
            offset += 1<br>
            continue</p>

<p>        # mark start and end of arrays and array rows<br>
        if (currentChar() == "{"):<br>
            if (len(token) &gt; 0):<br>
                # not expected<br>
                tokens.add(token, TOK_TYPE_UNKNOWN)<br>
                token = ""<br>
            tokenStack.push(tokens.add("ARRAY", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START))<br>
            tokenStack.push(tokens.add("ARRAYROW", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START))<br>
            offset += 1<br>
            continue</p>

<p>        if (currentChar() == ";"):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.addRef(tokenStack.pop())<br>
            tokens.add(",", TOK_TYPE_ARGUMENT)<br>
            tokenStack.push(tokens.add("ARRAYROW", TOK_TYPE_FUNCTION, TOK_SUBTYPE_START))<br>
            offset += 1<br>
            continue</p>

<p>        if (currentChar() == "}"):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.addRef(tokenStack.pop())<br>
            tokens.addRef(tokenStack.pop())<br>
            offset += 1<br>
            continue</p>

<p>        # trim white-space<br>
        if (currentChar() == " "):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.add("", TOK_TYPE_WSPACE)<br>
            offset += 1<br>
            while ((currentChar() == " ") and (not EOF())):<br>
                offset += 1<br>
            continue</p>

<p>        # multi-character comparators<br>
        if (",&gt;=,,".find("," + doubleChar() + ",") != -1):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.add(doubleChar(), TOK_TYPE_OP_IN, TOK_SUBTYPE_LOGICAL)<br>
            offset += 2<br>
            continue</p>

<p>        # standard infix operators<br>
        if ("+-*/^&amp;=&gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.add(currentChar(), TOK_TYPE_OP_IN)<br>
            offset += 1<br>
            continue</p>

<p>        # standard postfix operators<br>
        if ("%".find(currentChar()) != -1):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.add(currentChar(), TOK_TYPE_OP_POST)<br>
            offset += 1<br>
            continue</p>

<p>        # start subexpression or function<br>
        if (currentChar() == "("):<br>
            if (len(token) &gt; 0):<br>
                tokenStack.push(tokens.add(token, TOK_TYPE_FUNCTION, TOK_SUBTYPE_START))<br>
                token = ""<br>
            else:<br>
                tokenStack.push(tokens.add("", TOK_TYPE_SUBEXPR, TOK_SUBTYPE_START))<br>
            offset += 1<br>
            continue</p>

<p>        # function, subexpression, array parameters<br>
        if (currentChar() == ","):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            if (not (tokenStack.type() == TOK_TYPE_FUNCTION)):<br>
                tokens.add(currentChar(), TOK_TYPE_OP_IN, TOK_SUBTYPE_UNION)<br>
            else:<br>
                tokens.add(currentChar(), TOK_TYPE_ARGUMENT)<br>
            offset += 1<br>
            continue</p>

<p>        # stop subexpression<br>
        if (currentChar() == ")"):<br>
            if (len(token) &gt; 0):<br>
                tokens.add(token, TOK_TYPE_OPERAND)<br>
                token = ""<br>
            tokens.addRef(tokenStack.pop())<br>
            offset += 1<br>
            continue</p>

<p>        # token accumulation<br>
        token += currentChar()<br>
        offset += 1</p>

<p>    # dump remaining accumulation<br>
    if (len(token) &gt; 0): <br>
        tokens.add(token, TOK_TYPE_OPERAND)</p>

<p>    # move all tokens to a new collection, excluding all unnecessary white-space tokens<br>
    tokens2 = f_tokens()</p>

<p>    while (tokens.moveNext()):<br>
        token = tokens.current();</p>

<p>        if (token.ttype == TOK_TYPE_WSPACE):<br>
            if ((tokens.BOF()) or (tokens.EOF())):<br>
                pass<br>
            elif (not(<br>
                 ((tokens.previous().ttype == TOK_TYPE_FUNCTION) and (tokens.previous().tsubtype == TOK_SUBTYPE_STOP)) or <br>
                 ((tokens.previous().ttype == TOK_TYPE_SUBEXPR) and (tokens.previous().tsubtype == TOK_SUBTYPE_STOP)) or <br>
                 (tokens.previous().ttype == TOK_TYPE_OPERAND)<br>
                )<br>
              ):<br>
                pass<br>
            elif (not(<br>
                 ((tokens.next().ttype == TOK_TYPE_FUNCTION) and (tokens.next().tsubtype == TOK_SUBTYPE_START)) or<br>
                 ((tokens.next().ttype == TOK_TYPE_SUBEXPR) and (tokens.next().tsubtype == TOK_SUBTYPE_START)) or<br>
                 (tokens.next().ttype == TOK_TYPE_OPERAND)<br>
                 )<br>
               ):<br>
                pass<br>
            else:<br>
                tokens2.add(token.tvalue, TOK_TYPE_OP_IN, TOK_SUBTYPE_INTERSECT)<br>
            continue</p>

<p>        tokens2.addRef(token);</p>

<p>    # switch infix "-" operator to prefix when appropriate, switch infix "+" operator to noop when appropriate, identify operand <br>
    # and infix-operator subtypes, pull "@" from in front of function names<br>
    while (tokens2.moveNext()):<br>
        token = tokens2.current()<br>
        if ((token.ttype == TOK_TYPE_OP_IN) and (token.tvalue == "-")):<br>
            if (tokens2.BOF()):<br>
                token.ttype = TOK_TYPE_OP_PRE<br>
            elif (<br>
               ((tokens2.previous().ttype == TOK_TYPE_FUNCTION) and (tokens2.previous().tsubtype == TOK_SUBTYPE_STOP)) or<br>
               ((tokens2.previous().ttype == TOK_TYPE_SUBEXPR) and (tokens2.previous().tsubtype == TOK_SUBTYPE_STOP)) or<br>
               (tokens2.previous().ttype == TOK_TYPE_OP_POST) or <br>
               (tokens2.previous().ttype == TOK_TYPE_OPERAND)<br>
              ):<br>
                token.tsubtype = TOK_SUBTYPE_MATH;<br>
            else:<br>
                token.ttype = TOK_TYPE_OP_PRE<br>
            continue</p>

<p>        if ((token.ttype == TOK_TYPE_OP_IN) and (token.tvalue == "+")):<br>
            if (tokens2.BOF()):<br>
                token.ttype = TOK_TYPE_NOOP<br>
            elif (<br>
               ((tokens2.previous().ttype == TOK_TYPE_FUNCTION) and (tokens2.previous().tsubtype == TOK_SUBTYPE_STOP)) or <br>
               ((tokens2.previous().ttype == TOK_TYPE_SUBEXPR) and (tokens2.previous().tsubtype == TOK_SUBTYPE_STOP)) or <br>
               (tokens2.previous().ttype == TOK_TYPE_OP_POST) or <br>
               (tokens2.previous().ttype == TOK_TYPE_OPERAND)<br>
              ):<br>
                token.tsubtype = TOK_SUBTYPE_MATH<br>
            else:<br>
                token.ttype = TOK_TYPE_NOOP<br>
            continue</p>

<p>        if ((token.ttype == TOK_TYPE_OP_IN) and (len(token.tsubtype) == 0)):<br>
            if (("&lt;&gt;=").find(token.tvalue[0:1]) != -1):<br>
                token.tsubtype = TOK_SUBTYPE_LOGICAL<br>
            elif (token.tvalue == "&amp;"):<br>
                token.tsubtype = TOK_SUBTYPE_CONCAT<br>
            else:<br>
                token.tsubtype = TOK_SUBTYPE_MATH<br>
            continue<br>
    <br>
        if ((token.ttype == TOK_TYPE_OPERAND) and (len(token.tsubtype) == 0)):<br>
            try:<br>
                float(token.tvalue)<br>
            except ValueError, e:<br>
                if ((token.tvalue == 'TRUE') or (token.tvalue == 'FALSE')):<br>
                    token.tsubtype = TOK_SUBTYPE_LOGICAL<br>
                else:<br>
                    token.tsubtype = TOK_SUBTYPE_RANGE<br>
            else:<br>
                token.tsubtype = TOK_SUBTYPE_NUMBER<br>
            continue</p>

<p>        if (token.ttype == TOK_TYPE_FUNCTION):<br>
            if (token.tvalue[0:1] == "@"):<br>
                token.tvalue = token.tvalue[1:]<br>
            continue</p>

<p>    tokens2.reset();</p>

<p>    # move all tokens to a new collection, excluding all noops<br>
    tokens = f_tokens()<br>
    while (tokens2.moveNext()):<br>
        if (tokens2.current().ttype != TOK_TYPE_NOOP):<br>
            tokens.addRef(tokens2.current())</p>

<p>    tokens.reset()<br>
    return tokens</p>

<p>#========================================================================<br>
# Main code:<br>
#<br>
# A simple test-rig.  Iterate through a list of test input strings, <br>
# outputing a nested display of the token stream parsed from each one.<br>
#========================================================================<br>
if __name__ == "__main__":<br>
    <br>
    # Test inputs<br>
    inputs = [<br>
              # Simple test formulae<br>
              '=1+3+5',<br>
              '=3 * 4 + 5',<br>
              '=50',<br>
              '=1+1',<br>
              '=$A1',<br>
              '=$B$2',<br>
              '=SUM(B5:B15)',<br>
              '=SUM(B5:B15,D5:D15)',<br>
              '=SUM(B5:B15 A7:D7)',<br>
              '=SUM(sheet1!$A$1:$B$2)',<br>
              '=[data.xls]sheet1!$A$1',<br>
              '=SUM((A:A 1:1))',<br>
              '=SUM((A:A,1:1))',<br>
              '=SUM((A:A A1:B1))',<br>
              '=SUM(D9:D11,E9:E11,F9:F11)',<br>
              '=SUM((D9:D11,(E9:E11,F9:F11)))',<br>
              '=IF(P5=1.0,"NA",IF(P5=2.0,"A",IF(P5=3.0,"B",IF(P5=4.0,"C",IF(P5=5.0,"D",IF(P5=6.0,"E",IF(P5=7.0,"F",IF(P5=8.0,"G"))))))))',<br>
              '={SUM(B2:D2*B3:D3)}',<br>
              '=SUM(123 + SUM(456) + (45DATE(2002,1,6),0,IF(ISERROR(R[41]C[2]),0,IF(R13C3&gt;=R[41]C[2],0, IF(AND(R[23]C[11]&gt;=55,R[24]C[11]&gt;=20),R53C3,0))))',<br>
              '=IF(R[39]C[11]&gt;65,R[25]C[42],ROUND((R[11]C[11]*IF(OR(AND(R[39]C[11]&gt;=55, ' + <br>
                  'R[40]C[11]&gt;=20),AND(R[40]C[11]&gt;=20,R11C3="YES")),R[44]C[11],R[43]C[11]))+(R[14]C[11] ' +<br>
                  '*IF(OR(AND(R[39]C[11]&gt;=55,R[40]C[11]&gt;=20),AND(R[40]C[11]&gt;=20,R11C3="YES")), ' +<br>
                  'R[45]C[11],R[43]C[11])),0))',<br>
              ]<br>
    <br>
    for i in inputs:<br>
        print "========================================"<br>
        print "Formula:", i<br>
        indent = 0<br>
        for t in (getTokens(i)).items:</p>

<p>            if (t.tsubtype == TOK_SUBTYPE_STOP):<br>
                indent -= 1</p>

<p>            print "    "*indent + t.tvalue + "  "<br>
            <br>
            if (t.tsubtype == TOK_SUBTYPE_START):<br>
                indent += 1;</p>
<p class="posted">Robin Macharg | 2006.11.17 05:34 AM</p>

<a id="c25456717"></a>
<p>Rats.  The indentation's got munged which, for Python, is a BAD THING.  Can this be fixed?  If not contact me for a correctly formatted copy of the code.</p>
<p class="posted">Robin Macharg | 2006.11.17 05:39 AM</p>

<a id="c63837104"></a>
<p>Finally got the C# code loaded, and a very belated thanks to Robin for the Python port - very cool!</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2007/03/excel_formula_p.html" rel="nofollow">http://ewbi.blogs.com/develops/2007/03/excel_formula_p.html</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2007.03.20 01:12 PM</p>

<a id="c65228684"></a>
<p>I've discovered a bug in this parser. Try for example =6.0E-5 ; it will be parsed as three tokens (two operands and the - as the operator) instead of a single number. Anyone an idea of how to easily fix this?</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://tjaard.nl" href="https://web.archive.org/web/20191002095802/http://tjaard.nl/">Tjaard</a> | 2007.04.03 05:01 AM</p>

<a id="c65313940"></a>
<p>Oops, thanks Tjaard.  I rarely use scientific notation, and I've noticed Excel (2003, at least) converts up to 16 places to the literal number in my formulas anyway.  So, for example, your example of =6.0E-5 becomes =0.00006  .  However, after 16 places it sticks, so the parser needs to account for it.  I'll have to give this some thought, I don't think there's a simple solution.  Unfortunately, I've got no time to fix it now, but I'll give it a look as soon as time allows.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2007.04.03 07:11 PM</p>

<a id="c67738206"></a>
<p>This is a really cool tool! And it looks you can also use it to parse SQL Server Reporting Services expressions.</p>

<p>Thanks for such a cool tool</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.hatchboard.com" href="https://web.archive.org/web/20191002095802/http://www.hatchboard.com/">Armando</a> | 2007.04.26 11:58 AM</p>

<a id="c69182002"></a>
<p>Hey, if any of u guy's might be able to help me with a simple formula in EXCEL!! This is for a transport company!  If the driver's code is entered into a cell eg. ss01, then i want the following cells to enter certain data from another excel sheet.  Let's say there's 20 drivers starting from ss01 to ss20?  When i type ss05, then te detail for that driver must automaticaly write to certain cell's?  is this possible, and if yes, please help!! Kind regards, DARRYL!</p>
<p class="posted">Darryl | 2007.05.11 05:51 AM</p>

<a id="c69209328"></a>
<p>Darryl,</p>

<p>I believe what you're asking is possible, though it's hard to say for certain without additional details.  In so much as this is a post regarding formula parsing, not Excel formula implementations, why don't you send me an email at info@ewbi.com with additional details regarding your needs and we'll see if we can figure it out.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2007.05.11 09:52 AM</p>

<a id="c74842744"></a>
<p>Thank you genius for saving me a lot of time. I am implementing a JS excel spreadsheet and that was very useful for me !!</p>
<p class="posted">Andrea Pradarelli | 2007.07.04 04:30 AM</p>

<a id="c83262117"></a>
<p>Great job.  I do have a question.  I'm wondering what is best way to use the parsed tokens in terms of basically finding an end point...for example:</p>

<p>=10*2^(2*(1+1))</p>

<p>Let's say I wanted to process the ^ because it is not valid in Javascript that I know of so I want to swap it out for Math.pow().  I need to wrap (2*(1+1)) inside the pow() function and wondering if there are any samples of basically 'GetNextEntity' or something that will get the entire 'next thing' that is valid in a formula.  Maybe I have a ton of reading to do (based on all your suggestions) but thought I'd ask in case it is something commonly done already.</p>
<p class="posted">Terry | 2007.09.18 08:35 PM</p>

<a id="c83337265"></a>
<p>Hi Terry,</p>

<p>You are correct that the parser outlined in this post (and updated in some subsequent posts) doesn't do this.  The activity you describe involves interpreting the parser's resulting tokens, pushing and popping lexical scopes (similar to the test code above pushing and popping levels for tree-style presentation), and dealing with operator precedence, usually recursively.  So, for instance, having walked the tokens up to the ^, you would prepare a context for what follows, and proceed (pushing and popping scope for functions and subexpressions as necessary) until you encounter (or are about to pop out of) the same scope as the ^, another operator of greater precedence, or run out of tokens; everything that you have accumulated to that point would represent the expression on the right side of the ^.  Here are some additional examples that illustrate the effort required:</p>

<p>=10*2^(2*(1+1))   (= 160)<br>
=10*2^(2*(1+1))+2  (= 162; ^ has greater precedence than +)<br>
=10*2^(2*(1+1))%  (=10.28114; % has greater precedence than ^)<br>
=2+(10*2^(2*(1+1)+SUM(A2)))*3  (who knows, but you'll push and pop here multiple times)</p>

<p>Here are the precedences of Excel's formula operators:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://support.microsoft.com/kb/25189" rel="nofollow">http://support.microsoft.com/kb/25189</a></p>

<p>Good luck.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2007.09.19 11:59 AM</p>

<a id="c89171396"></a>
<p>Creating foormula for the Ms Execl.</p>
<p class="posted">kamal | 2007.11.07 07:23 PM</p>

<a id="c97502570"></a>
<p>Actually, it is possible to write an unambiguous LALR-1 grammar for the Excel formula language. I know, I wrote the formula engine for Hypernumbers,* which is 100% Excel-compatible. There are things that can't be completely resolved at parse-time (e.g. whether a range constructed with INDIRECT() is valid), which you have to do at runtime, but the amount of code required to deal with such cases is surprisingly small.</p>

<p>* <a href="https://web.archive.org/web/20191002095802/http://hypernumbers.com/" rel="nofollow">http://hypernumbers.com</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://12monkeys.co.uk" href="https://web.archive.org/web/20191002095802/http://12monkeys.co.uk/">hv</a> | 2008.01.17 06:30 AM</p>

<a id="c97551188"></a>
<p>hv, thanks for the note and link.  I never meant to suggest that production of an unambiguous grammer was impossible, only that it wasn't possible for us, due to our requirements and resource limitations.  Good luck with hypernumbers, looks interesting - I've signed up for a beta notification.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.01.17 01:06 PM</p>

<a id="c113053500"></a>
<p>Hi, I am working on a library in C++, which will be used to create excel based reports. Initially a report template will be created in excel and saved as xml. Then the programmer will simply fill the data into respective rows/columns in the program. This library will allow the programmer to load the xml template and manipulate the related objects (elements), which includes adding sheets, defining styles, adding/deleting columns, rows and cells etc. Then the output is again saved to a xml file, which can be again opened in excel.</p>

<p>I am almost done with the other things. Now important thing I need to do is normalize the formule i.e. when a row/column is deleted or insrted affected formule should be changed as they are done in excel application.</p>

<p>I was wondering if there is any c++ class, which could read the formula and allow the changes, and then reconstruct the formula string.</p>

<p>Thanks &amp; Regards,</p>

<p>Joga</p>
<p class="posted">Joga | 2008.05.02 03:43 AM</p>

<a id="c113079524"></a>
<p>Hi Joga,</p>

<p>Sounds like an interesting project.  You might want to check out the GNOME Office / Gnumeric open source C++ project (uses a GNU general public license).  I suspect there's some code there that might prove helpful.</p>

<p><a href="https://web.archive.org/web/20191002095802/https://www.gnome.org/projects/gnumeric/index.shtml" rel="nofollow">http://www.gnome.org/projects/gnumeric/index.shtml</a></p>

<p>Good luck!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.05.02 08:36 AM</p>

<a id="c113714008"></a>
<p>I want to find the name of the cell that has the greatest number. for example there is lots of numbers, I can find Max easily, but how can I put the name of the Max cell by logical formula in excel. </p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://shakurd.hi5.com/" href="https://web.archive.org/web/20191002095802/http://shakurd.hi5.com/">shallaw</a> | 2008.05.07 11:54 AM</p>

<a id="c113717920"></a>
<p>Forgive me, shallaw, but I'm not sure if your question is related to the parsing of Excel formulas (the topic of this post), or if you are simply looking for a formula to produce the result you describe.  Can you be more explicit?</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.05.07 12:25 PM</p>

<a id="c114668268"></a>
<p>Hi,<br>
I am in the process of writing an Excel formula parser myself in VBA and your code was and is invaulable help.<br>
Thank you for this great starting point!<br>
Having paid the honors, there are a few issues that I don't get in your code and explanations:<br>
1. You call the comma a union operator. While this is true in some functions, e.g. SUM, it is not true in others, e.g. IF. THat is probably the reason Excel call the comma a 'list separator'.<br>
While It is legal to enter a formula such as "=(A1,A2)" you get a #VALUE! error upon entering the formula in a cell. Can you point me to a sensible usage of the comma in a subexpression?<br>
2. You write that "Excel still allows functions to be preceded with an '@'". While this is true as well, my version (2003) then converts the result of the function into a hyperlink to a mail address and deletes the '@'. In version 97 the '@' is simply deleted which also happens in 2003 if you change the Autocorrect options. <br>
So at least in these two versions you will never see a formula in a cell where a function starts with a '@'. <br>
This also applies to user defined functions written in VBA which names must not contain a '@'.<br>
What am I missing here?<br>
3. In your code you comment that brackets ("[]") have "no embeds (changed to "()" by Excel)". <br>
I know of two ways to use brackets in Excel. To my knowledge in R1C1 notation you can't have embedded brackets. Excel also uses brackets to enclose a file name . In Windows XP brackets are not allowed in file names.<br>
So how can there be embedded brackets in the first place?<br>
4. In the code itself you tackle the problem of nested functions and subexpressions by using the 'tokenstack'. AFAIK there are no nested array nor are there arrays nested in functions ur subexpressions or vice versa. Still you are using the tokenstack for array as well.<br>
Again, I have the feeling I am missing something.<br>
5. Finally I am not sure what exactly you want to achieve with your parser. Clearly one aim is to make a long formula easier to read. This is wonderfully done by ignoring noops, blanks or the various 'matchfixes' in the output.<br>
In no instance save one you are trying to evaluate the formula (next to impossible without info on the cells referenced ;-). <br>
But when you have embedded double quotes in a string, i.e. '="abc""def"', you delete one of them, thus evaluating the formula. The output then (and only then) resembles what you see in the cell as opposed to what you see in the formula bar. What is the reason behind this decision?</p>

<p>Thank you again for sharing all the work that went into this great tool.</p>

<p>Daniel</p>
<p class="posted">Daniel | 2008.05.14 05:16 PM</p>

<a id="c114691200"></a>
<p>Hi Daniel,</p>

<p>Glad the code was of some help to you.  I'm afraid the code and this topic have gotten little attention from me in the more than three years since they were written, so I'm not sure how much help I can be.</p>

<p>1.  I'm not sure I understand what kind of example you are looking for here; the example you provide is pointless, of course, because it attempts to return a multi-cell range from a formula that must return a single scalar value (hence the #VALUE).  Unions made with commas (and multi-cell returning intersections made with spaces) only make sense when passed as parameters to functions expecting (and supporting) multi-area ranges, like SUM, MAX, COUNT, ROWS, etc.  You'll have to clarify what you mean by "Can you point me to a sensible usage of the comma in a subexpression?"</p>

<p>And, just to be clear, I'm not the only one who calls the comma an Excel union operator, that's what Microsoft calls it too:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://support.microsoft.com/kb/25189" rel="nofollow">http://support.microsoft.com/kb/25189</a>  </p>

<p>2.  I'm not sure you're missing anything here, except that I had no reason to limit the code's support to post-Excel 97 formulas, which may or may not persist leading @'s.</p>

<p>3.  You left out the line just above that comment, which reads: "bracked strings (range offset or linked workbook name)".  The code that follows this comment is a stateful check for a closing bracket found when it's been determined we're within a range address, which means that we're terminating an offset in R1C1 notation or a linked workbook file name.  "No embeds" in this case means that we don't have to worry about there being brackets embedded between brackets, certainly not for offsets, but also not for linked workbook names, because if the workbook name/path included a bracket then Excel would have already replaced it with a parenthesis.</p>

<p>4.  As I mentioned in the post above, the code choose to represent arrays using a function-like syntax, so when it finds the beginning of an array (or an array row) it pushes a function on the stack and utilizes the same function parameter parsing logic for the array parameters.  Even though the elements of a literal array are more limited then the parameters of a function (i.e., constant scalar values only), there was no point in writing entirely separate parsing logic just for this.</p>

<p>5.  What I want to achieve with my parser?  Well, I've already achieved it, years ago actually.  I used parsing logic similar to this, though a bit more advanced, to pull apart formulas within workbooks in order to build range cross-reference tracing and other debugging aids, to build complex formula visualization and normalization tools, workbook calculation differencing tools, and a number of other things.  Evaluation of formulas outside of Excel was just a small part of what we were aiming for; what we mostly wanted was to share the logic with others (like you) in order to see what types of things they might come up with.  Here are some links to other folks who have utilized this logic (one of which is a VBA-based version for formula visualization in Excel):</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html" rel="nofollow">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a></p>

<p>Regarding your specific question about doubled-up double quotes in string tokens, I don't consider that evaluation, that's simply normalization of the token's value.</p>

<p>Hope that answers some of your questions.  Good luck!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.05.14 08:32 PM</p>

<a id="c114733406"></a>
<p>Hi,<br>
Thank you for your quick reply. <br>
Just a few comments:<br>
1. Glad we agree on no sensible use of commas outside a function. It was just that you seemed to implicate this possibility that made me ask about it.<br>
And, yes, you are right, even in my native German MS calls the comma a union operator. Only VBA calls it a list separator which, to me, makes more sense given the ambiguity of its use.<br>
2. I guess your eliminating of leading '@'s would probably fall under 'normalization' (which is not my aim) so I will just leave formula names as they are. I was only curious on this point.<br>
3. This is the only issue still open for me: You state that "... if the workbook name/path included a bracket then Excel would have already replaced it with a parenthesis". <br>
I tried all Excel versions both English and German from 97 to 03 on a Win XP system with R1C1 and A1 notation. The result is always the same: Despite from Excel doing its best to prevent you from getting there it is possible to have a reference like 'C:\Bra[cke]ts\[Filename.xls]'!R1C[1] in a cell.<br>
Opposed to your statement above the brackets are not replaced by paranthesis on my system. They aren't embedded either, of course, but then embedding would only be possible for brackets in a filename. That, though, is illegal under Windows XP.<br>
As I want to show the formula 'as is' (not normalize it), I would be very interested in a hint on possible occurences of embedded brackets (OS?, language?, previous Excel versions?).<br>
4. Got it, thanks. I overlooked the array rows.<br>
5. I guess the handling of embedded double quotes is just a question of style here. That's why I was asking about your aim - not because I wanted to question your expertise or the state of this project. Sorry if I gave a wrong impresiion here, I should have written 'wantED to achieve'.</p>

<p>Again thanks for your invaluable help and sorry for my bad knowledge of English and Java . I am just a simple German VBA guy.</p>

<p>Daniel</p>
<p class="posted">Daniel | 2008.05.15 03:22 AM</p>

<a id="c114763650"></a>
<p>No need to apologize, Daniel, I think your English is very good.  Certainly better than my German! :)</p>

<p>Regarding #3, I can only suggest that there is perhaps a difference in the versions of Windows/Excel we're using.  I just tested this again and found that if I reference a workbook having brackets in its file name in a formula in another workbook, the end result is that the referenced file name is surrounded by brackets (as always happens with "long" file names) and the brackets in the file name are replaced with parentheses.  So, for instance, given a workbook with the name "test [file].xls", when it is referenced in the formula of another workbook, the formula reads:</p>

<p> ='[test (file).xls]Sheet1'!$B$4</p>

<p>So, as the JavaScript comment says, there's no worry about brackets being embedded in brackets.</p>

<p>Hope that helps.  Good luck with your project!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.05.15 08:41 AM</p>

<a id="c114838436"></a>
<p>Can you please tell me what combination of Windows and Excel (and language settings) produced that result?</p>

<p>Vista (english, US) and XL 07 (English, US), I assume.</p>

<p>Btw I am not the first to experience this on a pre-Vista system (See <a href="https://web.archive.org/web/20191002095802/http://help.lockergnome.com/office/Legal-filename-character-inconsistency-ftopict947822.html)" rel="nofollow">http://help.lockergnome.com/office/Legal-filename-character-inconsistency-ftopict947822.html)</a></p>

<p>TIA</p>

<p>Daniel</p>
<p class="posted">Daniel | 2008.05.15 04:55 PM</p>

<a id="c114926806"></a>
<p>Hi Daniel,</p>

<p>This is English Windows XP SP2 and Office 2003 SP3.  Thanks so much for that link.  I'm so surprised to see that, as I've never heard of (nor experienced) this problem.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.05.16 10:36 AM</p>

<a id="c121022922"></a>
<p>Bug! this formula:</p>

<p>=SUM('Sheet-1'!A1:'Sheet-1'!A10)</p>

<p>the parse result of range is wrong</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.parkesoft.com" href="https://web.archive.org/web/20191002095802/http://www.parkesoft.com/">Bosee</a> | 2008.07.03 07:37 AM</p>

<a id="c121024222"></a>
<p>Hi Bosee,</p>

<p>Thanks much for sharing that.  I can't put together a scenario in Excel in which this is valid.  Can you please explain the steps necessary to set this up?  Once I repro it we can get it fixed.  Thanks!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.07.03 07:47 AM</p>

<a id="c121253822"></a>
<p>Hi~<br>
A product of my company base on Excel, the data of this product very complex, especially it's formula. one day i found a formula writter wrote this formula, it can make the formula parser of the product failed.<br>
I type following formula to the Excel cell one by one, they can work correctly (suppose all formula in 'Sheet-1', the space between two address Excel never remove it).</p>

<p>=SUM('Sheet-1'!A1:'Sheet-1'!A10)<br>
=SUM('Sheet-1'!A1    :    'Sheet-1'!A10)<br>
=SUM('C:\[Book1.xls]Sheet-1'!A1   :    'C:\[Book1.xls]Sheet-1'!A10)<br>
=SUM(A1:'Sheet-1'!A10)</p>

<p>the result as same as this:<br>
=SUM('Sheet-1'A1:A10)</p>

<p>Bosee</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.parkesoft.com" href="https://web.archive.org/web/20191002095802/http://www.parkesoft.com/">Bosee</a> | 2008.07.05 01:16 PM</p>

<a id="c128103422"></a>
<p>is your code available for download ?</p>
<p class="posted">rash | 2008.08.28 01:01 AM</p>

<a id="c128137978"></a>
<p>Yep.  For the JavaScript version, just right-click and View Source on this page and look for the "GoCalc Prototype Excel Formula Parser - free for the taking" comment.  For the C# and other language versions, follow the links here:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html" rel="nofollow">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.08.28 08:32 AM</p>

<a id="c128138112"></a>
<p>Bosee, just noticed your comment, sorry.  I'll try to take a closer look in the next couple of weeks.  Thanks!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2008.08.28 08:33 AM</p>

<a id="c131513298"></a>
<p>i need ur help for my some problem. can i get An particular Amt ,which i fill in cell A1, "X" time in Row B which i fill in cell A2. suppose i fill 1000 in cell A1 an 10 an A2 the result should be 1000 in cell B1 to B10.<br>
i would realy obliged from your quick reply</p>
<p class="posted">neeraj Pathak | 2008.09.20 01:45 AM</p>

<a id="c6a00d8341c7bd453ef010536cb6290970c"></a>
<p>Thanks for the information, after searching for week, I found this article.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.bali-styles.com/busbyseotest/" href="https://web.archive.org/web/20191002095802/http://www.bali-styles.com/busbyseotest/">Myea Amelia</a> | 2009.01.12 07:39 PM</p>

<a id="c6a00d8341c7bd453ef0120a546d57a970b"></a>
<p>Thank you!  I had been struggling with this problem, and you save me many hours by posting this.</p>
<p class="posted">Steve C. | 2009.09.03 08:28 PM</p>

<a id="c6a00d8341c7bd453ef0120a7e25d46970b"></a>
<p>Many thanks - fantastic work - just what I was lookg for - pure genius!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.dacsoft.co.uk" href="https://web.archive.org/web/20191002095802/http://www.dacsoft.co.uk/">Ian Daniels</a> | 2010.01.17 02:53 AM</p>

<a id="c6a00d8341c7bd453ef012877337671970c"></a>
<p>Thanks you!  you give me big help for my work. Great work!</p>
<p class="posted">daboai | 2010.01.30 01:56 AM</p>

<a id="c6a00d8341c7bd453ef0148c753cb7a970c"></a>
<p>This is fantastic.  Is there an implementation out there that converts an Excel formula to a Javascript function (with plenty of caveats, of course!)?</p>
<p class="posted">JN | 2011.01.05 05:49 AM</p>

<a id="c6a00d8341c7bd453ef0148c7548d84970c"></a>
<p>JN, not that I've seen; however, you might want to check out ExcelEverywhere, which does a complete conversion of a sheet to an HTML/Javascript-only page.</p>

<p><a href="https://web.archive.org/web/20191002095802/http://www.exceleverywhere.com/" rel="nofollow">http://www.exceleverywhere.com/</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2011.01.05 08:05 AM</p>

<a id="c6a00d8341c7bd453ef014e86152d45970d"></a>
<p>Saving this on recursive descent parsers and Excel formulas in C# to come back to some time in the future:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://tinyurl.com/4axllp7" rel="nofollow">http://tinyurl.com/4axllp7</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops">ewbi.develops</a> | 2011.02.14 10:11 PM</p>

<a id="c6a00d8341c7bd453ef014e6047cad2970c"></a>
<p>The c++ port of your ExcelFormulaParser<br>
<a href="https://web.archive.org/web/20191002095802/https://github.com/lishen2/Excel_formula_parser_cpp" rel="nofollow">https://github.com/lishen2/Excel_formula_parser_cpp</a><br>
</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://www.grati.org" href="https://web.archive.org/web/20191002095802/http://www.grati.org/">lishen</a> | 2011.03.31 02:21 AM</p>

<a id="c6a00d8341c7bd453ef014e8724e271970d"></a>
<p>Excellent, lishen!  That's fantastic.  Folks still find this post and the related C# code and occasionally send me notes about how it has helped them out.  This is a great addition.  I'll update the sidebar page with a link, too:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html" rel="nofollow">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a></p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2011.03.31 10:39 AM</p>

<a id="c6a00d8341c7bd453ef015432282fc8970c"></a>
<p>Hello,</p>

<p>At times I have to debug an Excel spreadsheet that has been written by others.  THE most difficult task I encounter is tracking down embedded constants (e.g., A1/360).</p>

<p>I suspect the Java Script in your article "Excel Formula Parsing" could do this. Is there any way to use this script from within an Excel VBA macro to analyze each formula in a spreadsheet, and just identify all the constants?</p>

<p>Your help and time is greatly appreciated.</p>

<p>Robert Neary  </p>

<p>P.S.<br>
Although I am familiar with Excel and Excel Procedures, the level of programming exhibited in your JavaScript is way beyond my capabilities.  So, patience and detail is respectfully requested.</p>

<p>R.</p>
<p class="posted">Robert Neary | 2011.05.06 05:15 PM</p>

<a id="c6a00d8341c7bd453ef014e884c4c1a970d"></a>
<p>Hi Robert,</p>

<p>It can indeed be used for just what you've described.  In fact, I've done so for a very similar reason - to validate the relationships between range references in formulas.  However, I didn't translate the logic to VBA for use within Excel, but instead reworked it into C# for use in a stand-alone .NET utility able to work from outside of Excel.</p>

<p>Some folks have translated the logic to VBA for use in an Excel formula analyzer add-in:</p>

<p><a href="https://web.archive.org/web/20191002095802/http://www.dailydoseofexcel.com/archives/2005/04/01/excel-formula-formatter/" rel="nofollow">http://www.dailydoseofexcel.com/archives/2005/04/01/excel-formula-formatter/</a></p>

<p>Be sure to read through the comments for a link to the latest version.  They might be willing to share it with you for use in your utility.</p>

<p>Links to that site and the various other versions of this logic are available here:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html" rel="nofollow">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a></p>

<p>In terms of how to wield this logic to accomplish your task, that's a little more complicated to explain.  In short I'll just say it involves passing over each of the cells in the used range of a sheet (or sheets), checking to see if they have a formula, and if they do passing the formula through the parser logic and then enumerating over the token results to identify and report any constants.  Of course, there are tricky bits and gotchas along the way, but nothing too hard to overcome.</p>

<p>Please feel free to email at the address above in the left sidebar if you'd like to discuss further.</p>

<p>Good luck!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2011.05.07 02:58 PM</p>

<a id="c6a00d8341c7bd453ef015432fe270b970c"></a>
<p>Hi,</p>

<p>i port the excelformulaparser to Delphi XE.<br>
Here is the download link:<br>
<a href="https://web.archive.org/web/20191002095802/http://www.hadv.de/de/2011/ExcelFormulaParser.zip" rel="nofollow">http://www.hadv.de/de/2011/ExcelFormulaParser.zip</a></p>

<p>Hartmut</p>
<p class="posted">Hartmut David | 2011.06.13 02:25 PM</p>

<a id="c6a00d8341c7bd453ef01538f31dda2970b"></a>
<p>Hey, that's fantastic!  </p>

<p>I'm not a Delphi guy so I won't bother looking at the code, but I've added a link to the aggregation page here:</p>

<p><a href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/popular/excelformulaparsing.html" rel="nofollow">http://ewbi.blogs.com/develops/popular/excelformulaparsing.html</a></p>

<p>Thanks so much!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2011.06.14 04:54 PM</p>

<a id="c6a00d8341c7bd453ef0153922bd4d1970b"></a>
<p>I have excel formulas I would like to convert to PHP language.  If I could just enter the formula into a function and get a PHP script out that would be great.  Does anyone know if there is a tool to covert excel formulas to PHP. This is an example:<br>
=IF(AND((AND(BA115&gt;70,BA115&gt;BC115)),BY115&gt;1,AND((ABS(AN115)&gt;ABS(AO115)),AO115&gt;0)),<br>
GF115,IF(OR(BA115&gt;70,BY115&gt;1,AND((ABS(AN115)&gt;ABS(AO115)),AO115&gt;0)),GD115,IF(AND(<br>
BA115&gt;30,BA115BC115,OR(CB115&gt;1,<br>
AND((ABS(AN115)&gt;ABS(AO115)),AO115&gt;0))),<br>
GD115,IF(AND(BA115&gt;30,BA115BC115),GL115,GD115))))<br>
</p>
<p class="posted">dan lippetti | 2011.10.08 10:18 PM</p>

<a id="c6a00d8341c7bd453ef0153924a4a81970b"></a>
<p>We have developed a Tool for Parsing Formulas in Excel in VBA.<br>
There are 2 versions we have created for each addins: a version for Excel 2003 and an other for Excel 2007.<br>
The heart of both is the function that uses a regular expression pattern to parse the formula.</p>

<p>The function searches all the results and performs a check on each of the submatches (groups). By taking the array of the matched results the function reconstructs the formula by adding carriage return to separate the elements.<br>
An other outer function formats the text by adding tabs.</p>

<p>this is the function of persing:</p>

<p>Function Parser_Formula( _<br>
    ByVal sFormula As String, _<br>
    Optional sListSeparator As String = ",", _<br>
    Optional sRowSeparator As String = "\") As String</p>

<p>Dim M As Object, RE As Object, SM As Object, SB As Object<br>
Dim v As Variant, t As String<br>
Set RE = CreateObject("vbscript.regexp")<br>
RE.ignorecase = True<br>
RE.Global = True</p>

<p>v = Array( _<br>
    "(""[^""]*""|'[^']*')", _<br>
    "(\{[^}]+})", _<br>
    "(\" &amp; sListSeparator &amp; ")", _<br>
    "(" &amp; cw &amp; "+(?:\." &amp; cw &amp; "+)*\()", _<br>
    "(\))", _<br>
    "(^=|\()", _<br>
    "(.)")</p>

<p>RE.Pattern = Join(v, "|")<br>
If RE.test(sFormula) Then<br>
    Set M = RE.Execute(sFormula)<br>
    sFormula = ""<br>
    For Each SM In M<br>
        Set SB = SM.SubMatches<br>
        If Len(SB(0) &amp; SB(6)) Then<br>
            t = SB(0) &amp; SB(6)<br>
        ElseIf Len(SB(1)) Then<br>
            t = Array_Const_Wrap(SB(1), sRowSeparator) &amp; vbCr<br>
        ElseIf Len(SB(2) &amp; SB(5)) Then<br>
            t = SB(2) &amp; SB(5) &amp; vbCr<br>
        ElseIf Len(SB(3)) Then<br>
            t = vbCr &amp; SB(3) &amp; vbCr<br>
        ElseIf Len(SB(4)) Then<br>
            t = vbCr &amp; SB(4)<br>
        End If<br>
        sFormula = sFormula &amp; t<br>
    Next<br>
End If</p>

<p>RE.Pattern = "\r{2,}"<br>
sFormula = RE.Replace(sFormula, vbCr)</p>

<p>Parser_Formula = sFormula<br>
End Function</p>

<p>Function Array_Const_Wrap( _<br>
    ByRef sArraY As String, _<br>
    Optional sRowSeparator As String = "\") As String<br>
Dim v<br>
If Len(sArraY) &gt; 1 Then<br>
    v = Split(Mid(sArraY, 2, Len(sArraY) - 2), sRowSeparator)<br>
    Array_Const_Wrap = "{" &amp; vbCr &amp; Join(v, sRowSeparator &amp; vbCr) &amp; vbCr &amp; "}"<br>
End If<br>
End Function</p>

<p><br>
best regards<br>
r<br>
</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://sites.google.com/site/e90e50/random-topics/tool-for-parsing-formulas-in-excel" href="https://web.archive.org/web/20191002095802/https://sites.google.com/site/e90e50/random-topics/tool-for-parsing-formulas-in-excel">r</a> | 2011.10.14 01:38 AM</p>

<a id="c6a00d8341c7bd453ef0153924bd77b970b"></a>
<p>Wow, r, thanks for sharing that.  I'm sure some folks will find that helpful.</p>

<p>Dan, I hope someone's able to help you out.  I've spent very little time putting parsed formulas back together again to target other languages.  Seems fairly straightforward, but time just never permits.  Good luck!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2011.10.14 08:14 AM</p>

<a id="c6a00d8341c7bd453ef016767e8a235970b"></a>
<p>Eric,</p>

<p>Roberto Mensa and his colleague Krisztina have created another VBA parser using RegExp <a href="https://web.archive.org/web/20191002095802/https://sites.google.com/site/e90e50/random-topics/tool-for-parsing-formulas-in-excel." rel="nofollow">https://sites.google.com/site/e90e50/random-topics/tool-for-parsing-formulas-in-excel.</a> I haven't played with it mch, but it looks good so far.</p>

<p>As Excel 64bit does not suppport the treeview control, hey supply treeview and textbox versions.</p>
<p class="posted">Bob Phillips | 2012.06.27 05:07 AM</p>

<a id="c6a00d8341c7bd453ef017742c4db41970d"></a>
<p>Thanks for the link, Bob.  That's good stuff.  Can't wait to check it out.</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops">ewbi.develops</a> | 2012.06.27 08:24 AM</p>

<a id="c6a00d8341c7bd453ef017ee9056f38970d"></a>
<p>Not sure if you can help, this is all a little foreign to me but I'm giving it a shot (I understand very little of programing but I can recognize the language and have seen it when doing some basic html work before, etc.).</p>

<p>I'm trying to find an easy was to convert excel to javascipt to use as javascript in a PDF form.  I see your note about right clicking to get the javascript for my converted formula (which I can do successfully).  I even was able to enter it correctly into my form.  My confusion is, the formula references other cells in the worksheet, what do I do to the other cells to get them to communicate with this formula?  Some of the other cells are/will be for the user to type into and the info they enter needs to feed the formulas (some of it actually feeds multiple different formulas, but if I can just get the first figured out, I imagine the rest will be easy).  </p>

<p>Help! Thanks!</p>
<p class="posted">Beth | 2013.03.07 05:40 AM</p>

<a id="c6a00d8341c7bd453ef017c376558ba970b"></a>
<p>Hi Beth,</p>

<p>Pretty cool that you got the JavaScript parser working behind a PDF.  I've never done PDF-based scripting, but I'm sure it was challenging.  However, based on your explanation, it sounds like parsing Excel formulas into tokens is only a small part of what you want to do.  </p>

<p>If I understand correctly, you would also like to use JavaScript to put the tokens back together (statically or interpretively) for execution in order to represent some Excel-based spreadsheet logic involving multiple cells containing constants and formulas, all within a PDF.  In other words, you want to convert a spreadsheet, or some portion of one, to JavaScript and then run this within a PDF.</p>

<p>I suppose this is possible.  As described in a number of comments above and in some other posts on this blog, there are a number of third party tools and services that do this.  But I'm not sure any of them will do so in a way that would support hosting and executing the results in the JavaScript sandbox found in a PDF.  </p>

<p>Of course, you could code it up yourself, but having done this myself I can assure you it's not a trivial exercise, depending on the complexity of the spreadsheet logic you need to convert, how dynamic/static the result needs to be, etc.</p>

<p>Perhaps if you explain a bit more about why you want to host/execute some spreadsheet logic inside a PDF, and also describe the complexity of the spreadsheet logic you wish to replicate, I might be able to point you in the right direction.</p>

<p>Good luck!</p>
<p class="posted"><a rel="nofollow" target="_blank" title="http://ewbi.blogs.com/develops/" href="https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/">ewbi.develops</a> | 2013.03.07 12:41 PM</p>









</div>
</div>

<div style="clear: both;"></div>

</div>

<script type="text/javascript">
<!--
var extra_happy = Math.floor(1000000000 * Math.random());
document.write('<img src="https://web.archive.org/web/20191002095802/https://www.typepad.com/t/stats?blog_id=7918&amp;user_id=5343&amp;page=' + escape(location.href) + '&amp;referrer=' + escape(document.referrer) + '&amp;i=' + extra_happy + '" width="1" height="1" alt="" style="position: absolute; top: 0; left: 0;" />');
// -->
</script><img src="./ewbi.develops_ Excel Formula Parsing_files/stats" width="1" height="1" alt="" style="position: absolute; top: 0; left: 0;" s0p0rs4xf="">


<!-- tp ga -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//web.archive.org/web/20191002095802/https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-225723-36', 'auto');
ga('send', 'pageview');
</script>
<!-- end tp ga -->




<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/recaptcha_ajax.js"></script>
<script type="text/javascript">
var captchaImgAttempts = 0;
var allowAnonComments = '0';
var registrationRequired = 0;
var registrationOptional = 0;
var emailRequired = 0;
var useAvatars = 0;

var showSignInMessaging = 0;
var jsonURL = "/.services/json-rpc";

var captchaSrc = "/.services/captcha?code_encrypted=";
var alertCommentCannotBeBlank = "You can not leave an empty comment. Please enter some text in the Comment field.";
var alertEditingExpired = "Sorry, you're no longer allowed to edit this comment. You may have taken too much time before submitting your edit or someone may have already replied to it.";

var alertAuthorCannotBeBlank = "Name must not be blank.";
var alertEmailCannotBeBlank = "Email Address must not be blank.";
var alertAuthorAndEmailCannotBeBlank = "Name and email address are both required!";
var alertEmailIsInvalid = "The Email Address you entered is invalid. Please enter a valid email address.";
var alertUnauthorizedAction = "The comments on this post are closed.";
var msgPostReplyTo = "Reply to ";  
var msgInReplyTo = "In reply to ";
var msgPostAComment = "Post a comment ";
var atpCommentsPath = "/.shared/js/atpcomments_yui.js?v=5";
var hasChanged = 0;
var hostName = ".blogs.com/develops/";
var tp_comment_token = "1570010284-5c1cbc078f22db46c474f5aefaa3bc06a4cfcdf7:TuItdQ6E5c5CJPtj";

var use_recaptcha = 1;
var recaptcha_publickey = "6Ldg1s4SAAAAAEvvZX2ILFkWp7KB-jjdL4v0JV2e";
var isPage = 0;
var blog_xid = "6a00d8341c7bd453ef00d8341c7bda53ef";
var xid = "";
var injectCode = '<div id=\"comment-preview\" class=\"hiddenBox\">\n\t<h3 id=\"header-verify-comment\" class=\"comments-header font-entryheader  hiddenBox\">Verify your Comment<\/h3>\n    <h3 id=\"header-preview-comment\" class=\"comments-header font-entryheader  hiddenBox\">Previewing your Comment<\/h3>\n\t<div class=\"comments-content font-entrybody\">\n\t\t<div class=\"comment\">\n\t\t\t<div id=\"comment-preview-content\" class=\"comment-content\">\n\t\t\t<\/div>\n\t\t\t<p class=\"comment-footer\">\n\t\t\t\tPosted by: \n\t\t\t\t<span id=\"comment-preview-author\"><\/span>&nbsp;|&nbsp;<span id=\"comment-preview-datetime\"><\/span>\n\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n<\/div>\n<div id=\"comment-preview-confirmation\" class=\"font-entrybody hiddenBox yellowBox\">\n    <p>This is only a preview. Your comment has not yet been posted.<\/p>\n        <form id=\"comment-preview-form\"\n                method=\"post\"\n                onsubmit=\"atpComments.interceptPost(1); return false;\">\n                <input type=\"submit\" class=\"form-control font-entrybody\" name=\"post\" id=\"comment-confirm-post\" value=\"&nbsp;Post&nbsp;\" onclick=\"atpComments.interceptPost(1); return false;\"/>\n                <input type=\"submit\" class=\"form-control font-entrybody\"  name=\"edit\" id=\"comment-edit\" value=\"&nbsp;&nbsp;Edit&nbsp;&nbsp;\" onclick=\"atpComments.previewOnly(2); return false;\"/>\n        <span id=\"previewFormSpinner\" class=\"hiddenBox\"><img src=\"/.shared/images/spinner.gif\" alt=\"Working...\" /><\/span>\n        <\/form>\n<\/div>\n\n<div id=\"comment-error\" class=\"hiddenBox font-entrybody redBox\">\t    \n   Your comment could not be posted. Error type: <span id=\"comment-error-msg\"><\/span> \n<\/div>\t\n<div id=\"comment-complete\" class=\"hiddenBox font-entrybody  yellowGreenBox\">\n    Your comment has been posted. <a href=\"javascript:void 0;\" onclick=\"window.location.hash=\'#comment-form\';window.location.reload(false)\">Post another comment<\/a>\n<\/div>\t\n<div id=\"comment-captcha\" class=\"hiddenBox yellowBox font-entrybody\">\t\n    <div id=\"captchaText\">\n\t    <p id=\"captchaFailMsg\" class=\"captchaErrorText hiddenBox\">The letters and numbers you entered did not match the image. Please try again.<\/p>\t    \t        \n\t    <p>As a final step before posting your comment, enter the letters and numbers you see in the image below. This prevents automated programs from posting comments.<\/p>\n\t    <p><span id=\"comment-captcha-viewalt\">Having trouble reading this image? <a href=\"#comment-captcha\" onClick=\"atpComments.generateReCaptcha();\">View an alternate.<\/a><\/span><\/p>\n    <\/div>\n    <form id=\"comment-captcha-form\" \n\t\t  method=\"post\"\n\t\t  onsubmit=\"atpComments.submitWithReCaptcha(); return false;\">\n    <div id=\"recaptcha_content\">\n      <noscript>\n        <iframe src=\"6Ldg1s4SAAAAAEvvZX2ILFkWp7KB-jjdL4v0JV2e\" height=\"300\" width=\"500\" frameborder=\"0\"><\/iframe><br />\n        <textarea name=\"recaptcha_challenge_field\" rows=\"3\" cols=\"40\"><\/textarea>\n        <input type=\'hidden\' name=\'recaptcha_response_field\' value=\'manual_challenge\' />\n      <\/noscript>\n    <\/div>\n  <script type=\"text/javascript\">\n    $(document).ready(function() {\n        Recaptcha.create(\"6Ldg1s4SAAAAAEvvZX2ILFkWp7KB-jjdL4v0JV2e\",\n                         \"recaptcha_content\", {\n                             theme: \"red\",\n                             callback: Recaptcha.focus_response_field\n        });\n    });\n  <\/script>\n        <p>\n            <input type=\"submit\" name=\"continue\" id=\"captcha-continue\" value=\"&nbsp;Continue&nbsp;\" />\n            <span id=\"captchaFormSpinner\" class=\"commentSpinner hiddenBox\"><img src=\"/.shared/images/spinner.gif\" alt=\"Working...\" /><\/span>\n        <\/p>\n    <\/form>\n<\/div>\n'; 
var entryPermalink = "https://web.archive.org/web/20191002095802/https://ewbi.blogs.com/develops/2004/12/excel_formula_p.html";
var inlineReply = document.createElement("div");
var commentFooterLinks;
var commentHeader;
var commentReplyXID;
var commentReplyAuthor;
var commentReplyComplete;
var inlineReplyLoaded = 0;
var commentFormNum = undefined; /* Deprecated but still exists in advanced template sets, so must be defined */

function xidToCommentPermalink (entryUrl, xid) {
    return entryUrl + "?cid=" + xid + "#comment-" + xid;
}


/* Deprecated advanced template functions */
function handleSubmit() { return true; };
function handleChange() { return true; };
</script>
<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/yuiloader.js"></script>
<script type="text/javascript" src="./ewbi.develops_ Excel Formula Parsing_files/atpcomments.js"></script>

<!-- Begin disqus Tag -->

<!-- End disqus Tag -->




<div id="loom-companion-mv3" ext-id="liecbddmkiiihnedobmlmillhodjkdmb"><section id="shadow-host-companion"><template shadowrootmode="open"><div id="inner-shadow-companion"><div class="css-0" id="tooltip-mount-layer-companion"></div><style data-emotion="companion-global"></style><style data-emotion="companion" data-s=""></style><style>
            
    #inner-shadow-companion {
      font-size: 100%;
    }
    #inner-shadow-companion {
      font-family: circular, -apple-system, BlinkMacSystemFont, Segoe UI,
        sans-serif;
      color: var(--lns-color-body);
      
  font-size: var(--lns-fontSize-medium);
  line-height: var(--lns-lineHeight-medium);
;
      font-feature-settings: 'ss08' on;
    }

    #inner-shadow-companion *,
    #inner-shadow-companion *:before,
    #inner-shadow-companion *:after {
      box-sizing: border-box;
    }

    #inner-shadow-companion * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      letter-spacing: calc(0.6px - 0.05em);
    }

    
    #inner-shadow-companion,
    .theme-light,
    [data-lens-theme="light"] {
      --lns-color-primary: var(--lns-themeLight-color-primary);--lns-color-primaryHover: var(--lns-themeLight-color-primaryHover);--lns-color-primaryActive: var(--lns-themeLight-color-primaryActive);--lns-color-body: var(--lns-themeLight-color-body);--lns-color-bodyDimmed: var(--lns-themeLight-color-bodyDimmed);--lns-color-background: var(--lns-themeLight-color-background);--lns-color-backgroundHover: var(--lns-themeLight-color-backgroundHover);--lns-color-backgroundActive: var(--lns-themeLight-color-backgroundActive);--lns-color-backgroundSecondary: var(--lns-themeLight-color-backgroundSecondary);--lns-color-backgroundSecondary2: var(--lns-themeLight-color-backgroundSecondary2);--lns-color-overlay: var(--lns-themeLight-color-overlay);--lns-color-border: var(--lns-themeLight-color-border);--lns-color-focusRing: var(--lns-themeLight-color-focusRing);--lns-color-record: var(--lns-themeLight-color-record);--lns-color-recordHover: var(--lns-themeLight-color-recordHover);--lns-color-recordActive: var(--lns-themeLight-color-recordActive);--lns-color-info: var(--lns-themeLight-color-info);--lns-color-success: var(--lns-themeLight-color-success);--lns-color-warning: var(--lns-themeLight-color-warning);--lns-color-danger: var(--lns-themeLight-color-danger);--lns-color-dangerHover: var(--lns-themeLight-color-dangerHover);--lns-color-dangerActive: var(--lns-themeLight-color-dangerActive);--lns-color-backdrop: var(--lns-themeLight-color-backdrop);--lns-color-backdropDark: var(--lns-themeLight-color-backdropDark);--lns-color-backdropTwilight: var(--lns-themeLight-color-backdropTwilight);--lns-color-disabledContent: var(--lns-themeLight-color-disabledContent);--lns-color-highlight: var(--lns-themeLight-color-highlight);--lns-color-disabledBackground: var(--lns-themeLight-color-disabledBackground);--lns-color-formFieldBorder: var(--lns-themeLight-color-formFieldBorder);--lns-color-formFieldBackground: var(--lns-themeLight-color-formFieldBackground);--lns-color-buttonBorder: var(--lns-themeLight-color-buttonBorder);--lns-color-upgrade: var(--lns-themeLight-color-upgrade);--lns-color-upgradeHover: var(--lns-themeLight-color-upgradeHover);--lns-color-upgradeActive: var(--lns-themeLight-color-upgradeActive);--lns-color-tabBackground: var(--lns-themeLight-color-tabBackground);--lns-color-discoveryBackground: var(--lns-themeLight-color-discoveryBackground);--lns-color-discoveryLightBackground: var(--lns-themeLight-color-discoveryLightBackground);--lns-color-discoveryTitle: var(--lns-themeLight-color-discoveryTitle);--lns-color-discoveryHighlight: var(--lns-themeLight-color-discoveryHighlight);
    }

    .theme-dark,
    [data-lens-theme="dark"] {
      --lns-color-primary: var(--lns-themeDark-color-primary);--lns-color-primaryHover: var(--lns-themeDark-color-primaryHover);--lns-color-primaryActive: var(--lns-themeDark-color-primaryActive);--lns-color-body: var(--lns-themeDark-color-body);--lns-color-bodyDimmed: var(--lns-themeDark-color-bodyDimmed);--lns-color-background: var(--lns-themeDark-color-background);--lns-color-backgroundHover: var(--lns-themeDark-color-backgroundHover);--lns-color-backgroundActive: var(--lns-themeDark-color-backgroundActive);--lns-color-backgroundSecondary: var(--lns-themeDark-color-backgroundSecondary);--lns-color-backgroundSecondary2: var(--lns-themeDark-color-backgroundSecondary2);--lns-color-overlay: var(--lns-themeDark-color-overlay);--lns-color-border: var(--lns-themeDark-color-border);--lns-color-focusRing: var(--lns-themeDark-color-focusRing);--lns-color-record: var(--lns-themeDark-color-record);--lns-color-recordHover: var(--lns-themeDark-color-recordHover);--lns-color-recordActive: var(--lns-themeDark-color-recordActive);--lns-color-info: var(--lns-themeDark-color-info);--lns-color-success: var(--lns-themeDark-color-success);--lns-color-warning: var(--lns-themeDark-color-warning);--lns-color-danger: var(--lns-themeDark-color-danger);--lns-color-dangerHover: var(--lns-themeDark-color-dangerHover);--lns-color-dangerActive: var(--lns-themeDark-color-dangerActive);--lns-color-backdrop: var(--lns-themeDark-color-backdrop);--lns-color-backdropDark: var(--lns-themeDark-color-backdropDark);--lns-color-backdropTwilight: var(--lns-themeDark-color-backdropTwilight);--lns-color-disabledContent: var(--lns-themeDark-color-disabledContent);--lns-color-highlight: var(--lns-themeDark-color-highlight);--lns-color-disabledBackground: var(--lns-themeDark-color-disabledBackground);--lns-color-formFieldBorder: var(--lns-themeDark-color-formFieldBorder);--lns-color-formFieldBackground: var(--lns-themeDark-color-formFieldBackground);--lns-color-buttonBorder: var(--lns-themeDark-color-buttonBorder);--lns-color-upgrade: var(--lns-themeDark-color-upgrade);--lns-color-upgradeHover: var(--lns-themeDark-color-upgradeHover);--lns-color-upgradeActive: var(--lns-themeDark-color-upgradeActive);--lns-color-tabBackground: var(--lns-themeDark-color-tabBackground);--lns-color-discoveryBackground: var(--lns-themeDark-color-discoveryBackground);--lns-color-discoveryLightBackground: var(--lns-themeDark-color-discoveryLightBackground);--lns-color-discoveryTitle: var(--lns-themeDark-color-discoveryTitle);--lns-color-discoveryHighlight: var(--lns-themeDark-color-discoveryHighlight);
    }
  

    
    #inner-shadow-companion {
      --lns-fontWeight-book:400;--lns-fontWeight-bold:700;--lns-unit:0.5rem;--lns-fontSize-small:calc(1.5 * var(--lns-unit, 8px));--lns-lineHeight-small:1.5;--lns-fontSize-body-sm:calc(1.5 * var(--lns-unit, 8px));--lns-lineHeight-body-sm:1.5;--lns-fontSize-medium:calc(1.75 * var(--lns-unit, 8px));--lns-lineHeight-medium:1.6;--lns-fontSize-body-md:calc(1.75 * var(--lns-unit, 8px));--lns-lineHeight-body-md:1.6;--lns-fontSize-large:calc(2.25 * var(--lns-unit, 8px));--lns-lineHeight-large:1.45;--lns-fontSize-body-lg:calc(2.25 * var(--lns-unit, 8px));--lns-lineHeight-body-lg:1.45;--lns-fontSize-xlarge:calc(3 * var(--lns-unit, 8px));--lns-lineHeight-xlarge:1.35;--lns-fontSize-heading-sm:calc(3 * var(--lns-unit, 8px));--lns-lineHeight-heading-sm:1.35;--lns-fontSize-xxlarge:calc(4 * var(--lns-unit, 8px));--lns-lineHeight-xxlarge:1.2;--lns-fontSize-heading-md:calc(4 * var(--lns-unit, 8px));--lns-lineHeight-heading-md:1.2;--lns-fontSize-xxxlarge:calc(6 * var(--lns-unit, 8px));--lns-lineHeight-xxxlarge:1.15;--lns-fontSize-heading-lg:calc(6 * var(--lns-unit, 8px));--lns-lineHeight-heading-lg:1.15;--lns-radius-medium:calc(1 * var(--lns-unit, 8px));--lns-radius-large:calc(2 * var(--lns-unit, 8px));--lns-radius-xlarge:calc(3 * var(--lns-unit, 8px));--lns-radius-full:calc(999 * var(--lns-unit, 8px));--lns-shadow-small:0 calc(0.5 * var(--lns-unit, 8px)) calc(1.25 * var(--lns-unit, 8px)) hsla(0, 0%, 0%, 0.05);--lns-shadow-medium:0 calc(0.5 * var(--lns-unit, 8px)) calc(1.25 * var(--lns-unit, 8px)) hsla(0, 0%, 0%, 0.1);--lns-shadow-large:0 calc(0.75 * var(--lns-unit, 8px)) calc(3 * var(--lns-unit, 8px)) hsla(0, 0%, 0%, 0.1);--lns-space-xsmall:calc(0.5 * var(--lns-unit, 8px));--lns-space-small:calc(1 * var(--lns-unit, 8px));--lns-space-medium:calc(2 * var(--lns-unit, 8px));--lns-space-large:calc(3 * var(--lns-unit, 8px));--lns-space-xlarge:calc(5 * var(--lns-unit, 8px));--lns-space-xxlarge:calc(8 * var(--lns-unit, 8px));--lns-formFieldBorderWidth:1px;--lns-formFieldBorderWidthFocus:2px;--lns-formFieldHeight:calc(4.5 * var(--lns-unit, 8px));--lns-formFieldRadius:calc(2.25 * var(--lns-unit, 8px));--lns-formFieldHorizontalPadding:calc(2 * var(--lns-unit, 8px));--lns-formFieldBorderShadow:
    inset 0 0 0 var(--lns-formFieldBorderWidth) var(--lns-color-formFieldBorder)
  ;--lns-formFieldBorderShadowFocus:
    inset 0 0 0 var(--lns-formFieldBorderWidthFocus) var(--lns-color-blurple),
    0 0 0 var(--lns-formFieldBorderWidthFocus) var(--lns-color-focusRing)
  ;--lns-color-red:hsla(11,80%,45%,1);--lns-color-blurpleLight:hsla(240,83.3%,95.3%,1);--lns-color-blurpleMedium:hsla(242,81%,87.6%,1);--lns-color-blurple:hsla(242,88.4%,66.3%,1);--lns-color-blurpleDark:hsla(242,87.6%,62%,1);--lns-color-offWhite:hsla(45,36.4%,95.7%,1);--lns-color-blueLight:hsla(206,58.3%,85.9%,1);--lns-color-blue:hsla(206,100%,73.3%,1);--lns-color-blueDark:hsla(206,29.5%,33.9%,1);--lns-color-orangeLight:hsla(6,100%,89.6%,1);--lns-color-orange:hsla(11,100%,62.2%,1);--lns-color-orangeDark:hsla(11,79.9%,64.9%,1);--lns-color-tealLight:hsla(180,20%,67.6%,1);--lns-color-teal:hsla(180,51.4%,51.6%,1);--lns-color-tealDark:hsla(180,16.2%,22.9%,1);--lns-color-yellowLight:hsla(39,100%,87.8%,1);--lns-color-yellow:hsla(50,100%,57.3%,1);--lns-color-yellowDark:hsla(39,100%,68%,1);--lns-color-grey8:hsla(0,0%,13%,1);--lns-color-grey7:hsla(246,16%,26%,1);--lns-color-grey6:hsla(252,13%,46%,1);--lns-color-grey5:hsla(240,7%,62%,1);--lns-color-grey4:hsla(259,12%,75%,1);--lns-color-grey3:hsla(260,11%,85%,1);--lns-color-grey2:hsla(260,11%,95%,1);--lns-color-grey1:hsla(240,7%,97%,1);--lns-color-white:hsla(0,0%,100%,1);--lns-themeLight-color-primary:hsla(242,88.4%,66.3%,1);--lns-themeLight-color-primaryHover:hsla(242,88.4%,56.3%,1);--lns-themeLight-color-primaryActive:hsla(242,88.4%,45.3%,1);--lns-themeLight-color-body:hsla(0,0%,13%,1);--lns-themeLight-color-bodyDimmed:hsla(252,13%,46%,1);--lns-themeLight-color-background:hsla(0,0%,100%,1);--lns-themeLight-color-backgroundHover:hsla(246,16%,26%,0.1);--lns-themeLight-color-backgroundActive:hsla(246,16%,26%,0.3);--lns-themeLight-color-backgroundSecondary:hsla(246,16%,26%,0.04);--lns-themeLight-color-backgroundSecondary2:hsla(45,34%,78%,0.2);--lns-themeLight-color-overlay:hsla(0,0%,100%,1);--lns-themeLight-color-border:hsla(252,13%,46%,0.2);--lns-themeLight-color-focusRing:hsla(242,88.4%,66.3%,0.5);--lns-themeLight-color-record:hsla(11,100%,62.2%,1);--lns-themeLight-color-recordHover:hsla(11,100%,52.2%,1);--lns-themeLight-color-recordActive:hsla(11,100%,42.2%,1);--lns-themeLight-color-info:hsla(206,100%,73.3%,1);--lns-themeLight-color-success:hsla(180,51.4%,51.6%,1);--lns-themeLight-color-warning:hsla(39,100%,68%,1);--lns-themeLight-color-danger:hsla(11,80%,45%,1);--lns-themeLight-color-dangerHover:hsla(11,80%,38%,1);--lns-themeLight-color-dangerActive:hsla(11,80%,31%,1);--lns-themeLight-color-backdrop:hsla(0,0%,13%,0.5);--lns-themeLight-color-backdropDark:hsla(0,0%,13%,0.9);--lns-themeLight-color-backdropTwilight:hsla(245,44.8%,46.9%,0.8);--lns-themeLight-color-disabledContent:hsla(240,7%,62%,1);--lns-themeLight-color-highlight:hsla(240,83.3%,66.3%,0.15);--lns-themeLight-color-disabledBackground:hsla(260,11%,95%,1);--lns-themeLight-color-formFieldBorder:hsla(260,11%,85%,1);--lns-themeLight-color-formFieldBackground:hsla(0,0%,100%,1);--lns-themeLight-color-buttonBorder:hsla(252,13%,46%,0.25);--lns-themeLight-color-upgrade:hsla(206,100%,93%,1);--lns-themeLight-color-upgradeHover:hsla(206,100%,85%,1);--lns-themeLight-color-upgradeActive:hsla(206,100%,77%,1);--lns-themeLight-color-tabBackground:hsla(252,13%,46%,0.15);--lns-themeLight-color-discoveryBackground:hsla(206,100%,93%,1);--lns-themeLight-color-discoveryLightBackground:hsla(206,100%,97%,1);--lns-themeLight-color-discoveryTitle:hsla(0,0%,13%,1);--lns-themeLight-color-discoveryHighlight:hsla(206,100%,77%,0.3);--lns-themeDark-color-primary:hsla(242,87%,73%,1);--lns-themeDark-color-primaryHover:hsla(242,88.4%,56.3%,1);--lns-themeDark-color-primaryActive:hsla(242,88.4%,45.3%,1);--lns-themeDark-color-body:hsla(240,7%,97%,1);--lns-themeDark-color-bodyDimmed:hsla(240,7%,62%,1);--lns-themeDark-color-background:hsla(0,0%,13%,1);--lns-themeDark-color-backgroundHover:hsla(0,0%,100%,0.1);--lns-themeDark-color-backgroundActive:hsla(0,0%,100%,0.2);--lns-themeDark-color-backgroundSecondary:hsla(0,0%,100%,0.04);--lns-themeDark-color-backgroundSecondary2:hsla(45,13%,44%,0.2);--lns-themeDark-color-overlay:hsla(0,0%,20%,1);--lns-themeDark-color-border:hsla(259,12%,75%,0.2);--lns-themeDark-color-focusRing:hsla(242,88.4%,66.3%,0.5);--lns-themeDark-color-record:hsla(11,100%,62.2%,1);--lns-themeDark-color-recordHover:hsla(11,100%,52.2%,1);--lns-themeDark-color-recordActive:hsla(11,100%,42.2%,1);--lns-themeDark-color-info:hsla(206,100%,73.3%,1);--lns-themeDark-color-success:hsla(180,51.4%,51.6%,1);--lns-themeDark-color-warning:hsla(39,100%,68%,1);--lns-themeDark-color-danger:hsla(11,80%,45%,1);--lns-themeDark-color-dangerHover:hsla(11,80%,38%,1);--lns-themeDark-color-dangerActive:hsla(11,80%,31%,1);--lns-themeDark-color-backdrop:hsla(0,0%,13%,0.5);--lns-themeDark-color-backdropDark:hsla(0,0%,13%,0.9);--lns-themeDark-color-backdropTwilight:hsla(245,44.8%,46.9%,0.8);--lns-themeDark-color-disabledContent:hsla(240,7%,62%,1);--lns-themeDark-color-highlight:hsla(240,83.3%,66.3%,0.15);--lns-themeDark-color-disabledBackground:hsla(252,13%,23%,1);--lns-themeDark-color-formFieldBorder:hsla(252,13%,46%,1);--lns-themeDark-color-formFieldBackground:hsla(0,0%,13%,1);--lns-themeDark-color-buttonBorder:hsla(0,0%,100%,0.25);--lns-themeDark-color-upgrade:hsla(206,92%,81%,1);--lns-themeDark-color-upgradeHover:hsla(206,92%,74%,1);--lns-themeDark-color-upgradeActive:hsla(206,92%,67%,1);--lns-themeDark-color-tabBackground:hsla(0,0%,100%,0.15);--lns-themeDark-color-discoveryBackground:hsla(206,92%,81%,1);--lns-themeDark-color-discoveryLightBackground:hsla(0,0%,13%,1);--lns-themeDark-color-discoveryTitle:hsla(206,100%,73.3%,1);--lns-themeDark-color-discoveryHighlight:hsla(206,100%,77%,0.3);
    }
  

    .c\:red{color:var(--lns-color-red)}.c\:blurpleLight{color:var(--lns-color-blurpleLight)}.c\:blurpleMedium{color:var(--lns-color-blurpleMedium)}.c\:blurple{color:var(--lns-color-blurple)}.c\:blurpleDark{color:var(--lns-color-blurpleDark)}.c\:offWhite{color:var(--lns-color-offWhite)}.c\:blueLight{color:var(--lns-color-blueLight)}.c\:blue{color:var(--lns-color-blue)}.c\:blueDark{color:var(--lns-color-blueDark)}.c\:orangeLight{color:var(--lns-color-orangeLight)}.c\:orange{color:var(--lns-color-orange)}.c\:orangeDark{color:var(--lns-color-orangeDark)}.c\:tealLight{color:var(--lns-color-tealLight)}.c\:teal{color:var(--lns-color-teal)}.c\:tealDark{color:var(--lns-color-tealDark)}.c\:yellowLight{color:var(--lns-color-yellowLight)}.c\:yellow{color:var(--lns-color-yellow)}.c\:yellowDark{color:var(--lns-color-yellowDark)}.c\:grey8{color:var(--lns-color-grey8)}.c\:grey7{color:var(--lns-color-grey7)}.c\:grey6{color:var(--lns-color-grey6)}.c\:grey5{color:var(--lns-color-grey5)}.c\:grey4{color:var(--lns-color-grey4)}.c\:grey3{color:var(--lns-color-grey3)}.c\:grey2{color:var(--lns-color-grey2)}.c\:grey1{color:var(--lns-color-grey1)}.c\:white{color:var(--lns-color-white)}.c\:primary{color:var(--lns-color-primary)}.c\:primaryHover{color:var(--lns-color-primaryHover)}.c\:primaryActive{color:var(--lns-color-primaryActive)}.c\:body{color:var(--lns-color-body)}.c\:bodyDimmed{color:var(--lns-color-bodyDimmed)}.c\:background{color:var(--lns-color-background)}.c\:backgroundHover{color:var(--lns-color-backgroundHover)}.c\:backgroundActive{color:var(--lns-color-backgroundActive)}.c\:backgroundSecondary{color:var(--lns-color-backgroundSecondary)}.c\:backgroundSecondary2{color:var(--lns-color-backgroundSecondary2)}.c\:overlay{color:var(--lns-color-overlay)}.c\:border{color:var(--lns-color-border)}.c\:focusRing{color:var(--lns-color-focusRing)}.c\:record{color:var(--lns-color-record)}.c\:recordHover{color:var(--lns-color-recordHover)}.c\:recordActive{color:var(--lns-color-recordActive)}.c\:info{color:var(--lns-color-info)}.c\:success{color:var(--lns-color-success)}.c\:warning{color:var(--lns-color-warning)}.c\:danger{color:var(--lns-color-danger)}.c\:dangerHover{color:var(--lns-color-dangerHover)}.c\:dangerActive{color:var(--lns-color-dangerActive)}.c\:backdrop{color:var(--lns-color-backdrop)}.c\:backdropDark{color:var(--lns-color-backdropDark)}.c\:backdropTwilight{color:var(--lns-color-backdropTwilight)}.c\:disabledContent{color:var(--lns-color-disabledContent)}.c\:highlight{color:var(--lns-color-highlight)}.c\:disabledBackground{color:var(--lns-color-disabledBackground)}.c\:formFieldBorder{color:var(--lns-color-formFieldBorder)}.c\:formFieldBackground{color:var(--lns-color-formFieldBackground)}.c\:buttonBorder{color:var(--lns-color-buttonBorder)}.c\:upgrade{color:var(--lns-color-upgrade)}.c\:upgradeHover{color:var(--lns-color-upgradeHover)}.c\:upgradeActive{color:var(--lns-color-upgradeActive)}.c\:tabBackground{color:var(--lns-color-tabBackground)}.c\:discoveryBackground{color:var(--lns-color-discoveryBackground)}.c\:discoveryLightBackground{color:var(--lns-color-discoveryLightBackground)}.c\:discoveryTitle{color:var(--lns-color-discoveryTitle)}.c\:discoveryHighlight{color:var(--lns-color-discoveryHighlight)}.shadow\:small{box-shadow:var(--lns-shadow-small)}.shadow\:medium{box-shadow:var(--lns-shadow-medium)}.shadow\:large{box-shadow:var(--lns-shadow-large)}.radius\:medium{border-radius:var(--lns-radius-medium)}.radius\:large{border-radius:var(--lns-radius-large)}.radius\:xlarge{border-radius:var(--lns-radius-xlarge)}.radius\:full{border-radius:var(--lns-radius-full)}.bgc\:red{background-color:var(--lns-color-red)}.bgc\:blurpleLight{background-color:var(--lns-color-blurpleLight)}.bgc\:blurpleMedium{background-color:var(--lns-color-blurpleMedium)}.bgc\:blurple{background-color:var(--lns-color-blurple)}.bgc\:blurpleDark{background-color:var(--lns-color-blurpleDark)}.bgc\:offWhite{background-color:var(--lns-color-offWhite)}.bgc\:blueLight{background-color:var(--lns-color-blueLight)}.bgc\:blue{background-color:var(--lns-color-blue)}.bgc\:blueDark{background-color:var(--lns-color-blueDark)}.bgc\:orangeLight{background-color:var(--lns-color-orangeLight)}.bgc\:orange{background-color:var(--lns-color-orange)}.bgc\:orangeDark{background-color:var(--lns-color-orangeDark)}.bgc\:tealLight{background-color:var(--lns-color-tealLight)}.bgc\:teal{background-color:var(--lns-color-teal)}.bgc\:tealDark{background-color:var(--lns-color-tealDark)}.bgc\:yellowLight{background-color:var(--lns-color-yellowLight)}.bgc\:yellow{background-color:var(--lns-color-yellow)}.bgc\:yellowDark{background-color:var(--lns-color-yellowDark)}.bgc\:grey8{background-color:var(--lns-color-grey8)}.bgc\:grey7{background-color:var(--lns-color-grey7)}.bgc\:grey6{background-color:var(--lns-color-grey6)}.bgc\:grey5{background-color:var(--lns-color-grey5)}.bgc\:grey4{background-color:var(--lns-color-grey4)}.bgc\:grey3{background-color:var(--lns-color-grey3)}.bgc\:grey2{background-color:var(--lns-color-grey2)}.bgc\:grey1{background-color:var(--lns-color-grey1)}.bgc\:white{background-color:var(--lns-color-white)}.bgc\:primary{background-color:var(--lns-color-primary)}.bgc\:primaryHover{background-color:var(--lns-color-primaryHover)}.bgc\:primaryActive{background-color:var(--lns-color-primaryActive)}.bgc\:body{background-color:var(--lns-color-body)}.bgc\:bodyDimmed{background-color:var(--lns-color-bodyDimmed)}.bgc\:background{background-color:var(--lns-color-background)}.bgc\:backgroundHover{background-color:var(--lns-color-backgroundHover)}.bgc\:backgroundActive{background-color:var(--lns-color-backgroundActive)}.bgc\:backgroundSecondary{background-color:var(--lns-color-backgroundSecondary)}.bgc\:backgroundSecondary2{background-color:var(--lns-color-backgroundSecondary2)}.bgc\:overlay{background-color:var(--lns-color-overlay)}.bgc\:border{background-color:var(--lns-color-border)}.bgc\:focusRing{background-color:var(--lns-color-focusRing)}.bgc\:record{background-color:var(--lns-color-record)}.bgc\:recordHover{background-color:var(--lns-color-recordHover)}.bgc\:recordActive{background-color:var(--lns-color-recordActive)}.bgc\:info{background-color:var(--lns-color-info)}.bgc\:success{background-color:var(--lns-color-success)}.bgc\:warning{background-color:var(--lns-color-warning)}.bgc\:danger{background-color:var(--lns-color-danger)}.bgc\:dangerHover{background-color:var(--lns-color-dangerHover)}.bgc\:dangerActive{background-color:var(--lns-color-dangerActive)}.bgc\:backdrop{background-color:var(--lns-color-backdrop)}.bgc\:backdropDark{background-color:var(--lns-color-backdropDark)}.bgc\:backdropTwilight{background-color:var(--lns-color-backdropTwilight)}.bgc\:disabledContent{background-color:var(--lns-color-disabledContent)}.bgc\:highlight{background-color:var(--lns-color-highlight)}.bgc\:disabledBackground{background-color:var(--lns-color-disabledBackground)}.bgc\:formFieldBorder{background-color:var(--lns-color-formFieldBorder)}.bgc\:formFieldBackground{background-color:var(--lns-color-formFieldBackground)}.bgc\:buttonBorder{background-color:var(--lns-color-buttonBorder)}.bgc\:upgrade{background-color:var(--lns-color-upgrade)}.bgc\:upgradeHover{background-color:var(--lns-color-upgradeHover)}.bgc\:upgradeActive{background-color:var(--lns-color-upgradeActive)}.bgc\:tabBackground{background-color:var(--lns-color-tabBackground)}.bgc\:discoveryBackground{background-color:var(--lns-color-discoveryBackground)}.bgc\:discoveryLightBackground{background-color:var(--lns-color-discoveryLightBackground)}.bgc\:discoveryTitle{background-color:var(--lns-color-discoveryTitle)}.bgc\:discoveryHighlight{background-color:var(--lns-color-discoveryHighlight)}.m\:0{margin:0}.m\:auto{margin:auto}.m\:xsmall{margin:var(--lns-space-xsmall)}.m\:small{margin:var(--lns-space-small)}.m\:medium{margin:var(--lns-space-medium)}.m\:large{margin:var(--lns-space-large)}.m\:xlarge{margin:var(--lns-space-xlarge)}.m\:xxlarge{margin:var(--lns-space-xxlarge)}.mt\:0{margin-top:0}.mt\:auto{margin-top:auto}.mt\:xsmall{margin-top:var(--lns-space-xsmall)}.mt\:small{margin-top:var(--lns-space-small)}.mt\:medium{margin-top:var(--lns-space-medium)}.mt\:large{margin-top:var(--lns-space-large)}.mt\:xlarge{margin-top:var(--lns-space-xlarge)}.mt\:xxlarge{margin-top:var(--lns-space-xxlarge)}.mb\:0{margin-bottom:0}.mb\:auto{margin-bottom:auto}.mb\:xsmall{margin-bottom:var(--lns-space-xsmall)}.mb\:small{margin-bottom:var(--lns-space-small)}.mb\:medium{margin-bottom:var(--lns-space-medium)}.mb\:large{margin-bottom:var(--lns-space-large)}.mb\:xlarge{margin-bottom:var(--lns-space-xlarge)}.mb\:xxlarge{margin-bottom:var(--lns-space-xxlarge)}.ml\:0{margin-left:0}.ml\:auto{margin-left:auto}.ml\:xsmall{margin-left:var(--lns-space-xsmall)}.ml\:small{margin-left:var(--lns-space-small)}.ml\:medium{margin-left:var(--lns-space-medium)}.ml\:large{margin-left:var(--lns-space-large)}.ml\:xlarge{margin-left:var(--lns-space-xlarge)}.ml\:xxlarge{margin-left:var(--lns-space-xxlarge)}.mr\:0{margin-right:0}.mr\:auto{margin-right:auto}.mr\:xsmall{margin-right:var(--lns-space-xsmall)}.mr\:small{margin-right:var(--lns-space-small)}.mr\:medium{margin-right:var(--lns-space-medium)}.mr\:large{margin-right:var(--lns-space-large)}.mr\:xlarge{margin-right:var(--lns-space-xlarge)}.mr\:xxlarge{margin-right:var(--lns-space-xxlarge)}.mx\:0{margin-left:0;margin-right:0}.mx\:auto{margin-left:auto;margin-right:auto}.mx\:xsmall{margin-left:var(--lns-space-xsmall);margin-right:var(--lns-space-xsmall)}.mx\:small{margin-left:var(--lns-space-small);margin-right:var(--lns-space-small)}.mx\:medium{margin-left:var(--lns-space-medium);margin-right:var(--lns-space-medium)}.mx\:large{margin-left:var(--lns-space-large);margin-right:var(--lns-space-large)}.mx\:xlarge{margin-left:var(--lns-space-xlarge);margin-right:var(--lns-space-xlarge)}.mx\:xxlarge{margin-left:var(--lns-space-xxlarge);margin-right:var(--lns-space-xxlarge)}.my\:0{margin-top:0;margin-bottom:0}.my\:auto{margin-top:auto;margin-bottom:auto}.my\:xsmall{margin-top:var(--lns-space-xsmall);margin-bottom:var(--lns-space-xsmall)}.my\:small{margin-top:var(--lns-space-small);margin-bottom:var(--lns-space-small)}.my\:medium{margin-top:var(--lns-space-medium);margin-bottom:var(--lns-space-medium)}.my\:large{margin-top:var(--lns-space-large);margin-bottom:var(--lns-space-large)}.my\:xlarge{margin-top:var(--lns-space-xlarge);margin-bottom:var(--lns-space-xlarge)}.my\:xxlarge{margin-top:var(--lns-space-xxlarge);margin-bottom:var(--lns-space-xxlarge)}.p\:0{padding:0}.p\:xsmall{padding:var(--lns-space-xsmall)}.p\:small{padding:var(--lns-space-small)}.p\:medium{padding:var(--lns-space-medium)}.p\:large{padding:var(--lns-space-large)}.p\:xlarge{padding:var(--lns-space-xlarge)}.p\:xxlarge{padding:var(--lns-space-xxlarge)}.pt\:0{padding-top:0}.pt\:xsmall{padding-top:var(--lns-space-xsmall)}.pt\:small{padding-top:var(--lns-space-small)}.pt\:medium{padding-top:var(--lns-space-medium)}.pt\:large{padding-top:var(--lns-space-large)}.pt\:xlarge{padding-top:var(--lns-space-xlarge)}.pt\:xxlarge{padding-top:var(--lns-space-xxlarge)}.pb\:0{padding-bottom:0}.pb\:xsmall{padding-bottom:var(--lns-space-xsmall)}.pb\:small{padding-bottom:var(--lns-space-small)}.pb\:medium{padding-bottom:var(--lns-space-medium)}.pb\:large{padding-bottom:var(--lns-space-large)}.pb\:xlarge{padding-bottom:var(--lns-space-xlarge)}.pb\:xxlarge{padding-bottom:var(--lns-space-xxlarge)}.pl\:0{padding-left:0}.pl\:xsmall{padding-left:var(--lns-space-xsmall)}.pl\:small{padding-left:var(--lns-space-small)}.pl\:medium{padding-left:var(--lns-space-medium)}.pl\:large{padding-left:var(--lns-space-large)}.pl\:xlarge{padding-left:var(--lns-space-xlarge)}.pl\:xxlarge{padding-left:var(--lns-space-xxlarge)}.pr\:0{padding-right:0}.pr\:xsmall{padding-right:var(--lns-space-xsmall)}.pr\:small{padding-right:var(--lns-space-small)}.pr\:medium{padding-right:var(--lns-space-medium)}.pr\:large{padding-right:var(--lns-space-large)}.pr\:xlarge{padding-right:var(--lns-space-xlarge)}.pr\:xxlarge{padding-right:var(--lns-space-xxlarge)}.px\:0{padding-left:0;padding-right:0}.px\:xsmall{padding-left:var(--lns-space-xsmall);padding-right:var(--lns-space-xsmall)}.px\:small{padding-left:var(--lns-space-small);padding-right:var(--lns-space-small)}.px\:medium{padding-left:var(--lns-space-medium);padding-right:var(--lns-space-medium)}.px\:large{padding-left:var(--lns-space-large);padding-right:var(--lns-space-large)}.px\:xlarge{padding-left:var(--lns-space-xlarge);padding-right:var(--lns-space-xlarge)}.px\:xxlarge{padding-left:var(--lns-space-xxlarge);padding-right:var(--lns-space-xxlarge)}.py\:0{padding-top:0;padding-bottom:0}.py\:xsmall{padding-top:var(--lns-space-xsmall);padding-bottom:var(--lns-space-xsmall)}.py\:small{padding-top:var(--lns-space-small);padding-bottom:var(--lns-space-small)}.py\:medium{padding-top:var(--lns-space-medium);padding-bottom:var(--lns-space-medium)}.py\:large{padding-top:var(--lns-space-large);padding-bottom:var(--lns-space-large)}.py\:xlarge{padding-top:var(--lns-space-xlarge);padding-bottom:var(--lns-space-xlarge)}.py\:xxlarge{padding-top:var(--lns-space-xxlarge);padding-bottom:var(--lns-space-xxlarge)}.text\:small{font-size:var(--lns-fontSize-small);line-height:var(--lns-lineHeight-small)}.text\:body-sm{font-size:var(--lns-fontSize-body-sm);line-height:var(--lns-lineHeight-body-sm)}.text\:medium{font-size:var(--lns-fontSize-medium);line-height:var(--lns-lineHeight-medium)}.text\:body-md{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md)}.text\:large{font-size:var(--lns-fontSize-large);line-height:var(--lns-lineHeight-large)}.text\:body-lg{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg)}.text\:xlarge{font-size:var(--lns-fontSize-xlarge);line-height:var(--lns-lineHeight-xlarge)}.text\:heading-sm{font-size:var(--lns-fontSize-heading-sm);line-height:var(--lns-lineHeight-heading-sm)}.text\:xxlarge{font-size:var(--lns-fontSize-xxlarge);line-height:var(--lns-lineHeight-xxlarge)}.text\:heading-md{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md)}.text\:xxxlarge{font-size:var(--lns-fontSize-xxxlarge);line-height:var(--lns-lineHeight-xxxlarge)}.text\:heading-lg{font-size:var(--lns-fontSize-heading-lg);line-height:var(--lns-lineHeight-heading-lg)}.weight\:book{font-weight:var(--lns-fontWeight-book)}.weight\:bold{font-weight:var(--lns-fontWeight-bold)}.text\:body{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md);font-weight:var(--lns-fontWeight-book)}.text\:title{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg);font-weight:var(--lns-fontWeight-bold)}.text\:mainTitle{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md);font-weight:var(--lns-fontWeight-bold)}.text\:left{text-align:left}.text\:right{text-align:right}.text\:center{text-align:center}.border{border:1px solid var(--lns-color-border)}.borderTop{border-top:1px solid var(--lns-color-border)}.borderBottom{border-bottom:1px solid var(--lns-color-border)}.borderLeft{border-left:1px solid var(--lns-color-border)}.borderRight{border-right:1px solid var(--lns-color-border)}.inline{display:inline}.block{display:block}.flex{display:flex}.inlineBlock{display:inline-block}.inlineFlex{display:inline-flex}.none{display:none}.flexWrap{flex-wrap:wrap}.flexDirection\:column{flex-direction:column}.flexDirection\:row{flex-direction:row}.items\:stretch{align-items:stretch}.items\:center{align-items:center}.items\:baseline{align-items:baseline}.items\:flexStart{align-items:flex-start}.items\:flexEnd{align-items:flex-end}.items\:selfStart{align-items:self-start}.items\:selfEnd{align-items:self-end}.justify\:flexStart{justify-content:flex-start}.justify\:flexEnd{justify-content:flex-end}.justify\:center{justify-content:center}.justify\:spaceBetween{justify-content:space-between}.justify\:spaceAround{justify-content:space-around}.justify\:spaceEvenly{justify-content:space-evenly}.grow\:0{flex-grow:0}.grow\:1{flex-grow:1}.shrink\:0{flex-shrink:0}.shrink\:1{flex-shrink:1}.self\:auto{align-self:auto}.self\:flexStart{align-self:flex-start}.self\:flexEnd{align-self:flex-end}.self\:center{align-self:center}.self\:baseline{align-self:baseline}.self\:stretch{align-self:stretch}.overflow\:hidden{overflow:hidden}.overflow\:auto{overflow:auto}.relative{position:relative}.absolute{position:absolute}.sticky{position:sticky}.fixed{position:fixed}.top\:0{top:0}.top\:auto{top:auto}.top\:xsmall{top:var(--lns-space-xsmall)}.top\:small{top:var(--lns-space-small)}.top\:medium{top:var(--lns-space-medium)}.top\:large{top:var(--lns-space-large)}.top\:xlarge{top:var(--lns-space-xlarge)}.top\:xxlarge{top:var(--lns-space-xxlarge)}.bottom\:0{bottom:0}.bottom\:auto{bottom:auto}.bottom\:xsmall{bottom:var(--lns-space-xsmall)}.bottom\:small{bottom:var(--lns-space-small)}.bottom\:medium{bottom:var(--lns-space-medium)}.bottom\:large{bottom:var(--lns-space-large)}.bottom\:xlarge{bottom:var(--lns-space-xlarge)}.bottom\:xxlarge{bottom:var(--lns-space-xxlarge)}.left\:0{left:0}.left\:auto{left:auto}.left\:xsmall{left:var(--lns-space-xsmall)}.left\:small{left:var(--lns-space-small)}.left\:medium{left:var(--lns-space-medium)}.left\:large{left:var(--lns-space-large)}.left\:xlarge{left:var(--lns-space-xlarge)}.left\:xxlarge{left:var(--lns-space-xxlarge)}.right\:0{right:0}.right\:auto{right:auto}.right\:xsmall{right:var(--lns-space-xsmall)}.right\:small{right:var(--lns-space-small)}.right\:medium{right:var(--lns-space-medium)}.right\:large{right:var(--lns-space-large)}.right\:xlarge{right:var(--lns-space-xlarge)}.right\:xxlarge{right:var(--lns-space-xxlarge)}.width\:auto{width:auto}.width\:full{width:100%}.width\:0{width:0}.minWidth\:0{min-width:0}.height\:auto{height:auto}.height\:full{height:100%}.height\:0{height:0}.ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.srOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}@media(min-width:31em){.xs-c\:red{color:var(--lns-color-red)}.xs-c\:blurpleLight{color:var(--lns-color-blurpleLight)}.xs-c\:blurpleMedium{color:var(--lns-color-blurpleMedium)}.xs-c\:blurple{color:var(--lns-color-blurple)}.xs-c\:blurpleDark{color:var(--lns-color-blurpleDark)}.xs-c\:offWhite{color:var(--lns-color-offWhite)}.xs-c\:blueLight{color:var(--lns-color-blueLight)}.xs-c\:blue{color:var(--lns-color-blue)}.xs-c\:blueDark{color:var(--lns-color-blueDark)}.xs-c\:orangeLight{color:var(--lns-color-orangeLight)}.xs-c\:orange{color:var(--lns-color-orange)}.xs-c\:orangeDark{color:var(--lns-color-orangeDark)}.xs-c\:tealLight{color:var(--lns-color-tealLight)}.xs-c\:teal{color:var(--lns-color-teal)}.xs-c\:tealDark{color:var(--lns-color-tealDark)}.xs-c\:yellowLight{color:var(--lns-color-yellowLight)}.xs-c\:yellow{color:var(--lns-color-yellow)}.xs-c\:yellowDark{color:var(--lns-color-yellowDark)}.xs-c\:grey8{color:var(--lns-color-grey8)}.xs-c\:grey7{color:var(--lns-color-grey7)}.xs-c\:grey6{color:var(--lns-color-grey6)}.xs-c\:grey5{color:var(--lns-color-grey5)}.xs-c\:grey4{color:var(--lns-color-grey4)}.xs-c\:grey3{color:var(--lns-color-grey3)}.xs-c\:grey2{color:var(--lns-color-grey2)}.xs-c\:grey1{color:var(--lns-color-grey1)}.xs-c\:white{color:var(--lns-color-white)}.xs-c\:primary{color:var(--lns-color-primary)}.xs-c\:primaryHover{color:var(--lns-color-primaryHover)}.xs-c\:primaryActive{color:var(--lns-color-primaryActive)}.xs-c\:body{color:var(--lns-color-body)}.xs-c\:bodyDimmed{color:var(--lns-color-bodyDimmed)}.xs-c\:background{color:var(--lns-color-background)}.xs-c\:backgroundHover{color:var(--lns-color-backgroundHover)}.xs-c\:backgroundActive{color:var(--lns-color-backgroundActive)}.xs-c\:backgroundSecondary{color:var(--lns-color-backgroundSecondary)}.xs-c\:backgroundSecondary2{color:var(--lns-color-backgroundSecondary2)}.xs-c\:overlay{color:var(--lns-color-overlay)}.xs-c\:border{color:var(--lns-color-border)}.xs-c\:focusRing{color:var(--lns-color-focusRing)}.xs-c\:record{color:var(--lns-color-record)}.xs-c\:recordHover{color:var(--lns-color-recordHover)}.xs-c\:recordActive{color:var(--lns-color-recordActive)}.xs-c\:info{color:var(--lns-color-info)}.xs-c\:success{color:var(--lns-color-success)}.xs-c\:warning{color:var(--lns-color-warning)}.xs-c\:danger{color:var(--lns-color-danger)}.xs-c\:dangerHover{color:var(--lns-color-dangerHover)}.xs-c\:dangerActive{color:var(--lns-color-dangerActive)}.xs-c\:backdrop{color:var(--lns-color-backdrop)}.xs-c\:backdropDark{color:var(--lns-color-backdropDark)}.xs-c\:backdropTwilight{color:var(--lns-color-backdropTwilight)}.xs-c\:disabledContent{color:var(--lns-color-disabledContent)}.xs-c\:highlight{color:var(--lns-color-highlight)}.xs-c\:disabledBackground{color:var(--lns-color-disabledBackground)}.xs-c\:formFieldBorder{color:var(--lns-color-formFieldBorder)}.xs-c\:formFieldBackground{color:var(--lns-color-formFieldBackground)}.xs-c\:buttonBorder{color:var(--lns-color-buttonBorder)}.xs-c\:upgrade{color:var(--lns-color-upgrade)}.xs-c\:upgradeHover{color:var(--lns-color-upgradeHover)}.xs-c\:upgradeActive{color:var(--lns-color-upgradeActive)}.xs-c\:tabBackground{color:var(--lns-color-tabBackground)}.xs-c\:discoveryBackground{color:var(--lns-color-discoveryBackground)}.xs-c\:discoveryLightBackground{color:var(--lns-color-discoveryLightBackground)}.xs-c\:discoveryTitle{color:var(--lns-color-discoveryTitle)}.xs-c\:discoveryHighlight{color:var(--lns-color-discoveryHighlight)}.xs-shadow\:small{box-shadow:var(--lns-shadow-small)}.xs-shadow\:medium{box-shadow:var(--lns-shadow-medium)}.xs-shadow\:large{box-shadow:var(--lns-shadow-large)}.xs-radius\:medium{border-radius:var(--lns-radius-medium)}.xs-radius\:large{border-radius:var(--lns-radius-large)}.xs-radius\:xlarge{border-radius:var(--lns-radius-xlarge)}.xs-radius\:full{border-radius:var(--lns-radius-full)}.xs-bgc\:red{background-color:var(--lns-color-red)}.xs-bgc\:blurpleLight{background-color:var(--lns-color-blurpleLight)}.xs-bgc\:blurpleMedium{background-color:var(--lns-color-blurpleMedium)}.xs-bgc\:blurple{background-color:var(--lns-color-blurple)}.xs-bgc\:blurpleDark{background-color:var(--lns-color-blurpleDark)}.xs-bgc\:offWhite{background-color:var(--lns-color-offWhite)}.xs-bgc\:blueLight{background-color:var(--lns-color-blueLight)}.xs-bgc\:blue{background-color:var(--lns-color-blue)}.xs-bgc\:blueDark{background-color:var(--lns-color-blueDark)}.xs-bgc\:orangeLight{background-color:var(--lns-color-orangeLight)}.xs-bgc\:orange{background-color:var(--lns-color-orange)}.xs-bgc\:orangeDark{background-color:var(--lns-color-orangeDark)}.xs-bgc\:tealLight{background-color:var(--lns-color-tealLight)}.xs-bgc\:teal{background-color:var(--lns-color-teal)}.xs-bgc\:tealDark{background-color:var(--lns-color-tealDark)}.xs-bgc\:yellowLight{background-color:var(--lns-color-yellowLight)}.xs-bgc\:yellow{background-color:var(--lns-color-yellow)}.xs-bgc\:yellowDark{background-color:var(--lns-color-yellowDark)}.xs-bgc\:grey8{background-color:var(--lns-color-grey8)}.xs-bgc\:grey7{background-color:var(--lns-color-grey7)}.xs-bgc\:grey6{background-color:var(--lns-color-grey6)}.xs-bgc\:grey5{background-color:var(--lns-color-grey5)}.xs-bgc\:grey4{background-color:var(--lns-color-grey4)}.xs-bgc\:grey3{background-color:var(--lns-color-grey3)}.xs-bgc\:grey2{background-color:var(--lns-color-grey2)}.xs-bgc\:grey1{background-color:var(--lns-color-grey1)}.xs-bgc\:white{background-color:var(--lns-color-white)}.xs-bgc\:primary{background-color:var(--lns-color-primary)}.xs-bgc\:primaryHover{background-color:var(--lns-color-primaryHover)}.xs-bgc\:primaryActive{background-color:var(--lns-color-primaryActive)}.xs-bgc\:body{background-color:var(--lns-color-body)}.xs-bgc\:bodyDimmed{background-color:var(--lns-color-bodyDimmed)}.xs-bgc\:background{background-color:var(--lns-color-background)}.xs-bgc\:backgroundHover{background-color:var(--lns-color-backgroundHover)}.xs-bgc\:backgroundActive{background-color:var(--lns-color-backgroundActive)}.xs-bgc\:backgroundSecondary{background-color:var(--lns-color-backgroundSecondary)}.xs-bgc\:backgroundSecondary2{background-color:var(--lns-color-backgroundSecondary2)}.xs-bgc\:overlay{background-color:var(--lns-color-overlay)}.xs-bgc\:border{background-color:var(--lns-color-border)}.xs-bgc\:focusRing{background-color:var(--lns-color-focusRing)}.xs-bgc\:record{background-color:var(--lns-color-record)}.xs-bgc\:recordHover{background-color:var(--lns-color-recordHover)}.xs-bgc\:recordActive{background-color:var(--lns-color-recordActive)}.xs-bgc\:info{background-color:var(--lns-color-info)}.xs-bgc\:success{background-color:var(--lns-color-success)}.xs-bgc\:warning{background-color:var(--lns-color-warning)}.xs-bgc\:danger{background-color:var(--lns-color-danger)}.xs-bgc\:dangerHover{background-color:var(--lns-color-dangerHover)}.xs-bgc\:dangerActive{background-color:var(--lns-color-dangerActive)}.xs-bgc\:backdrop{background-color:var(--lns-color-backdrop)}.xs-bgc\:backdropDark{background-color:var(--lns-color-backdropDark)}.xs-bgc\:backdropTwilight{background-color:var(--lns-color-backdropTwilight)}.xs-bgc\:disabledContent{background-color:var(--lns-color-disabledContent)}.xs-bgc\:highlight{background-color:var(--lns-color-highlight)}.xs-bgc\:disabledBackground{background-color:var(--lns-color-disabledBackground)}.xs-bgc\:formFieldBorder{background-color:var(--lns-color-formFieldBorder)}.xs-bgc\:formFieldBackground{background-color:var(--lns-color-formFieldBackground)}.xs-bgc\:buttonBorder{background-color:var(--lns-color-buttonBorder)}.xs-bgc\:upgrade{background-color:var(--lns-color-upgrade)}.xs-bgc\:upgradeHover{background-color:var(--lns-color-upgradeHover)}.xs-bgc\:upgradeActive{background-color:var(--lns-color-upgradeActive)}.xs-bgc\:tabBackground{background-color:var(--lns-color-tabBackground)}.xs-bgc\:discoveryBackground{background-color:var(--lns-color-discoveryBackground)}.xs-bgc\:discoveryLightBackground{background-color:var(--lns-color-discoveryLightBackground)}.xs-bgc\:discoveryTitle{background-color:var(--lns-color-discoveryTitle)}.xs-bgc\:discoveryHighlight{background-color:var(--lns-color-discoveryHighlight)}.xs-m\:0{margin:0}.xs-m\:auto{margin:auto}.xs-m\:xsmall{margin:var(--lns-space-xsmall)}.xs-m\:small{margin:var(--lns-space-small)}.xs-m\:medium{margin:var(--lns-space-medium)}.xs-m\:large{margin:var(--lns-space-large)}.xs-m\:xlarge{margin:var(--lns-space-xlarge)}.xs-m\:xxlarge{margin:var(--lns-space-xxlarge)}.xs-mt\:0{margin-top:0}.xs-mt\:auto{margin-top:auto}.xs-mt\:xsmall{margin-top:var(--lns-space-xsmall)}.xs-mt\:small{margin-top:var(--lns-space-small)}.xs-mt\:medium{margin-top:var(--lns-space-medium)}.xs-mt\:large{margin-top:var(--lns-space-large)}.xs-mt\:xlarge{margin-top:var(--lns-space-xlarge)}.xs-mt\:xxlarge{margin-top:var(--lns-space-xxlarge)}.xs-mb\:0{margin-bottom:0}.xs-mb\:auto{margin-bottom:auto}.xs-mb\:xsmall{margin-bottom:var(--lns-space-xsmall)}.xs-mb\:small{margin-bottom:var(--lns-space-small)}.xs-mb\:medium{margin-bottom:var(--lns-space-medium)}.xs-mb\:large{margin-bottom:var(--lns-space-large)}.xs-mb\:xlarge{margin-bottom:var(--lns-space-xlarge)}.xs-mb\:xxlarge{margin-bottom:var(--lns-space-xxlarge)}.xs-ml\:0{margin-left:0}.xs-ml\:auto{margin-left:auto}.xs-ml\:xsmall{margin-left:var(--lns-space-xsmall)}.xs-ml\:small{margin-left:var(--lns-space-small)}.xs-ml\:medium{margin-left:var(--lns-space-medium)}.xs-ml\:large{margin-left:var(--lns-space-large)}.xs-ml\:xlarge{margin-left:var(--lns-space-xlarge)}.xs-ml\:xxlarge{margin-left:var(--lns-space-xxlarge)}.xs-mr\:0{margin-right:0}.xs-mr\:auto{margin-right:auto}.xs-mr\:xsmall{margin-right:var(--lns-space-xsmall)}.xs-mr\:small{margin-right:var(--lns-space-small)}.xs-mr\:medium{margin-right:var(--lns-space-medium)}.xs-mr\:large{margin-right:var(--lns-space-large)}.xs-mr\:xlarge{margin-right:var(--lns-space-xlarge)}.xs-mr\:xxlarge{margin-right:var(--lns-space-xxlarge)}.xs-mx\:0{margin-left:0;margin-right:0}.xs-mx\:auto{margin-left:auto;margin-right:auto}.xs-mx\:xsmall{margin-left:var(--lns-space-xsmall);margin-right:var(--lns-space-xsmall)}.xs-mx\:small{margin-left:var(--lns-space-small);margin-right:var(--lns-space-small)}.xs-mx\:medium{margin-left:var(--lns-space-medium);margin-right:var(--lns-space-medium)}.xs-mx\:large{margin-left:var(--lns-space-large);margin-right:var(--lns-space-large)}.xs-mx\:xlarge{margin-left:var(--lns-space-xlarge);margin-right:var(--lns-space-xlarge)}.xs-mx\:xxlarge{margin-left:var(--lns-space-xxlarge);margin-right:var(--lns-space-xxlarge)}.xs-my\:0{margin-top:0;margin-bottom:0}.xs-my\:auto{margin-top:auto;margin-bottom:auto}.xs-my\:xsmall{margin-top:var(--lns-space-xsmall);margin-bottom:var(--lns-space-xsmall)}.xs-my\:small{margin-top:var(--lns-space-small);margin-bottom:var(--lns-space-small)}.xs-my\:medium{margin-top:var(--lns-space-medium);margin-bottom:var(--lns-space-medium)}.xs-my\:large{margin-top:var(--lns-space-large);margin-bottom:var(--lns-space-large)}.xs-my\:xlarge{margin-top:var(--lns-space-xlarge);margin-bottom:var(--lns-space-xlarge)}.xs-my\:xxlarge{margin-top:var(--lns-space-xxlarge);margin-bottom:var(--lns-space-xxlarge)}.xs-p\:0{padding:0}.xs-p\:xsmall{padding:var(--lns-space-xsmall)}.xs-p\:small{padding:var(--lns-space-small)}.xs-p\:medium{padding:var(--lns-space-medium)}.xs-p\:large{padding:var(--lns-space-large)}.xs-p\:xlarge{padding:var(--lns-space-xlarge)}.xs-p\:xxlarge{padding:var(--lns-space-xxlarge)}.xs-pt\:0{padding-top:0}.xs-pt\:xsmall{padding-top:var(--lns-space-xsmall)}.xs-pt\:small{padding-top:var(--lns-space-small)}.xs-pt\:medium{padding-top:var(--lns-space-medium)}.xs-pt\:large{padding-top:var(--lns-space-large)}.xs-pt\:xlarge{padding-top:var(--lns-space-xlarge)}.xs-pt\:xxlarge{padding-top:var(--lns-space-xxlarge)}.xs-pb\:0{padding-bottom:0}.xs-pb\:xsmall{padding-bottom:var(--lns-space-xsmall)}.xs-pb\:small{padding-bottom:var(--lns-space-small)}.xs-pb\:medium{padding-bottom:var(--lns-space-medium)}.xs-pb\:large{padding-bottom:var(--lns-space-large)}.xs-pb\:xlarge{padding-bottom:var(--lns-space-xlarge)}.xs-pb\:xxlarge{padding-bottom:var(--lns-space-xxlarge)}.xs-pl\:0{padding-left:0}.xs-pl\:xsmall{padding-left:var(--lns-space-xsmall)}.xs-pl\:small{padding-left:var(--lns-space-small)}.xs-pl\:medium{padding-left:var(--lns-space-medium)}.xs-pl\:large{padding-left:var(--lns-space-large)}.xs-pl\:xlarge{padding-left:var(--lns-space-xlarge)}.xs-pl\:xxlarge{padding-left:var(--lns-space-xxlarge)}.xs-pr\:0{padding-right:0}.xs-pr\:xsmall{padding-right:var(--lns-space-xsmall)}.xs-pr\:small{padding-right:var(--lns-space-small)}.xs-pr\:medium{padding-right:var(--lns-space-medium)}.xs-pr\:large{padding-right:var(--lns-space-large)}.xs-pr\:xlarge{padding-right:var(--lns-space-xlarge)}.xs-pr\:xxlarge{padding-right:var(--lns-space-xxlarge)}.xs-px\:0{padding-left:0;padding-right:0}.xs-px\:xsmall{padding-left:var(--lns-space-xsmall);padding-right:var(--lns-space-xsmall)}.xs-px\:small{padding-left:var(--lns-space-small);padding-right:var(--lns-space-small)}.xs-px\:medium{padding-left:var(--lns-space-medium);padding-right:var(--lns-space-medium)}.xs-px\:large{padding-left:var(--lns-space-large);padding-right:var(--lns-space-large)}.xs-px\:xlarge{padding-left:var(--lns-space-xlarge);padding-right:var(--lns-space-xlarge)}.xs-px\:xxlarge{padding-left:var(--lns-space-xxlarge);padding-right:var(--lns-space-xxlarge)}.xs-py\:0{padding-top:0;padding-bottom:0}.xs-py\:xsmall{padding-top:var(--lns-space-xsmall);padding-bottom:var(--lns-space-xsmall)}.xs-py\:small{padding-top:var(--lns-space-small);padding-bottom:var(--lns-space-small)}.xs-py\:medium{padding-top:var(--lns-space-medium);padding-bottom:var(--lns-space-medium)}.xs-py\:large{padding-top:var(--lns-space-large);padding-bottom:var(--lns-space-large)}.xs-py\:xlarge{padding-top:var(--lns-space-xlarge);padding-bottom:var(--lns-space-xlarge)}.xs-py\:xxlarge{padding-top:var(--lns-space-xxlarge);padding-bottom:var(--lns-space-xxlarge)}.xs-text\:small{font-size:var(--lns-fontSize-small);line-height:var(--lns-lineHeight-small)}.xs-text\:body-sm{font-size:var(--lns-fontSize-body-sm);line-height:var(--lns-lineHeight-body-sm)}.xs-text\:medium{font-size:var(--lns-fontSize-medium);line-height:var(--lns-lineHeight-medium)}.xs-text\:body-md{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md)}.xs-text\:large{font-size:var(--lns-fontSize-large);line-height:var(--lns-lineHeight-large)}.xs-text\:body-lg{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg)}.xs-text\:xlarge{font-size:var(--lns-fontSize-xlarge);line-height:var(--lns-lineHeight-xlarge)}.xs-text\:heading-sm{font-size:var(--lns-fontSize-heading-sm);line-height:var(--lns-lineHeight-heading-sm)}.xs-text\:xxlarge{font-size:var(--lns-fontSize-xxlarge);line-height:var(--lns-lineHeight-xxlarge)}.xs-text\:heading-md{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md)}.xs-text\:xxxlarge{font-size:var(--lns-fontSize-xxxlarge);line-height:var(--lns-lineHeight-xxxlarge)}.xs-text\:heading-lg{font-size:var(--lns-fontSize-heading-lg);line-height:var(--lns-lineHeight-heading-lg)}.xs-weight\:book{font-weight:var(--lns-fontWeight-book)}.xs-weight\:bold{font-weight:var(--lns-fontWeight-bold)}.xs-text\:body{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md);font-weight:var(--lns-fontWeight-book)}.xs-text\:title{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg);font-weight:var(--lns-fontWeight-bold)}.xs-text\:mainTitle{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md);font-weight:var(--lns-fontWeight-bold)}.xs-text\:left{text-align:left}.xs-text\:right{text-align:right}.xs-text\:center{text-align:center}.xs-border{border:1px solid var(--lns-color-border)}.xs-borderTop{border-top:1px solid var(--lns-color-border)}.xs-borderBottom{border-bottom:1px solid var(--lns-color-border)}.xs-borderLeft{border-left:1px solid var(--lns-color-border)}.xs-borderRight{border-right:1px solid var(--lns-color-border)}.xs-inline{display:inline}.xs-block{display:block}.xs-flex{display:flex}.xs-inlineBlock{display:inline-block}.xs-inlineFlex{display:inline-flex}.xs-none{display:none}.xs-flexWrap{flex-wrap:wrap}.xs-flexDirection\:column{flex-direction:column}.xs-flexDirection\:row{flex-direction:row}.xs-items\:stretch{align-items:stretch}.xs-items\:center{align-items:center}.xs-items\:baseline{align-items:baseline}.xs-items\:flexStart{align-items:flex-start}.xs-items\:flexEnd{align-items:flex-end}.xs-items\:selfStart{align-items:self-start}.xs-items\:selfEnd{align-items:self-end}.xs-justify\:flexStart{justify-content:flex-start}.xs-justify\:flexEnd{justify-content:flex-end}.xs-justify\:center{justify-content:center}.xs-justify\:spaceBetween{justify-content:space-between}.xs-justify\:spaceAround{justify-content:space-around}.xs-justify\:spaceEvenly{justify-content:space-evenly}.xs-grow\:0{flex-grow:0}.xs-grow\:1{flex-grow:1}.xs-shrink\:0{flex-shrink:0}.xs-shrink\:1{flex-shrink:1}.xs-self\:auto{align-self:auto}.xs-self\:flexStart{align-self:flex-start}.xs-self\:flexEnd{align-self:flex-end}.xs-self\:center{align-self:center}.xs-self\:baseline{align-self:baseline}.xs-self\:stretch{align-self:stretch}.xs-overflow\:hidden{overflow:hidden}.xs-overflow\:auto{overflow:auto}.xs-relative{position:relative}.xs-absolute{position:absolute}.xs-sticky{position:sticky}.xs-fixed{position:fixed}.xs-top\:0{top:0}.xs-top\:auto{top:auto}.xs-top\:xsmall{top:var(--lns-space-xsmall)}.xs-top\:small{top:var(--lns-space-small)}.xs-top\:medium{top:var(--lns-space-medium)}.xs-top\:large{top:var(--lns-space-large)}.xs-top\:xlarge{top:var(--lns-space-xlarge)}.xs-top\:xxlarge{top:var(--lns-space-xxlarge)}.xs-bottom\:0{bottom:0}.xs-bottom\:auto{bottom:auto}.xs-bottom\:xsmall{bottom:var(--lns-space-xsmall)}.xs-bottom\:small{bottom:var(--lns-space-small)}.xs-bottom\:medium{bottom:var(--lns-space-medium)}.xs-bottom\:large{bottom:var(--lns-space-large)}.xs-bottom\:xlarge{bottom:var(--lns-space-xlarge)}.xs-bottom\:xxlarge{bottom:var(--lns-space-xxlarge)}.xs-left\:0{left:0}.xs-left\:auto{left:auto}.xs-left\:xsmall{left:var(--lns-space-xsmall)}.xs-left\:small{left:var(--lns-space-small)}.xs-left\:medium{left:var(--lns-space-medium)}.xs-left\:large{left:var(--lns-space-large)}.xs-left\:xlarge{left:var(--lns-space-xlarge)}.xs-left\:xxlarge{left:var(--lns-space-xxlarge)}.xs-right\:0{right:0}.xs-right\:auto{right:auto}.xs-right\:xsmall{right:var(--lns-space-xsmall)}.xs-right\:small{right:var(--lns-space-small)}.xs-right\:medium{right:var(--lns-space-medium)}.xs-right\:large{right:var(--lns-space-large)}.xs-right\:xlarge{right:var(--lns-space-xlarge)}.xs-right\:xxlarge{right:var(--lns-space-xxlarge)}.xs-width\:auto{width:auto}.xs-width\:full{width:100%}.xs-width\:0{width:0}.xs-minWidth\:0{min-width:0}.xs-height\:auto{height:auto}.xs-height\:full{height:100%}.xs-height\:0{height:0}.xs-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.xs-srOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}}@media(min-width:48em){.sm-c\:red{color:var(--lns-color-red)}.sm-c\:blurpleLight{color:var(--lns-color-blurpleLight)}.sm-c\:blurpleMedium{color:var(--lns-color-blurpleMedium)}.sm-c\:blurple{color:var(--lns-color-blurple)}.sm-c\:blurpleDark{color:var(--lns-color-blurpleDark)}.sm-c\:offWhite{color:var(--lns-color-offWhite)}.sm-c\:blueLight{color:var(--lns-color-blueLight)}.sm-c\:blue{color:var(--lns-color-blue)}.sm-c\:blueDark{color:var(--lns-color-blueDark)}.sm-c\:orangeLight{color:var(--lns-color-orangeLight)}.sm-c\:orange{color:var(--lns-color-orange)}.sm-c\:orangeDark{color:var(--lns-color-orangeDark)}.sm-c\:tealLight{color:var(--lns-color-tealLight)}.sm-c\:teal{color:var(--lns-color-teal)}.sm-c\:tealDark{color:var(--lns-color-tealDark)}.sm-c\:yellowLight{color:var(--lns-color-yellowLight)}.sm-c\:yellow{color:var(--lns-color-yellow)}.sm-c\:yellowDark{color:var(--lns-color-yellowDark)}.sm-c\:grey8{color:var(--lns-color-grey8)}.sm-c\:grey7{color:var(--lns-color-grey7)}.sm-c\:grey6{color:var(--lns-color-grey6)}.sm-c\:grey5{color:var(--lns-color-grey5)}.sm-c\:grey4{color:var(--lns-color-grey4)}.sm-c\:grey3{color:var(--lns-color-grey3)}.sm-c\:grey2{color:var(--lns-color-grey2)}.sm-c\:grey1{color:var(--lns-color-grey1)}.sm-c\:white{color:var(--lns-color-white)}.sm-c\:primary{color:var(--lns-color-primary)}.sm-c\:primaryHover{color:var(--lns-color-primaryHover)}.sm-c\:primaryActive{color:var(--lns-color-primaryActive)}.sm-c\:body{color:var(--lns-color-body)}.sm-c\:bodyDimmed{color:var(--lns-color-bodyDimmed)}.sm-c\:background{color:var(--lns-color-background)}.sm-c\:backgroundHover{color:var(--lns-color-backgroundHover)}.sm-c\:backgroundActive{color:var(--lns-color-backgroundActive)}.sm-c\:backgroundSecondary{color:var(--lns-color-backgroundSecondary)}.sm-c\:backgroundSecondary2{color:var(--lns-color-backgroundSecondary2)}.sm-c\:overlay{color:var(--lns-color-overlay)}.sm-c\:border{color:var(--lns-color-border)}.sm-c\:focusRing{color:var(--lns-color-focusRing)}.sm-c\:record{color:var(--lns-color-record)}.sm-c\:recordHover{color:var(--lns-color-recordHover)}.sm-c\:recordActive{color:var(--lns-color-recordActive)}.sm-c\:info{color:var(--lns-color-info)}.sm-c\:success{color:var(--lns-color-success)}.sm-c\:warning{color:var(--lns-color-warning)}.sm-c\:danger{color:var(--lns-color-danger)}.sm-c\:dangerHover{color:var(--lns-color-dangerHover)}.sm-c\:dangerActive{color:var(--lns-color-dangerActive)}.sm-c\:backdrop{color:var(--lns-color-backdrop)}.sm-c\:backdropDark{color:var(--lns-color-backdropDark)}.sm-c\:backdropTwilight{color:var(--lns-color-backdropTwilight)}.sm-c\:disabledContent{color:var(--lns-color-disabledContent)}.sm-c\:highlight{color:var(--lns-color-highlight)}.sm-c\:disabledBackground{color:var(--lns-color-disabledBackground)}.sm-c\:formFieldBorder{color:var(--lns-color-formFieldBorder)}.sm-c\:formFieldBackground{color:var(--lns-color-formFieldBackground)}.sm-c\:buttonBorder{color:var(--lns-color-buttonBorder)}.sm-c\:upgrade{color:var(--lns-color-upgrade)}.sm-c\:upgradeHover{color:var(--lns-color-upgradeHover)}.sm-c\:upgradeActive{color:var(--lns-color-upgradeActive)}.sm-c\:tabBackground{color:var(--lns-color-tabBackground)}.sm-c\:discoveryBackground{color:var(--lns-color-discoveryBackground)}.sm-c\:discoveryLightBackground{color:var(--lns-color-discoveryLightBackground)}.sm-c\:discoveryTitle{color:var(--lns-color-discoveryTitle)}.sm-c\:discoveryHighlight{color:var(--lns-color-discoveryHighlight)}.sm-shadow\:small{box-shadow:var(--lns-shadow-small)}.sm-shadow\:medium{box-shadow:var(--lns-shadow-medium)}.sm-shadow\:large{box-shadow:var(--lns-shadow-large)}.sm-radius\:medium{border-radius:var(--lns-radius-medium)}.sm-radius\:large{border-radius:var(--lns-radius-large)}.sm-radius\:xlarge{border-radius:var(--lns-radius-xlarge)}.sm-radius\:full{border-radius:var(--lns-radius-full)}.sm-bgc\:red{background-color:var(--lns-color-red)}.sm-bgc\:blurpleLight{background-color:var(--lns-color-blurpleLight)}.sm-bgc\:blurpleMedium{background-color:var(--lns-color-blurpleMedium)}.sm-bgc\:blurple{background-color:var(--lns-color-blurple)}.sm-bgc\:blurpleDark{background-color:var(--lns-color-blurpleDark)}.sm-bgc\:offWhite{background-color:var(--lns-color-offWhite)}.sm-bgc\:blueLight{background-color:var(--lns-color-blueLight)}.sm-bgc\:blue{background-color:var(--lns-color-blue)}.sm-bgc\:blueDark{background-color:var(--lns-color-blueDark)}.sm-bgc\:orangeLight{background-color:var(--lns-color-orangeLight)}.sm-bgc\:orange{background-color:var(--lns-color-orange)}.sm-bgc\:orangeDark{background-color:var(--lns-color-orangeDark)}.sm-bgc\:tealLight{background-color:var(--lns-color-tealLight)}.sm-bgc\:teal{background-color:var(--lns-color-teal)}.sm-bgc\:tealDark{background-color:var(--lns-color-tealDark)}.sm-bgc\:yellowLight{background-color:var(--lns-color-yellowLight)}.sm-bgc\:yellow{background-color:var(--lns-color-yellow)}.sm-bgc\:yellowDark{background-color:var(--lns-color-yellowDark)}.sm-bgc\:grey8{background-color:var(--lns-color-grey8)}.sm-bgc\:grey7{background-color:var(--lns-color-grey7)}.sm-bgc\:grey6{background-color:var(--lns-color-grey6)}.sm-bgc\:grey5{background-color:var(--lns-color-grey5)}.sm-bgc\:grey4{background-color:var(--lns-color-grey4)}.sm-bgc\:grey3{background-color:var(--lns-color-grey3)}.sm-bgc\:grey2{background-color:var(--lns-color-grey2)}.sm-bgc\:grey1{background-color:var(--lns-color-grey1)}.sm-bgc\:white{background-color:var(--lns-color-white)}.sm-bgc\:primary{background-color:var(--lns-color-primary)}.sm-bgc\:primaryHover{background-color:var(--lns-color-primaryHover)}.sm-bgc\:primaryActive{background-color:var(--lns-color-primaryActive)}.sm-bgc\:body{background-color:var(--lns-color-body)}.sm-bgc\:bodyDimmed{background-color:var(--lns-color-bodyDimmed)}.sm-bgc\:background{background-color:var(--lns-color-background)}.sm-bgc\:backgroundHover{background-color:var(--lns-color-backgroundHover)}.sm-bgc\:backgroundActive{background-color:var(--lns-color-backgroundActive)}.sm-bgc\:backgroundSecondary{background-color:var(--lns-color-backgroundSecondary)}.sm-bgc\:backgroundSecondary2{background-color:var(--lns-color-backgroundSecondary2)}.sm-bgc\:overlay{background-color:var(--lns-color-overlay)}.sm-bgc\:border{background-color:var(--lns-color-border)}.sm-bgc\:focusRing{background-color:var(--lns-color-focusRing)}.sm-bgc\:record{background-color:var(--lns-color-record)}.sm-bgc\:recordHover{background-color:var(--lns-color-recordHover)}.sm-bgc\:recordActive{background-color:var(--lns-color-recordActive)}.sm-bgc\:info{background-color:var(--lns-color-info)}.sm-bgc\:success{background-color:var(--lns-color-success)}.sm-bgc\:warning{background-color:var(--lns-color-warning)}.sm-bgc\:danger{background-color:var(--lns-color-danger)}.sm-bgc\:dangerHover{background-color:var(--lns-color-dangerHover)}.sm-bgc\:dangerActive{background-color:var(--lns-color-dangerActive)}.sm-bgc\:backdrop{background-color:var(--lns-color-backdrop)}.sm-bgc\:backdropDark{background-color:var(--lns-color-backdropDark)}.sm-bgc\:backdropTwilight{background-color:var(--lns-color-backdropTwilight)}.sm-bgc\:disabledContent{background-color:var(--lns-color-disabledContent)}.sm-bgc\:highlight{background-color:var(--lns-color-highlight)}.sm-bgc\:disabledBackground{background-color:var(--lns-color-disabledBackground)}.sm-bgc\:formFieldBorder{background-color:var(--lns-color-formFieldBorder)}.sm-bgc\:formFieldBackground{background-color:var(--lns-color-formFieldBackground)}.sm-bgc\:buttonBorder{background-color:var(--lns-color-buttonBorder)}.sm-bgc\:upgrade{background-color:var(--lns-color-upgrade)}.sm-bgc\:upgradeHover{background-color:var(--lns-color-upgradeHover)}.sm-bgc\:upgradeActive{background-color:var(--lns-color-upgradeActive)}.sm-bgc\:tabBackground{background-color:var(--lns-color-tabBackground)}.sm-bgc\:discoveryBackground{background-color:var(--lns-color-discoveryBackground)}.sm-bgc\:discoveryLightBackground{background-color:var(--lns-color-discoveryLightBackground)}.sm-bgc\:discoveryTitle{background-color:var(--lns-color-discoveryTitle)}.sm-bgc\:discoveryHighlight{background-color:var(--lns-color-discoveryHighlight)}.sm-m\:0{margin:0}.sm-m\:auto{margin:auto}.sm-m\:xsmall{margin:var(--lns-space-xsmall)}.sm-m\:small{margin:var(--lns-space-small)}.sm-m\:medium{margin:var(--lns-space-medium)}.sm-m\:large{margin:var(--lns-space-large)}.sm-m\:xlarge{margin:var(--lns-space-xlarge)}.sm-m\:xxlarge{margin:var(--lns-space-xxlarge)}.sm-mt\:0{margin-top:0}.sm-mt\:auto{margin-top:auto}.sm-mt\:xsmall{margin-top:var(--lns-space-xsmall)}.sm-mt\:small{margin-top:var(--lns-space-small)}.sm-mt\:medium{margin-top:var(--lns-space-medium)}.sm-mt\:large{margin-top:var(--lns-space-large)}.sm-mt\:xlarge{margin-top:var(--lns-space-xlarge)}.sm-mt\:xxlarge{margin-top:var(--lns-space-xxlarge)}.sm-mb\:0{margin-bottom:0}.sm-mb\:auto{margin-bottom:auto}.sm-mb\:xsmall{margin-bottom:var(--lns-space-xsmall)}.sm-mb\:small{margin-bottom:var(--lns-space-small)}.sm-mb\:medium{margin-bottom:var(--lns-space-medium)}.sm-mb\:large{margin-bottom:var(--lns-space-large)}.sm-mb\:xlarge{margin-bottom:var(--lns-space-xlarge)}.sm-mb\:xxlarge{margin-bottom:var(--lns-space-xxlarge)}.sm-ml\:0{margin-left:0}.sm-ml\:auto{margin-left:auto}.sm-ml\:xsmall{margin-left:var(--lns-space-xsmall)}.sm-ml\:small{margin-left:var(--lns-space-small)}.sm-ml\:medium{margin-left:var(--lns-space-medium)}.sm-ml\:large{margin-left:var(--lns-space-large)}.sm-ml\:xlarge{margin-left:var(--lns-space-xlarge)}.sm-ml\:xxlarge{margin-left:var(--lns-space-xxlarge)}.sm-mr\:0{margin-right:0}.sm-mr\:auto{margin-right:auto}.sm-mr\:xsmall{margin-right:var(--lns-space-xsmall)}.sm-mr\:small{margin-right:var(--lns-space-small)}.sm-mr\:medium{margin-right:var(--lns-space-medium)}.sm-mr\:large{margin-right:var(--lns-space-large)}.sm-mr\:xlarge{margin-right:var(--lns-space-xlarge)}.sm-mr\:xxlarge{margin-right:var(--lns-space-xxlarge)}.sm-mx\:0{margin-left:0;margin-right:0}.sm-mx\:auto{margin-left:auto;margin-right:auto}.sm-mx\:xsmall{margin-left:var(--lns-space-xsmall);margin-right:var(--lns-space-xsmall)}.sm-mx\:small{margin-left:var(--lns-space-small);margin-right:var(--lns-space-small)}.sm-mx\:medium{margin-left:var(--lns-space-medium);margin-right:var(--lns-space-medium)}.sm-mx\:large{margin-left:var(--lns-space-large);margin-right:var(--lns-space-large)}.sm-mx\:xlarge{margin-left:var(--lns-space-xlarge);margin-right:var(--lns-space-xlarge)}.sm-mx\:xxlarge{margin-left:var(--lns-space-xxlarge);margin-right:var(--lns-space-xxlarge)}.sm-my\:0{margin-top:0;margin-bottom:0}.sm-my\:auto{margin-top:auto;margin-bottom:auto}.sm-my\:xsmall{margin-top:var(--lns-space-xsmall);margin-bottom:var(--lns-space-xsmall)}.sm-my\:small{margin-top:var(--lns-space-small);margin-bottom:var(--lns-space-small)}.sm-my\:medium{margin-top:var(--lns-space-medium);margin-bottom:var(--lns-space-medium)}.sm-my\:large{margin-top:var(--lns-space-large);margin-bottom:var(--lns-space-large)}.sm-my\:xlarge{margin-top:var(--lns-space-xlarge);margin-bottom:var(--lns-space-xlarge)}.sm-my\:xxlarge{margin-top:var(--lns-space-xxlarge);margin-bottom:var(--lns-space-xxlarge)}.sm-p\:0{padding:0}.sm-p\:xsmall{padding:var(--lns-space-xsmall)}.sm-p\:small{padding:var(--lns-space-small)}.sm-p\:medium{padding:var(--lns-space-medium)}.sm-p\:large{padding:var(--lns-space-large)}.sm-p\:xlarge{padding:var(--lns-space-xlarge)}.sm-p\:xxlarge{padding:var(--lns-space-xxlarge)}.sm-pt\:0{padding-top:0}.sm-pt\:xsmall{padding-top:var(--lns-space-xsmall)}.sm-pt\:small{padding-top:var(--lns-space-small)}.sm-pt\:medium{padding-top:var(--lns-space-medium)}.sm-pt\:large{padding-top:var(--lns-space-large)}.sm-pt\:xlarge{padding-top:var(--lns-space-xlarge)}.sm-pt\:xxlarge{padding-top:var(--lns-space-xxlarge)}.sm-pb\:0{padding-bottom:0}.sm-pb\:xsmall{padding-bottom:var(--lns-space-xsmall)}.sm-pb\:small{padding-bottom:var(--lns-space-small)}.sm-pb\:medium{padding-bottom:var(--lns-space-medium)}.sm-pb\:large{padding-bottom:var(--lns-space-large)}.sm-pb\:xlarge{padding-bottom:var(--lns-space-xlarge)}.sm-pb\:xxlarge{padding-bottom:var(--lns-space-xxlarge)}.sm-pl\:0{padding-left:0}.sm-pl\:xsmall{padding-left:var(--lns-space-xsmall)}.sm-pl\:small{padding-left:var(--lns-space-small)}.sm-pl\:medium{padding-left:var(--lns-space-medium)}.sm-pl\:large{padding-left:var(--lns-space-large)}.sm-pl\:xlarge{padding-left:var(--lns-space-xlarge)}.sm-pl\:xxlarge{padding-left:var(--lns-space-xxlarge)}.sm-pr\:0{padding-right:0}.sm-pr\:xsmall{padding-right:var(--lns-space-xsmall)}.sm-pr\:small{padding-right:var(--lns-space-small)}.sm-pr\:medium{padding-right:var(--lns-space-medium)}.sm-pr\:large{padding-right:var(--lns-space-large)}.sm-pr\:xlarge{padding-right:var(--lns-space-xlarge)}.sm-pr\:xxlarge{padding-right:var(--lns-space-xxlarge)}.sm-px\:0{padding-left:0;padding-right:0}.sm-px\:xsmall{padding-left:var(--lns-space-xsmall);padding-right:var(--lns-space-xsmall)}.sm-px\:small{padding-left:var(--lns-space-small);padding-right:var(--lns-space-small)}.sm-px\:medium{padding-left:var(--lns-space-medium);padding-right:var(--lns-space-medium)}.sm-px\:large{padding-left:var(--lns-space-large);padding-right:var(--lns-space-large)}.sm-px\:xlarge{padding-left:var(--lns-space-xlarge);padding-right:var(--lns-space-xlarge)}.sm-px\:xxlarge{padding-left:var(--lns-space-xxlarge);padding-right:var(--lns-space-xxlarge)}.sm-py\:0{padding-top:0;padding-bottom:0}.sm-py\:xsmall{padding-top:var(--lns-space-xsmall);padding-bottom:var(--lns-space-xsmall)}.sm-py\:small{padding-top:var(--lns-space-small);padding-bottom:var(--lns-space-small)}.sm-py\:medium{padding-top:var(--lns-space-medium);padding-bottom:var(--lns-space-medium)}.sm-py\:large{padding-top:var(--lns-space-large);padding-bottom:var(--lns-space-large)}.sm-py\:xlarge{padding-top:var(--lns-space-xlarge);padding-bottom:var(--lns-space-xlarge)}.sm-py\:xxlarge{padding-top:var(--lns-space-xxlarge);padding-bottom:var(--lns-space-xxlarge)}.sm-text\:small{font-size:var(--lns-fontSize-small);line-height:var(--lns-lineHeight-small)}.sm-text\:body-sm{font-size:var(--lns-fontSize-body-sm);line-height:var(--lns-lineHeight-body-sm)}.sm-text\:medium{font-size:var(--lns-fontSize-medium);line-height:var(--lns-lineHeight-medium)}.sm-text\:body-md{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md)}.sm-text\:large{font-size:var(--lns-fontSize-large);line-height:var(--lns-lineHeight-large)}.sm-text\:body-lg{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg)}.sm-text\:xlarge{font-size:var(--lns-fontSize-xlarge);line-height:var(--lns-lineHeight-xlarge)}.sm-text\:heading-sm{font-size:var(--lns-fontSize-heading-sm);line-height:var(--lns-lineHeight-heading-sm)}.sm-text\:xxlarge{font-size:var(--lns-fontSize-xxlarge);line-height:var(--lns-lineHeight-xxlarge)}.sm-text\:heading-md{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md)}.sm-text\:xxxlarge{font-size:var(--lns-fontSize-xxxlarge);line-height:var(--lns-lineHeight-xxxlarge)}.sm-text\:heading-lg{font-size:var(--lns-fontSize-heading-lg);line-height:var(--lns-lineHeight-heading-lg)}.sm-weight\:book{font-weight:var(--lns-fontWeight-book)}.sm-weight\:bold{font-weight:var(--lns-fontWeight-bold)}.sm-text\:body{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md);font-weight:var(--lns-fontWeight-book)}.sm-text\:title{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg);font-weight:var(--lns-fontWeight-bold)}.sm-text\:mainTitle{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md);font-weight:var(--lns-fontWeight-bold)}.sm-text\:left{text-align:left}.sm-text\:right{text-align:right}.sm-text\:center{text-align:center}.sm-border{border:1px solid var(--lns-color-border)}.sm-borderTop{border-top:1px solid var(--lns-color-border)}.sm-borderBottom{border-bottom:1px solid var(--lns-color-border)}.sm-borderLeft{border-left:1px solid var(--lns-color-border)}.sm-borderRight{border-right:1px solid var(--lns-color-border)}.sm-inline{display:inline}.sm-block{display:block}.sm-flex{display:flex}.sm-inlineBlock{display:inline-block}.sm-inlineFlex{display:inline-flex}.sm-none{display:none}.sm-flexWrap{flex-wrap:wrap}.sm-flexDirection\:column{flex-direction:column}.sm-flexDirection\:row{flex-direction:row}.sm-items\:stretch{align-items:stretch}.sm-items\:center{align-items:center}.sm-items\:baseline{align-items:baseline}.sm-items\:flexStart{align-items:flex-start}.sm-items\:flexEnd{align-items:flex-end}.sm-items\:selfStart{align-items:self-start}.sm-items\:selfEnd{align-items:self-end}.sm-justify\:flexStart{justify-content:flex-start}.sm-justify\:flexEnd{justify-content:flex-end}.sm-justify\:center{justify-content:center}.sm-justify\:spaceBetween{justify-content:space-between}.sm-justify\:spaceAround{justify-content:space-around}.sm-justify\:spaceEvenly{justify-content:space-evenly}.sm-grow\:0{flex-grow:0}.sm-grow\:1{flex-grow:1}.sm-shrink\:0{flex-shrink:0}.sm-shrink\:1{flex-shrink:1}.sm-self\:auto{align-self:auto}.sm-self\:flexStart{align-self:flex-start}.sm-self\:flexEnd{align-self:flex-end}.sm-self\:center{align-self:center}.sm-self\:baseline{align-self:baseline}.sm-self\:stretch{align-self:stretch}.sm-overflow\:hidden{overflow:hidden}.sm-overflow\:auto{overflow:auto}.sm-relative{position:relative}.sm-absolute{position:absolute}.sm-sticky{position:sticky}.sm-fixed{position:fixed}.sm-top\:0{top:0}.sm-top\:auto{top:auto}.sm-top\:xsmall{top:var(--lns-space-xsmall)}.sm-top\:small{top:var(--lns-space-small)}.sm-top\:medium{top:var(--lns-space-medium)}.sm-top\:large{top:var(--lns-space-large)}.sm-top\:xlarge{top:var(--lns-space-xlarge)}.sm-top\:xxlarge{top:var(--lns-space-xxlarge)}.sm-bottom\:0{bottom:0}.sm-bottom\:auto{bottom:auto}.sm-bottom\:xsmall{bottom:var(--lns-space-xsmall)}.sm-bottom\:small{bottom:var(--lns-space-small)}.sm-bottom\:medium{bottom:var(--lns-space-medium)}.sm-bottom\:large{bottom:var(--lns-space-large)}.sm-bottom\:xlarge{bottom:var(--lns-space-xlarge)}.sm-bottom\:xxlarge{bottom:var(--lns-space-xxlarge)}.sm-left\:0{left:0}.sm-left\:auto{left:auto}.sm-left\:xsmall{left:var(--lns-space-xsmall)}.sm-left\:small{left:var(--lns-space-small)}.sm-left\:medium{left:var(--lns-space-medium)}.sm-left\:large{left:var(--lns-space-large)}.sm-left\:xlarge{left:var(--lns-space-xlarge)}.sm-left\:xxlarge{left:var(--lns-space-xxlarge)}.sm-right\:0{right:0}.sm-right\:auto{right:auto}.sm-right\:xsmall{right:var(--lns-space-xsmall)}.sm-right\:small{right:var(--lns-space-small)}.sm-right\:medium{right:var(--lns-space-medium)}.sm-right\:large{right:var(--lns-space-large)}.sm-right\:xlarge{right:var(--lns-space-xlarge)}.sm-right\:xxlarge{right:var(--lns-space-xxlarge)}.sm-width\:auto{width:auto}.sm-width\:full{width:100%}.sm-width\:0{width:0}.sm-minWidth\:0{min-width:0}.sm-height\:auto{height:auto}.sm-height\:full{height:100%}.sm-height\:0{height:0}.sm-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sm-srOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}}@media(min-width:64em){.md-c\:red{color:var(--lns-color-red)}.md-c\:blurpleLight{color:var(--lns-color-blurpleLight)}.md-c\:blurpleMedium{color:var(--lns-color-blurpleMedium)}.md-c\:blurple{color:var(--lns-color-blurple)}.md-c\:blurpleDark{color:var(--lns-color-blurpleDark)}.md-c\:offWhite{color:var(--lns-color-offWhite)}.md-c\:blueLight{color:var(--lns-color-blueLight)}.md-c\:blue{color:var(--lns-color-blue)}.md-c\:blueDark{color:var(--lns-color-blueDark)}.md-c\:orangeLight{color:var(--lns-color-orangeLight)}.md-c\:orange{color:var(--lns-color-orange)}.md-c\:orangeDark{color:var(--lns-color-orangeDark)}.md-c\:tealLight{color:var(--lns-color-tealLight)}.md-c\:teal{color:var(--lns-color-teal)}.md-c\:tealDark{color:var(--lns-color-tealDark)}.md-c\:yellowLight{color:var(--lns-color-yellowLight)}.md-c\:yellow{color:var(--lns-color-yellow)}.md-c\:yellowDark{color:var(--lns-color-yellowDark)}.md-c\:grey8{color:var(--lns-color-grey8)}.md-c\:grey7{color:var(--lns-color-grey7)}.md-c\:grey6{color:var(--lns-color-grey6)}.md-c\:grey5{color:var(--lns-color-grey5)}.md-c\:grey4{color:var(--lns-color-grey4)}.md-c\:grey3{color:var(--lns-color-grey3)}.md-c\:grey2{color:var(--lns-color-grey2)}.md-c\:grey1{color:var(--lns-color-grey1)}.md-c\:white{color:var(--lns-color-white)}.md-c\:primary{color:var(--lns-color-primary)}.md-c\:primaryHover{color:var(--lns-color-primaryHover)}.md-c\:primaryActive{color:var(--lns-color-primaryActive)}.md-c\:body{color:var(--lns-color-body)}.md-c\:bodyDimmed{color:var(--lns-color-bodyDimmed)}.md-c\:background{color:var(--lns-color-background)}.md-c\:backgroundHover{color:var(--lns-color-backgroundHover)}.md-c\:backgroundActive{color:var(--lns-color-backgroundActive)}.md-c\:backgroundSecondary{color:var(--lns-color-backgroundSecondary)}.md-c\:backgroundSecondary2{color:var(--lns-color-backgroundSecondary2)}.md-c\:overlay{color:var(--lns-color-overlay)}.md-c\:border{color:var(--lns-color-border)}.md-c\:focusRing{color:var(--lns-color-focusRing)}.md-c\:record{color:var(--lns-color-record)}.md-c\:recordHover{color:var(--lns-color-recordHover)}.md-c\:recordActive{color:var(--lns-color-recordActive)}.md-c\:info{color:var(--lns-color-info)}.md-c\:success{color:var(--lns-color-success)}.md-c\:warning{color:var(--lns-color-warning)}.md-c\:danger{color:var(--lns-color-danger)}.md-c\:dangerHover{color:var(--lns-color-dangerHover)}.md-c\:dangerActive{color:var(--lns-color-dangerActive)}.md-c\:backdrop{color:var(--lns-color-backdrop)}.md-c\:backdropDark{color:var(--lns-color-backdropDark)}.md-c\:backdropTwilight{color:var(--lns-color-backdropTwilight)}.md-c\:disabledContent{color:var(--lns-color-disabledContent)}.md-c\:highlight{color:var(--lns-color-highlight)}.md-c\:disabledBackground{color:var(--lns-color-disabledBackground)}.md-c\:formFieldBorder{color:var(--lns-color-formFieldBorder)}.md-c\:formFieldBackground{color:var(--lns-color-formFieldBackground)}.md-c\:buttonBorder{color:var(--lns-color-buttonBorder)}.md-c\:upgrade{color:var(--lns-color-upgrade)}.md-c\:upgradeHover{color:var(--lns-color-upgradeHover)}.md-c\:upgradeActive{color:var(--lns-color-upgradeActive)}.md-c\:tabBackground{color:var(--lns-color-tabBackground)}.md-c\:discoveryBackground{color:var(--lns-color-discoveryBackground)}.md-c\:discoveryLightBackground{color:var(--lns-color-discoveryLightBackground)}.md-c\:discoveryTitle{color:var(--lns-color-discoveryTitle)}.md-c\:discoveryHighlight{color:var(--lns-color-discoveryHighlight)}.md-shadow\:small{box-shadow:var(--lns-shadow-small)}.md-shadow\:medium{box-shadow:var(--lns-shadow-medium)}.md-shadow\:large{box-shadow:var(--lns-shadow-large)}.md-radius\:medium{border-radius:var(--lns-radius-medium)}.md-radius\:large{border-radius:var(--lns-radius-large)}.md-radius\:xlarge{border-radius:var(--lns-radius-xlarge)}.md-radius\:full{border-radius:var(--lns-radius-full)}.md-bgc\:red{background-color:var(--lns-color-red)}.md-bgc\:blurpleLight{background-color:var(--lns-color-blurpleLight)}.md-bgc\:blurpleMedium{background-color:var(--lns-color-blurpleMedium)}.md-bgc\:blurple{background-color:var(--lns-color-blurple)}.md-bgc\:blurpleDark{background-color:var(--lns-color-blurpleDark)}.md-bgc\:offWhite{background-color:var(--lns-color-offWhite)}.md-bgc\:blueLight{background-color:var(--lns-color-blueLight)}.md-bgc\:blue{background-color:var(--lns-color-blue)}.md-bgc\:blueDark{background-color:var(--lns-color-blueDark)}.md-bgc\:orangeLight{background-color:var(--lns-color-orangeLight)}.md-bgc\:orange{background-color:var(--lns-color-orange)}.md-bgc\:orangeDark{background-color:var(--lns-color-orangeDark)}.md-bgc\:tealLight{background-color:var(--lns-color-tealLight)}.md-bgc\:teal{background-color:var(--lns-color-teal)}.md-bgc\:tealDark{background-color:var(--lns-color-tealDark)}.md-bgc\:yellowLight{background-color:var(--lns-color-yellowLight)}.md-bgc\:yellow{background-color:var(--lns-color-yellow)}.md-bgc\:yellowDark{background-color:var(--lns-color-yellowDark)}.md-bgc\:grey8{background-color:var(--lns-color-grey8)}.md-bgc\:grey7{background-color:var(--lns-color-grey7)}.md-bgc\:grey6{background-color:var(--lns-color-grey6)}.md-bgc\:grey5{background-color:var(--lns-color-grey5)}.md-bgc\:grey4{background-color:var(--lns-color-grey4)}.md-bgc\:grey3{background-color:var(--lns-color-grey3)}.md-bgc\:grey2{background-color:var(--lns-color-grey2)}.md-bgc\:grey1{background-color:var(--lns-color-grey1)}.md-bgc\:white{background-color:var(--lns-color-white)}.md-bgc\:primary{background-color:var(--lns-color-primary)}.md-bgc\:primaryHover{background-color:var(--lns-color-primaryHover)}.md-bgc\:primaryActive{background-color:var(--lns-color-primaryActive)}.md-bgc\:body{background-color:var(--lns-color-body)}.md-bgc\:bodyDimmed{background-color:var(--lns-color-bodyDimmed)}.md-bgc\:background{background-color:var(--lns-color-background)}.md-bgc\:backgroundHover{background-color:var(--lns-color-backgroundHover)}.md-bgc\:backgroundActive{background-color:var(--lns-color-backgroundActive)}.md-bgc\:backgroundSecondary{background-color:var(--lns-color-backgroundSecondary)}.md-bgc\:backgroundSecondary2{background-color:var(--lns-color-backgroundSecondary2)}.md-bgc\:overlay{background-color:var(--lns-color-overlay)}.md-bgc\:border{background-color:var(--lns-color-border)}.md-bgc\:focusRing{background-color:var(--lns-color-focusRing)}.md-bgc\:record{background-color:var(--lns-color-record)}.md-bgc\:recordHover{background-color:var(--lns-color-recordHover)}.md-bgc\:recordActive{background-color:var(--lns-color-recordActive)}.md-bgc\:info{background-color:var(--lns-color-info)}.md-bgc\:success{background-color:var(--lns-color-success)}.md-bgc\:warning{background-color:var(--lns-color-warning)}.md-bgc\:danger{background-color:var(--lns-color-danger)}.md-bgc\:dangerHover{background-color:var(--lns-color-dangerHover)}.md-bgc\:dangerActive{background-color:var(--lns-color-dangerActive)}.md-bgc\:backdrop{background-color:var(--lns-color-backdrop)}.md-bgc\:backdropDark{background-color:var(--lns-color-backdropDark)}.md-bgc\:backdropTwilight{background-color:var(--lns-color-backdropTwilight)}.md-bgc\:disabledContent{background-color:var(--lns-color-disabledContent)}.md-bgc\:highlight{background-color:var(--lns-color-highlight)}.md-bgc\:disabledBackground{background-color:var(--lns-color-disabledBackground)}.md-bgc\:formFieldBorder{background-color:var(--lns-color-formFieldBorder)}.md-bgc\:formFieldBackground{background-color:var(--lns-color-formFieldBackground)}.md-bgc\:buttonBorder{background-color:var(--lns-color-buttonBorder)}.md-bgc\:upgrade{background-color:var(--lns-color-upgrade)}.md-bgc\:upgradeHover{background-color:var(--lns-color-upgradeHover)}.md-bgc\:upgradeActive{background-color:var(--lns-color-upgradeActive)}.md-bgc\:tabBackground{background-color:var(--lns-color-tabBackground)}.md-bgc\:discoveryBackground{background-color:var(--lns-color-discoveryBackground)}.md-bgc\:discoveryLightBackground{background-color:var(--lns-color-discoveryLightBackground)}.md-bgc\:discoveryTitle{background-color:var(--lns-color-discoveryTitle)}.md-bgc\:discoveryHighlight{background-color:var(--lns-color-discoveryHighlight)}.md-m\:0{margin:0}.md-m\:auto{margin:auto}.md-m\:xsmall{margin:var(--lns-space-xsmall)}.md-m\:small{margin:var(--lns-space-small)}.md-m\:medium{margin:var(--lns-space-medium)}.md-m\:large{margin:var(--lns-space-large)}.md-m\:xlarge{margin:var(--lns-space-xlarge)}.md-m\:xxlarge{margin:var(--lns-space-xxlarge)}.md-mt\:0{margin-top:0}.md-mt\:auto{margin-top:auto}.md-mt\:xsmall{margin-top:var(--lns-space-xsmall)}.md-mt\:small{margin-top:var(--lns-space-small)}.md-mt\:medium{margin-top:var(--lns-space-medium)}.md-mt\:large{margin-top:var(--lns-space-large)}.md-mt\:xlarge{margin-top:var(--lns-space-xlarge)}.md-mt\:xxlarge{margin-top:var(--lns-space-xxlarge)}.md-mb\:0{margin-bottom:0}.md-mb\:auto{margin-bottom:auto}.md-mb\:xsmall{margin-bottom:var(--lns-space-xsmall)}.md-mb\:small{margin-bottom:var(--lns-space-small)}.md-mb\:medium{margin-bottom:var(--lns-space-medium)}.md-mb\:large{margin-bottom:var(--lns-space-large)}.md-mb\:xlarge{margin-bottom:var(--lns-space-xlarge)}.md-mb\:xxlarge{margin-bottom:var(--lns-space-xxlarge)}.md-ml\:0{margin-left:0}.md-ml\:auto{margin-left:auto}.md-ml\:xsmall{margin-left:var(--lns-space-xsmall)}.md-ml\:small{margin-left:var(--lns-space-small)}.md-ml\:medium{margin-left:var(--lns-space-medium)}.md-ml\:large{margin-left:var(--lns-space-large)}.md-ml\:xlarge{margin-left:var(--lns-space-xlarge)}.md-ml\:xxlarge{margin-left:var(--lns-space-xxlarge)}.md-mr\:0{margin-right:0}.md-mr\:auto{margin-right:auto}.md-mr\:xsmall{margin-right:var(--lns-space-xsmall)}.md-mr\:small{margin-right:var(--lns-space-small)}.md-mr\:medium{margin-right:var(--lns-space-medium)}.md-mr\:large{margin-right:var(--lns-space-large)}.md-mr\:xlarge{margin-right:var(--lns-space-xlarge)}.md-mr\:xxlarge{margin-right:var(--lns-space-xxlarge)}.md-mx\:0{margin-left:0;margin-right:0}.md-mx\:auto{margin-left:auto;margin-right:auto}.md-mx\:xsmall{margin-left:var(--lns-space-xsmall);margin-right:var(--lns-space-xsmall)}.md-mx\:small{margin-left:var(--lns-space-small);margin-right:var(--lns-space-small)}.md-mx\:medium{margin-left:var(--lns-space-medium);margin-right:var(--lns-space-medium)}.md-mx\:large{margin-left:var(--lns-space-large);margin-right:var(--lns-space-large)}.md-mx\:xlarge{margin-left:var(--lns-space-xlarge);margin-right:var(--lns-space-xlarge)}.md-mx\:xxlarge{margin-left:var(--lns-space-xxlarge);margin-right:var(--lns-space-xxlarge)}.md-my\:0{margin-top:0;margin-bottom:0}.md-my\:auto{margin-top:auto;margin-bottom:auto}.md-my\:xsmall{margin-top:var(--lns-space-xsmall);margin-bottom:var(--lns-space-xsmall)}.md-my\:small{margin-top:var(--lns-space-small);margin-bottom:var(--lns-space-small)}.md-my\:medium{margin-top:var(--lns-space-medium);margin-bottom:var(--lns-space-medium)}.md-my\:large{margin-top:var(--lns-space-large);margin-bottom:var(--lns-space-large)}.md-my\:xlarge{margin-top:var(--lns-space-xlarge);margin-bottom:var(--lns-space-xlarge)}.md-my\:xxlarge{margin-top:var(--lns-space-xxlarge);margin-bottom:var(--lns-space-xxlarge)}.md-p\:0{padding:0}.md-p\:xsmall{padding:var(--lns-space-xsmall)}.md-p\:small{padding:var(--lns-space-small)}.md-p\:medium{padding:var(--lns-space-medium)}.md-p\:large{padding:var(--lns-space-large)}.md-p\:xlarge{padding:var(--lns-space-xlarge)}.md-p\:xxlarge{padding:var(--lns-space-xxlarge)}.md-pt\:0{padding-top:0}.md-pt\:xsmall{padding-top:var(--lns-space-xsmall)}.md-pt\:small{padding-top:var(--lns-space-small)}.md-pt\:medium{padding-top:var(--lns-space-medium)}.md-pt\:large{padding-top:var(--lns-space-large)}.md-pt\:xlarge{padding-top:var(--lns-space-xlarge)}.md-pt\:xxlarge{padding-top:var(--lns-space-xxlarge)}.md-pb\:0{padding-bottom:0}.md-pb\:xsmall{padding-bottom:var(--lns-space-xsmall)}.md-pb\:small{padding-bottom:var(--lns-space-small)}.md-pb\:medium{padding-bottom:var(--lns-space-medium)}.md-pb\:large{padding-bottom:var(--lns-space-large)}.md-pb\:xlarge{padding-bottom:var(--lns-space-xlarge)}.md-pb\:xxlarge{padding-bottom:var(--lns-space-xxlarge)}.md-pl\:0{padding-left:0}.md-pl\:xsmall{padding-left:var(--lns-space-xsmall)}.md-pl\:small{padding-left:var(--lns-space-small)}.md-pl\:medium{padding-left:var(--lns-space-medium)}.md-pl\:large{padding-left:var(--lns-space-large)}.md-pl\:xlarge{padding-left:var(--lns-space-xlarge)}.md-pl\:xxlarge{padding-left:var(--lns-space-xxlarge)}.md-pr\:0{padding-right:0}.md-pr\:xsmall{padding-right:var(--lns-space-xsmall)}.md-pr\:small{padding-right:var(--lns-space-small)}.md-pr\:medium{padding-right:var(--lns-space-medium)}.md-pr\:large{padding-right:var(--lns-space-large)}.md-pr\:xlarge{padding-right:var(--lns-space-xlarge)}.md-pr\:xxlarge{padding-right:var(--lns-space-xxlarge)}.md-px\:0{padding-left:0;padding-right:0}.md-px\:xsmall{padding-left:var(--lns-space-xsmall);padding-right:var(--lns-space-xsmall)}.md-px\:small{padding-left:var(--lns-space-small);padding-right:var(--lns-space-small)}.md-px\:medium{padding-left:var(--lns-space-medium);padding-right:var(--lns-space-medium)}.md-px\:large{padding-left:var(--lns-space-large);padding-right:var(--lns-space-large)}.md-px\:xlarge{padding-left:var(--lns-space-xlarge);padding-right:var(--lns-space-xlarge)}.md-px\:xxlarge{padding-left:var(--lns-space-xxlarge);padding-right:var(--lns-space-xxlarge)}.md-py\:0{padding-top:0;padding-bottom:0}.md-py\:xsmall{padding-top:var(--lns-space-xsmall);padding-bottom:var(--lns-space-xsmall)}.md-py\:small{padding-top:var(--lns-space-small);padding-bottom:var(--lns-space-small)}.md-py\:medium{padding-top:var(--lns-space-medium);padding-bottom:var(--lns-space-medium)}.md-py\:large{padding-top:var(--lns-space-large);padding-bottom:var(--lns-space-large)}.md-py\:xlarge{padding-top:var(--lns-space-xlarge);padding-bottom:var(--lns-space-xlarge)}.md-py\:xxlarge{padding-top:var(--lns-space-xxlarge);padding-bottom:var(--lns-space-xxlarge)}.md-text\:small{font-size:var(--lns-fontSize-small);line-height:var(--lns-lineHeight-small)}.md-text\:body-sm{font-size:var(--lns-fontSize-body-sm);line-height:var(--lns-lineHeight-body-sm)}.md-text\:medium{font-size:var(--lns-fontSize-medium);line-height:var(--lns-lineHeight-medium)}.md-text\:body-md{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md)}.md-text\:large{font-size:var(--lns-fontSize-large);line-height:var(--lns-lineHeight-large)}.md-text\:body-lg{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg)}.md-text\:xlarge{font-size:var(--lns-fontSize-xlarge);line-height:var(--lns-lineHeight-xlarge)}.md-text\:heading-sm{font-size:var(--lns-fontSize-heading-sm);line-height:var(--lns-lineHeight-heading-sm)}.md-text\:xxlarge{font-size:var(--lns-fontSize-xxlarge);line-height:var(--lns-lineHeight-xxlarge)}.md-text\:heading-md{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md)}.md-text\:xxxlarge{font-size:var(--lns-fontSize-xxxlarge);line-height:var(--lns-lineHeight-xxxlarge)}.md-text\:heading-lg{font-size:var(--lns-fontSize-heading-lg);line-height:var(--lns-lineHeight-heading-lg)}.md-weight\:book{font-weight:var(--lns-fontWeight-book)}.md-weight\:bold{font-weight:var(--lns-fontWeight-bold)}.md-text\:body{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md);font-weight:var(--lns-fontWeight-book)}.md-text\:title{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg);font-weight:var(--lns-fontWeight-bold)}.md-text\:mainTitle{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md);font-weight:var(--lns-fontWeight-bold)}.md-text\:left{text-align:left}.md-text\:right{text-align:right}.md-text\:center{text-align:center}.md-border{border:1px solid var(--lns-color-border)}.md-borderTop{border-top:1px solid var(--lns-color-border)}.md-borderBottom{border-bottom:1px solid var(--lns-color-border)}.md-borderLeft{border-left:1px solid var(--lns-color-border)}.md-borderRight{border-right:1px solid var(--lns-color-border)}.md-inline{display:inline}.md-block{display:block}.md-flex{display:flex}.md-inlineBlock{display:inline-block}.md-inlineFlex{display:inline-flex}.md-none{display:none}.md-flexWrap{flex-wrap:wrap}.md-flexDirection\:column{flex-direction:column}.md-flexDirection\:row{flex-direction:row}.md-items\:stretch{align-items:stretch}.md-items\:center{align-items:center}.md-items\:baseline{align-items:baseline}.md-items\:flexStart{align-items:flex-start}.md-items\:flexEnd{align-items:flex-end}.md-items\:selfStart{align-items:self-start}.md-items\:selfEnd{align-items:self-end}.md-justify\:flexStart{justify-content:flex-start}.md-justify\:flexEnd{justify-content:flex-end}.md-justify\:center{justify-content:center}.md-justify\:spaceBetween{justify-content:space-between}.md-justify\:spaceAround{justify-content:space-around}.md-justify\:spaceEvenly{justify-content:space-evenly}.md-grow\:0{flex-grow:0}.md-grow\:1{flex-grow:1}.md-shrink\:0{flex-shrink:0}.md-shrink\:1{flex-shrink:1}.md-self\:auto{align-self:auto}.md-self\:flexStart{align-self:flex-start}.md-self\:flexEnd{align-self:flex-end}.md-self\:center{align-self:center}.md-self\:baseline{align-self:baseline}.md-self\:stretch{align-self:stretch}.md-overflow\:hidden{overflow:hidden}.md-overflow\:auto{overflow:auto}.md-relative{position:relative}.md-absolute{position:absolute}.md-sticky{position:sticky}.md-fixed{position:fixed}.md-top\:0{top:0}.md-top\:auto{top:auto}.md-top\:xsmall{top:var(--lns-space-xsmall)}.md-top\:small{top:var(--lns-space-small)}.md-top\:medium{top:var(--lns-space-medium)}.md-top\:large{top:var(--lns-space-large)}.md-top\:xlarge{top:var(--lns-space-xlarge)}.md-top\:xxlarge{top:var(--lns-space-xxlarge)}.md-bottom\:0{bottom:0}.md-bottom\:auto{bottom:auto}.md-bottom\:xsmall{bottom:var(--lns-space-xsmall)}.md-bottom\:small{bottom:var(--lns-space-small)}.md-bottom\:medium{bottom:var(--lns-space-medium)}.md-bottom\:large{bottom:var(--lns-space-large)}.md-bottom\:xlarge{bottom:var(--lns-space-xlarge)}.md-bottom\:xxlarge{bottom:var(--lns-space-xxlarge)}.md-left\:0{left:0}.md-left\:auto{left:auto}.md-left\:xsmall{left:var(--lns-space-xsmall)}.md-left\:small{left:var(--lns-space-small)}.md-left\:medium{left:var(--lns-space-medium)}.md-left\:large{left:var(--lns-space-large)}.md-left\:xlarge{left:var(--lns-space-xlarge)}.md-left\:xxlarge{left:var(--lns-space-xxlarge)}.md-right\:0{right:0}.md-right\:auto{right:auto}.md-right\:xsmall{right:var(--lns-space-xsmall)}.md-right\:small{right:var(--lns-space-small)}.md-right\:medium{right:var(--lns-space-medium)}.md-right\:large{right:var(--lns-space-large)}.md-right\:xlarge{right:var(--lns-space-xlarge)}.md-right\:xxlarge{right:var(--lns-space-xxlarge)}.md-width\:auto{width:auto}.md-width\:full{width:100%}.md-width\:0{width:0}.md-minWidth\:0{min-width:0}.md-height\:auto{height:auto}.md-height\:full{height:100%}.md-height\:0{height:0}.md-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.md-srOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}}@media(min-width:75em){.lg-c\:red{color:var(--lns-color-red)}.lg-c\:blurpleLight{color:var(--lns-color-blurpleLight)}.lg-c\:blurpleMedium{color:var(--lns-color-blurpleMedium)}.lg-c\:blurple{color:var(--lns-color-blurple)}.lg-c\:blurpleDark{color:var(--lns-color-blurpleDark)}.lg-c\:offWhite{color:var(--lns-color-offWhite)}.lg-c\:blueLight{color:var(--lns-color-blueLight)}.lg-c\:blue{color:var(--lns-color-blue)}.lg-c\:blueDark{color:var(--lns-color-blueDark)}.lg-c\:orangeLight{color:var(--lns-color-orangeLight)}.lg-c\:orange{color:var(--lns-color-orange)}.lg-c\:orangeDark{color:var(--lns-color-orangeDark)}.lg-c\:tealLight{color:var(--lns-color-tealLight)}.lg-c\:teal{color:var(--lns-color-teal)}.lg-c\:tealDark{color:var(--lns-color-tealDark)}.lg-c\:yellowLight{color:var(--lns-color-yellowLight)}.lg-c\:yellow{color:var(--lns-color-yellow)}.lg-c\:yellowDark{color:var(--lns-color-yellowDark)}.lg-c\:grey8{color:var(--lns-color-grey8)}.lg-c\:grey7{color:var(--lns-color-grey7)}.lg-c\:grey6{color:var(--lns-color-grey6)}.lg-c\:grey5{color:var(--lns-color-grey5)}.lg-c\:grey4{color:var(--lns-color-grey4)}.lg-c\:grey3{color:var(--lns-color-grey3)}.lg-c\:grey2{color:var(--lns-color-grey2)}.lg-c\:grey1{color:var(--lns-color-grey1)}.lg-c\:white{color:var(--lns-color-white)}.lg-c\:primary{color:var(--lns-color-primary)}.lg-c\:primaryHover{color:var(--lns-color-primaryHover)}.lg-c\:primaryActive{color:var(--lns-color-primaryActive)}.lg-c\:body{color:var(--lns-color-body)}.lg-c\:bodyDimmed{color:var(--lns-color-bodyDimmed)}.lg-c\:background{color:var(--lns-color-background)}.lg-c\:backgroundHover{color:var(--lns-color-backgroundHover)}.lg-c\:backgroundActive{color:var(--lns-color-backgroundActive)}.lg-c\:backgroundSecondary{color:var(--lns-color-backgroundSecondary)}.lg-c\:backgroundSecondary2{color:var(--lns-color-backgroundSecondary2)}.lg-c\:overlay{color:var(--lns-color-overlay)}.lg-c\:border{color:var(--lns-color-border)}.lg-c\:focusRing{color:var(--lns-color-focusRing)}.lg-c\:record{color:var(--lns-color-record)}.lg-c\:recordHover{color:var(--lns-color-recordHover)}.lg-c\:recordActive{color:var(--lns-color-recordActive)}.lg-c\:info{color:var(--lns-color-info)}.lg-c\:success{color:var(--lns-color-success)}.lg-c\:warning{color:var(--lns-color-warning)}.lg-c\:danger{color:var(--lns-color-danger)}.lg-c\:dangerHover{color:var(--lns-color-dangerHover)}.lg-c\:dangerActive{color:var(--lns-color-dangerActive)}.lg-c\:backdrop{color:var(--lns-color-backdrop)}.lg-c\:backdropDark{color:var(--lns-color-backdropDark)}.lg-c\:backdropTwilight{color:var(--lns-color-backdropTwilight)}.lg-c\:disabledContent{color:var(--lns-color-disabledContent)}.lg-c\:highlight{color:var(--lns-color-highlight)}.lg-c\:disabledBackground{color:var(--lns-color-disabledBackground)}.lg-c\:formFieldBorder{color:var(--lns-color-formFieldBorder)}.lg-c\:formFieldBackground{color:var(--lns-color-formFieldBackground)}.lg-c\:buttonBorder{color:var(--lns-color-buttonBorder)}.lg-c\:upgrade{color:var(--lns-color-upgrade)}.lg-c\:upgradeHover{color:var(--lns-color-upgradeHover)}.lg-c\:upgradeActive{color:var(--lns-color-upgradeActive)}.lg-c\:tabBackground{color:var(--lns-color-tabBackground)}.lg-c\:discoveryBackground{color:var(--lns-color-discoveryBackground)}.lg-c\:discoveryLightBackground{color:var(--lns-color-discoveryLightBackground)}.lg-c\:discoveryTitle{color:var(--lns-color-discoveryTitle)}.lg-c\:discoveryHighlight{color:var(--lns-color-discoveryHighlight)}.lg-shadow\:small{box-shadow:var(--lns-shadow-small)}.lg-shadow\:medium{box-shadow:var(--lns-shadow-medium)}.lg-shadow\:large{box-shadow:var(--lns-shadow-large)}.lg-radius\:medium{border-radius:var(--lns-radius-medium)}.lg-radius\:large{border-radius:var(--lns-radius-large)}.lg-radius\:xlarge{border-radius:var(--lns-radius-xlarge)}.lg-radius\:full{border-radius:var(--lns-radius-full)}.lg-bgc\:red{background-color:var(--lns-color-red)}.lg-bgc\:blurpleLight{background-color:var(--lns-color-blurpleLight)}.lg-bgc\:blurpleMedium{background-color:var(--lns-color-blurpleMedium)}.lg-bgc\:blurple{background-color:var(--lns-color-blurple)}.lg-bgc\:blurpleDark{background-color:var(--lns-color-blurpleDark)}.lg-bgc\:offWhite{background-color:var(--lns-color-offWhite)}.lg-bgc\:blueLight{background-color:var(--lns-color-blueLight)}.lg-bgc\:blue{background-color:var(--lns-color-blue)}.lg-bgc\:blueDark{background-color:var(--lns-color-blueDark)}.lg-bgc\:orangeLight{background-color:var(--lns-color-orangeLight)}.lg-bgc\:orange{background-color:var(--lns-color-orange)}.lg-bgc\:orangeDark{background-color:var(--lns-color-orangeDark)}.lg-bgc\:tealLight{background-color:var(--lns-color-tealLight)}.lg-bgc\:teal{background-color:var(--lns-color-teal)}.lg-bgc\:tealDark{background-color:var(--lns-color-tealDark)}.lg-bgc\:yellowLight{background-color:var(--lns-color-yellowLight)}.lg-bgc\:yellow{background-color:var(--lns-color-yellow)}.lg-bgc\:yellowDark{background-color:var(--lns-color-yellowDark)}.lg-bgc\:grey8{background-color:var(--lns-color-grey8)}.lg-bgc\:grey7{background-color:var(--lns-color-grey7)}.lg-bgc\:grey6{background-color:var(--lns-color-grey6)}.lg-bgc\:grey5{background-color:var(--lns-color-grey5)}.lg-bgc\:grey4{background-color:var(--lns-color-grey4)}.lg-bgc\:grey3{background-color:var(--lns-color-grey3)}.lg-bgc\:grey2{background-color:var(--lns-color-grey2)}.lg-bgc\:grey1{background-color:var(--lns-color-grey1)}.lg-bgc\:white{background-color:var(--lns-color-white)}.lg-bgc\:primary{background-color:var(--lns-color-primary)}.lg-bgc\:primaryHover{background-color:var(--lns-color-primaryHover)}.lg-bgc\:primaryActive{background-color:var(--lns-color-primaryActive)}.lg-bgc\:body{background-color:var(--lns-color-body)}.lg-bgc\:bodyDimmed{background-color:var(--lns-color-bodyDimmed)}.lg-bgc\:background{background-color:var(--lns-color-background)}.lg-bgc\:backgroundHover{background-color:var(--lns-color-backgroundHover)}.lg-bgc\:backgroundActive{background-color:var(--lns-color-backgroundActive)}.lg-bgc\:backgroundSecondary{background-color:var(--lns-color-backgroundSecondary)}.lg-bgc\:backgroundSecondary2{background-color:var(--lns-color-backgroundSecondary2)}.lg-bgc\:overlay{background-color:var(--lns-color-overlay)}.lg-bgc\:border{background-color:var(--lns-color-border)}.lg-bgc\:focusRing{background-color:var(--lns-color-focusRing)}.lg-bgc\:record{background-color:var(--lns-color-record)}.lg-bgc\:recordHover{background-color:var(--lns-color-recordHover)}.lg-bgc\:recordActive{background-color:var(--lns-color-recordActive)}.lg-bgc\:info{background-color:var(--lns-color-info)}.lg-bgc\:success{background-color:var(--lns-color-success)}.lg-bgc\:warning{background-color:var(--lns-color-warning)}.lg-bgc\:danger{background-color:var(--lns-color-danger)}.lg-bgc\:dangerHover{background-color:var(--lns-color-dangerHover)}.lg-bgc\:dangerActive{background-color:var(--lns-color-dangerActive)}.lg-bgc\:backdrop{background-color:var(--lns-color-backdrop)}.lg-bgc\:backdropDark{background-color:var(--lns-color-backdropDark)}.lg-bgc\:backdropTwilight{background-color:var(--lns-color-backdropTwilight)}.lg-bgc\:disabledContent{background-color:var(--lns-color-disabledContent)}.lg-bgc\:highlight{background-color:var(--lns-color-highlight)}.lg-bgc\:disabledBackground{background-color:var(--lns-color-disabledBackground)}.lg-bgc\:formFieldBorder{background-color:var(--lns-color-formFieldBorder)}.lg-bgc\:formFieldBackground{background-color:var(--lns-color-formFieldBackground)}.lg-bgc\:buttonBorder{background-color:var(--lns-color-buttonBorder)}.lg-bgc\:upgrade{background-color:var(--lns-color-upgrade)}.lg-bgc\:upgradeHover{background-color:var(--lns-color-upgradeHover)}.lg-bgc\:upgradeActive{background-color:var(--lns-color-upgradeActive)}.lg-bgc\:tabBackground{background-color:var(--lns-color-tabBackground)}.lg-bgc\:discoveryBackground{background-color:var(--lns-color-discoveryBackground)}.lg-bgc\:discoveryLightBackground{background-color:var(--lns-color-discoveryLightBackground)}.lg-bgc\:discoveryTitle{background-color:var(--lns-color-discoveryTitle)}.lg-bgc\:discoveryHighlight{background-color:var(--lns-color-discoveryHighlight)}.lg-m\:0{margin:0}.lg-m\:auto{margin:auto}.lg-m\:xsmall{margin:var(--lns-space-xsmall)}.lg-m\:small{margin:var(--lns-space-small)}.lg-m\:medium{margin:var(--lns-space-medium)}.lg-m\:large{margin:var(--lns-space-large)}.lg-m\:xlarge{margin:var(--lns-space-xlarge)}.lg-m\:xxlarge{margin:var(--lns-space-xxlarge)}.lg-mt\:0{margin-top:0}.lg-mt\:auto{margin-top:auto}.lg-mt\:xsmall{margin-top:var(--lns-space-xsmall)}.lg-mt\:small{margin-top:var(--lns-space-small)}.lg-mt\:medium{margin-top:var(--lns-space-medium)}.lg-mt\:large{margin-top:var(--lns-space-large)}.lg-mt\:xlarge{margin-top:var(--lns-space-xlarge)}.lg-mt\:xxlarge{margin-top:var(--lns-space-xxlarge)}.lg-mb\:0{margin-bottom:0}.lg-mb\:auto{margin-bottom:auto}.lg-mb\:xsmall{margin-bottom:var(--lns-space-xsmall)}.lg-mb\:small{margin-bottom:var(--lns-space-small)}.lg-mb\:medium{margin-bottom:var(--lns-space-medium)}.lg-mb\:large{margin-bottom:var(--lns-space-large)}.lg-mb\:xlarge{margin-bottom:var(--lns-space-xlarge)}.lg-mb\:xxlarge{margin-bottom:var(--lns-space-xxlarge)}.lg-ml\:0{margin-left:0}.lg-ml\:auto{margin-left:auto}.lg-ml\:xsmall{margin-left:var(--lns-space-xsmall)}.lg-ml\:small{margin-left:var(--lns-space-small)}.lg-ml\:medium{margin-left:var(--lns-space-medium)}.lg-ml\:large{margin-left:var(--lns-space-large)}.lg-ml\:xlarge{margin-left:var(--lns-space-xlarge)}.lg-ml\:xxlarge{margin-left:var(--lns-space-xxlarge)}.lg-mr\:0{margin-right:0}.lg-mr\:auto{margin-right:auto}.lg-mr\:xsmall{margin-right:var(--lns-space-xsmall)}.lg-mr\:small{margin-right:var(--lns-space-small)}.lg-mr\:medium{margin-right:var(--lns-space-medium)}.lg-mr\:large{margin-right:var(--lns-space-large)}.lg-mr\:xlarge{margin-right:var(--lns-space-xlarge)}.lg-mr\:xxlarge{margin-right:var(--lns-space-xxlarge)}.lg-mx\:0{margin-left:0;margin-right:0}.lg-mx\:auto{margin-left:auto;margin-right:auto}.lg-mx\:xsmall{margin-left:var(--lns-space-xsmall);margin-right:var(--lns-space-xsmall)}.lg-mx\:small{margin-left:var(--lns-space-small);margin-right:var(--lns-space-small)}.lg-mx\:medium{margin-left:var(--lns-space-medium);margin-right:var(--lns-space-medium)}.lg-mx\:large{margin-left:var(--lns-space-large);margin-right:var(--lns-space-large)}.lg-mx\:xlarge{margin-left:var(--lns-space-xlarge);margin-right:var(--lns-space-xlarge)}.lg-mx\:xxlarge{margin-left:var(--lns-space-xxlarge);margin-right:var(--lns-space-xxlarge)}.lg-my\:0{margin-top:0;margin-bottom:0}.lg-my\:auto{margin-top:auto;margin-bottom:auto}.lg-my\:xsmall{margin-top:var(--lns-space-xsmall);margin-bottom:var(--lns-space-xsmall)}.lg-my\:small{margin-top:var(--lns-space-small);margin-bottom:var(--lns-space-small)}.lg-my\:medium{margin-top:var(--lns-space-medium);margin-bottom:var(--lns-space-medium)}.lg-my\:large{margin-top:var(--lns-space-large);margin-bottom:var(--lns-space-large)}.lg-my\:xlarge{margin-top:var(--lns-space-xlarge);margin-bottom:var(--lns-space-xlarge)}.lg-my\:xxlarge{margin-top:var(--lns-space-xxlarge);margin-bottom:var(--lns-space-xxlarge)}.lg-p\:0{padding:0}.lg-p\:xsmall{padding:var(--lns-space-xsmall)}.lg-p\:small{padding:var(--lns-space-small)}.lg-p\:medium{padding:var(--lns-space-medium)}.lg-p\:large{padding:var(--lns-space-large)}.lg-p\:xlarge{padding:var(--lns-space-xlarge)}.lg-p\:xxlarge{padding:var(--lns-space-xxlarge)}.lg-pt\:0{padding-top:0}.lg-pt\:xsmall{padding-top:var(--lns-space-xsmall)}.lg-pt\:small{padding-top:var(--lns-space-small)}.lg-pt\:medium{padding-top:var(--lns-space-medium)}.lg-pt\:large{padding-top:var(--lns-space-large)}.lg-pt\:xlarge{padding-top:var(--lns-space-xlarge)}.lg-pt\:xxlarge{padding-top:var(--lns-space-xxlarge)}.lg-pb\:0{padding-bottom:0}.lg-pb\:xsmall{padding-bottom:var(--lns-space-xsmall)}.lg-pb\:small{padding-bottom:var(--lns-space-small)}.lg-pb\:medium{padding-bottom:var(--lns-space-medium)}.lg-pb\:large{padding-bottom:var(--lns-space-large)}.lg-pb\:xlarge{padding-bottom:var(--lns-space-xlarge)}.lg-pb\:xxlarge{padding-bottom:var(--lns-space-xxlarge)}.lg-pl\:0{padding-left:0}.lg-pl\:xsmall{padding-left:var(--lns-space-xsmall)}.lg-pl\:small{padding-left:var(--lns-space-small)}.lg-pl\:medium{padding-left:var(--lns-space-medium)}.lg-pl\:large{padding-left:var(--lns-space-large)}.lg-pl\:xlarge{padding-left:var(--lns-space-xlarge)}.lg-pl\:xxlarge{padding-left:var(--lns-space-xxlarge)}.lg-pr\:0{padding-right:0}.lg-pr\:xsmall{padding-right:var(--lns-space-xsmall)}.lg-pr\:small{padding-right:var(--lns-space-small)}.lg-pr\:medium{padding-right:var(--lns-space-medium)}.lg-pr\:large{padding-right:var(--lns-space-large)}.lg-pr\:xlarge{padding-right:var(--lns-space-xlarge)}.lg-pr\:xxlarge{padding-right:var(--lns-space-xxlarge)}.lg-px\:0{padding-left:0;padding-right:0}.lg-px\:xsmall{padding-left:var(--lns-space-xsmall);padding-right:var(--lns-space-xsmall)}.lg-px\:small{padding-left:var(--lns-space-small);padding-right:var(--lns-space-small)}.lg-px\:medium{padding-left:var(--lns-space-medium);padding-right:var(--lns-space-medium)}.lg-px\:large{padding-left:var(--lns-space-large);padding-right:var(--lns-space-large)}.lg-px\:xlarge{padding-left:var(--lns-space-xlarge);padding-right:var(--lns-space-xlarge)}.lg-px\:xxlarge{padding-left:var(--lns-space-xxlarge);padding-right:var(--lns-space-xxlarge)}.lg-py\:0{padding-top:0;padding-bottom:0}.lg-py\:xsmall{padding-top:var(--lns-space-xsmall);padding-bottom:var(--lns-space-xsmall)}.lg-py\:small{padding-top:var(--lns-space-small);padding-bottom:var(--lns-space-small)}.lg-py\:medium{padding-top:var(--lns-space-medium);padding-bottom:var(--lns-space-medium)}.lg-py\:large{padding-top:var(--lns-space-large);padding-bottom:var(--lns-space-large)}.lg-py\:xlarge{padding-top:var(--lns-space-xlarge);padding-bottom:var(--lns-space-xlarge)}.lg-py\:xxlarge{padding-top:var(--lns-space-xxlarge);padding-bottom:var(--lns-space-xxlarge)}.lg-text\:small{font-size:var(--lns-fontSize-small);line-height:var(--lns-lineHeight-small)}.lg-text\:body-sm{font-size:var(--lns-fontSize-body-sm);line-height:var(--lns-lineHeight-body-sm)}.lg-text\:medium{font-size:var(--lns-fontSize-medium);line-height:var(--lns-lineHeight-medium)}.lg-text\:body-md{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md)}.lg-text\:large{font-size:var(--lns-fontSize-large);line-height:var(--lns-lineHeight-large)}.lg-text\:body-lg{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg)}.lg-text\:xlarge{font-size:var(--lns-fontSize-xlarge);line-height:var(--lns-lineHeight-xlarge)}.lg-text\:heading-sm{font-size:var(--lns-fontSize-heading-sm);line-height:var(--lns-lineHeight-heading-sm)}.lg-text\:xxlarge{font-size:var(--lns-fontSize-xxlarge);line-height:var(--lns-lineHeight-xxlarge)}.lg-text\:heading-md{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md)}.lg-text\:xxxlarge{font-size:var(--lns-fontSize-xxxlarge);line-height:var(--lns-lineHeight-xxxlarge)}.lg-text\:heading-lg{font-size:var(--lns-fontSize-heading-lg);line-height:var(--lns-lineHeight-heading-lg)}.lg-weight\:book{font-weight:var(--lns-fontWeight-book)}.lg-weight\:bold{font-weight:var(--lns-fontWeight-bold)}.lg-text\:body{font-size:var(--lns-fontSize-body-md);line-height:var(--lns-lineHeight-body-md);font-weight:var(--lns-fontWeight-book)}.lg-text\:title{font-size:var(--lns-fontSize-body-lg);line-height:var(--lns-lineHeight-body-lg);font-weight:var(--lns-fontWeight-bold)}.lg-text\:mainTitle{font-size:var(--lns-fontSize-heading-md);line-height:var(--lns-lineHeight-heading-md);font-weight:var(--lns-fontWeight-bold)}.lg-text\:left{text-align:left}.lg-text\:right{text-align:right}.lg-text\:center{text-align:center}.lg-border{border:1px solid var(--lns-color-border)}.lg-borderTop{border-top:1px solid var(--lns-color-border)}.lg-borderBottom{border-bottom:1px solid var(--lns-color-border)}.lg-borderLeft{border-left:1px solid var(--lns-color-border)}.lg-borderRight{border-right:1px solid var(--lns-color-border)}.lg-inline{display:inline}.lg-block{display:block}.lg-flex{display:flex}.lg-inlineBlock{display:inline-block}.lg-inlineFlex{display:inline-flex}.lg-none{display:none}.lg-flexWrap{flex-wrap:wrap}.lg-flexDirection\:column{flex-direction:column}.lg-flexDirection\:row{flex-direction:row}.lg-items\:stretch{align-items:stretch}.lg-items\:center{align-items:center}.lg-items\:baseline{align-items:baseline}.lg-items\:flexStart{align-items:flex-start}.lg-items\:flexEnd{align-items:flex-end}.lg-items\:selfStart{align-items:self-start}.lg-items\:selfEnd{align-items:self-end}.lg-justify\:flexStart{justify-content:flex-start}.lg-justify\:flexEnd{justify-content:flex-end}.lg-justify\:center{justify-content:center}.lg-justify\:spaceBetween{justify-content:space-between}.lg-justify\:spaceAround{justify-content:space-around}.lg-justify\:spaceEvenly{justify-content:space-evenly}.lg-grow\:0{flex-grow:0}.lg-grow\:1{flex-grow:1}.lg-shrink\:0{flex-shrink:0}.lg-shrink\:1{flex-shrink:1}.lg-self\:auto{align-self:auto}.lg-self\:flexStart{align-self:flex-start}.lg-self\:flexEnd{align-self:flex-end}.lg-self\:center{align-self:center}.lg-self\:baseline{align-self:baseline}.lg-self\:stretch{align-self:stretch}.lg-overflow\:hidden{overflow:hidden}.lg-overflow\:auto{overflow:auto}.lg-relative{position:relative}.lg-absolute{position:absolute}.lg-sticky{position:sticky}.lg-fixed{position:fixed}.lg-top\:0{top:0}.lg-top\:auto{top:auto}.lg-top\:xsmall{top:var(--lns-space-xsmall)}.lg-top\:small{top:var(--lns-space-small)}.lg-top\:medium{top:var(--lns-space-medium)}.lg-top\:large{top:var(--lns-space-large)}.lg-top\:xlarge{top:var(--lns-space-xlarge)}.lg-top\:xxlarge{top:var(--lns-space-xxlarge)}.lg-bottom\:0{bottom:0}.lg-bottom\:auto{bottom:auto}.lg-bottom\:xsmall{bottom:var(--lns-space-xsmall)}.lg-bottom\:small{bottom:var(--lns-space-small)}.lg-bottom\:medium{bottom:var(--lns-space-medium)}.lg-bottom\:large{bottom:var(--lns-space-large)}.lg-bottom\:xlarge{bottom:var(--lns-space-xlarge)}.lg-bottom\:xxlarge{bottom:var(--lns-space-xxlarge)}.lg-left\:0{left:0}.lg-left\:auto{left:auto}.lg-left\:xsmall{left:var(--lns-space-xsmall)}.lg-left\:small{left:var(--lns-space-small)}.lg-left\:medium{left:var(--lns-space-medium)}.lg-left\:large{left:var(--lns-space-large)}.lg-left\:xlarge{left:var(--lns-space-xlarge)}.lg-left\:xxlarge{left:var(--lns-space-xxlarge)}.lg-right\:0{right:0}.lg-right\:auto{right:auto}.lg-right\:xsmall{right:var(--lns-space-xsmall)}.lg-right\:small{right:var(--lns-space-small)}.lg-right\:medium{right:var(--lns-space-medium)}.lg-right\:large{right:var(--lns-space-large)}.lg-right\:xlarge{right:var(--lns-space-xlarge)}.lg-right\:xxlarge{right:var(--lns-space-xxlarge)}.lg-width\:auto{width:auto}.lg-width\:full{width:100%}.lg-width\:0{width:0}.lg-minWidth\:0{min-width:0}.lg-height\:auto{height:auto}.lg-height\:full{height:100%}.lg-height\:0{height:0}.lg-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.lg-srOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0}}
  
            #inner-shadow-companion {
              --lns-unit: 8px;
              all: initial;
              font-family: circular, Helvetica, sans-serif;
              color: var(--lns-color-body);
            }
            #tooltip-mount-layer-companion {
              z-index: 2147483646;
              position: relative;

              color: var(--lns-color-body);
              pointer-events: auto;
            }
          </style><div class="companion-1b6rwsq"></div></div></template></section></div></body><auto-scroll><template shadowrootmode="closed"><div style="transform: translateZ(0px); display: none; position: fixed; left: 0px; top: 0px; width: 100%; height: 100%; z-index: 2147483647; background-repeat: no-repeat;"></div></template></auto-scroll></html>